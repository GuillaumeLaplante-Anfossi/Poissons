\documentclass{amsart}

\usepackage[T1]{fontenc}
\usepackage{enumerate, amsmath, amsfonts, amssymb, amsthm, mathrsfs, wasysym, graphics, graphicx, xcolor, url, hyperref, hypcap, shuffle, xargs, multicol, overpic, pdflscape, multirow, hvfloat, minibox, accents, array, multido, xifthen, a4wide, ae, aecompl, blkarray, pifont, mathtools, etoolbox, dsfont, stmaryrd}
\usepackage{marginnote}
\hypersetup{colorlinks=true, citecolor=darkblue, linkcolor=darkblue}
\usepackage[all]{xy}
\usepackage[bottom]{footmisc}
\usepackage{tikz, tikz-cd, tikz-qtree}
\usetikzlibrary{trees, decorations, decorations.markings, shapes, arrows, matrix, calc, fit, intersections, patterns, angles, snakes}
\usepackage[external]{forest}
%\tikzexternalize
\graphicspath{{figures/}{figures/nodes/}}
\makeatletter\def\input@path{{figures/}}\makeatother
\usepackage{caption}
\captionsetup{width=\textwidth}
\renewcommand{\topfraction}{1} % possibility to have one page of pictures
\renewcommand{\bottomfraction}{1} % possibility to have one page of pictures
\usepackage[noabbrev,capitalise]{cleveref}
\usepackage[export]{adjustbox}
\usepackage{ulem}\normalem
\usepackage{xargs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% colors
\definecolor{darkblue}{rgb}{0,0,0.7} % darkblue color
\definecolor{green}{RGB}{57,181,74} % green color
\definecolor{violet}{RGB}{147,39,143} % violet color
\newcommand{\red}{\color{red}} % red command
\newcommand{\blue}{\color{blue}} % blue command
\newcommand{\orange}{\color{orange}} % orange command
\newcommand{\green}{\color{green}} % green command
\newcommand{\darkblue}{\color{darkblue}} % darkblue command

% marginal comments
\usepackage{todonotes}
\newcommand{\vincent}[1]{\todo[color=blue!30]{\rm #1 \\ \hfill --- V.}}
\newcommand{\vincenti}[1]{\todo[color=blue!30, inline]{\rm #1 \\ \hfill --- V.}}
\newcommand{\Guillaume}[1]{\todo[color=magenta!30]{\rm #1 \\ \hfill --- G.}}
\newcommand{\Kurt}[1]{\todo[color=orange!30]{\rm #1 \\ \hfill --- K.}}
\newcommand{\BDO}[1]{\todo[color=green!30]{\rm #1 \\ \hfill --- B.}}
\newcommand{\BDOi}[1]{\todo[color=green!30, inline]{\rm #1 \\ \hfill --- B.}}

% theorems
\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{construction}[theorem]{Construction}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{question}[theorem]{Question}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{assumption}[theorem]{Assumption}
\crefname{notation}{Notation}{Notations}
\crefname{problem}{Problem}{Problems}

% math special letters
\newcommand{\R}{\mathbb{R}} % reals
\newcommand{\N}{\mathbb{N}} % naturals
\newcommand{\Z}{\mathbb{Z}} % integers
\newcommand{\C}{\mathbb{C}} % complex
\newcommand{\I}{\mathbb{I}} % set of integers
\newcommand{\K}{\mathbb{K}} % field
\newcommand{\fA}{\mathfrak{A}} % alternating group
\newcommand{\fB}{\mathfrak{S}^\textsc{b}} % signed symmetric group
\newcommand{\cA}{\mathcal{A}} % algebra
\newcommand{\cC}{\mathcal{C}} % collection
\newcommand{\cS}{\mathcal{S}} % ground set
\newcommand{\uR}{\underline{R}} % underline set
\newcommand{\uS}{\underline{S}} % underline set
\newcommand{\uT}{\underline{T}} % underline set
\newcommand{\oS}{\overline{S}} % overline set
\newcommand{\ucS}{\underline{\cS}} % underline ground set
\renewcommand{\b}[1]{{\boldsymbol{#1}}} % bold letters
\newcommand{\bb}[1]{\mathbb{#1}} % bb letters
\newcommand{\f}[1]{\mathfrak{#1}} % frak letters
\newcommand{\h}{\widehat} % hat letters

\newcommand{\Un}{\mathrm{U}} % unordered IJ
\newcommand{\Or}{\mathrm{O}} % ordered IJ

% math commands
\newcommand{\set}[2]{\left\{ #1 \;\middle|\; #2 \right\}} % set notation
\newcommand{\bigset}[2]{\big\{ #1 \;\big|\; #2 \big\}} % big set notation
\newcommand{\Bigset}[2]{\Big\{ #1 \;\Big|\; #2 \Big\}} % Big set notation
\newcommand{\setangle}[2]{\left\langle #1 \;\middle|\; #2 \right\rangle} % set notation
\newcommand{\ssm}{\smallsetminus} % small set minus
\newcommand{\dotprod}[2]{\left\langle \, #1 \; \middle| \; #2 \, \right\rangle} % dot product
\newcommand{\symdif}{\,\triangle\,} % symmetric difference
\newcommand{\one}{\b{1}} % the all one vector
\newcommand{\eqdef}{\mbox{\,\raisebox{0.2ex}{\scriptsize\ensuremath{\mathrm:}}\ensuremath{=}\,}} % :=
\newcommand{\defeq}{\mbox{~\ensuremath{=}\raisebox{0.2ex}{\scriptsize\ensuremath{\mathrm:}} }} % =:
\newcommand{\simplex}{\b{\triangle}} % simplex
\renewcommand{\implies}{\Rightarrow} % imply sign
\newcommand{\transpose}[1]{{#1}^t} % transpose matrix
\renewcommand{\complement}[1]{\bar{#1}} % complement

% operators
\DeclareMathOperator{\conv}{conv} % convex hull
\DeclareMathOperator{\vect}{vect} % linear span
\DeclareMathOperator{\cone}{cone} % cone hull
\DeclareMathOperator{\Inv}{Inv} % inversions
\DeclareMathOperator{\inv}{inv} % inversions
\DeclareMathOperator{\Ima}{Im} %Image d'une fonction
\DeclareMathOperator{\std}{std}

% others
\newcommand{\ie}{\textit{i.e.}~} % id est
\newcommand{\resp}{resp.~} % id est
\newcommand{\eg}{\textit{e.g.}~} % exempli gratia
\newcommand{\Eg}{\textit{E.g.}~} % exempli gratia
\newcommand{\apriori}{\textit{a priori}} % a priori
\newcommand{\viceversa}{\textit{vice versa}} % vice versa
\newcommand{\versus}{\textit{vs.}~} % versus
\newcommand{\aka}{\textit{a.k.a.}~} % also known as
\newcommand{\perse}{\textit{per se}} % per se
\newcommand{\ordinal}{\textsuperscript{th}} % th for ordinals
\newcommand{\ordinalst}{\textsuperscript{st}} % st for ordinals
\newcommand{\defn}[1]{\textsl{\darkblue #1}} % emphasis of a definition
\newcommand{\para}[1]{\medskip\noindent\uline{#1.}} % paragraph
\renewcommand{\topfraction}{1} % possibility to have one page of pictures
\renewcommand{\bottomfraction}{1} % possibility to have one page of pictures
\newcommand{\imagetop}[1]{\vtop{\null\hbox{#1}}} % image aligned top
\newcommand{\OEIS}[1]{\cite[{\rm \href{http://oeis.org/#1}{\texttt{#1}}}]{OEIS}}

%Hyperplane arrangements
\renewcommand{\b}[1]{\boldsymbol{#1}} % bold
\newcommandx{\arrangement}[1][1 = A]{\mathcal{#1}} % arrangement
\newcommand{\HH}{\mathbb{H}} % hyperplane
\newcommandx{\braidArrangement}[1][1 = n]{\arrangement[B]_{#1}} % braid arrangement
\newcommandx{\multiBraidArrangement}[2][1 = n, 2 = \ell]{\arrangement[B]_{#1}^{#2}} % (l,n)-braid arrangement
\newcommandx{\rank}[1][1 = \arrangement]{\operatorname{rk}(#1)} % rank
\newcommandx{\facePoset}[1][1 = \arrangement]{\mathsf{Fa}(#1)} % face poset
\newcommandx{\fPol}[2][1 = \arrangement, 2 = x]{\b{f}_{#1}(#2)} % face polynomial
\newcommandx{\bPol}[2][1 = \arrangement, 2 = x]{\b{b}_{#1}(#2)} % bounded face polynomial
\newcommandx{\flatPoset}[1][1 = \arrangement]{\mathsf{Fl}(#1)} % intersection poset
\newcommandx{\charPol}[2][1 = \arrangement, 2 = y]{\b{\chi}_{#1}(#2)} % characteristic polynomial
\newcommandx{\mobPol}[3][1 = \arrangement, 2 = x, 3 = y]{\b{\mu}_{#1}(#2, #3)} % Mobius polynomial
\newcommandx{\weirdPol}[2][1 = \arrangement, 2 = x]{\b{\pi}_{#1}(#2)} % weird polynomial
\newcommandx{\partitionPoset}[1][1 = n]{\b{\Pi}_{#1}} % partition poset
\newcommandx{\forestPoset}[2][1 = n, 2 = \ell]{\b{\Phi}_{#1}^{#2}} % partition forest poset
\newcommandx{\rainbowForests}[2][1 = n, 2 = \ell]{\b{\Psi}_{#1}^{#2}} % rainbow forests
\newcommandx{\rainbowTrees}[2][1 = n, 2 = \ell]{\mathsf{RT}_{#1}^{#2}} % rainbow trees
\newcommandx{\Perm}[1][1 = n]{\mathsf{Perm}(#1)} % permutahedron
\makeatletter
\def\rightharpoonupfill@{\arrowfill@\relbar\relbar\rightharpoonup}
\newcommand{\overrightharpoonup}{%
\mathpalette{\overarrow@\rightharpoonupfill@}}
\makeatother
\newcommandx{\orient}[1]{\smash{\overrightharpoonup{#1}}} % ordered
\newcommandx{\orientedPartitionPoset}[1][1 = n]{\orient{\mathsf{Pa}}_{#1}} % oriented partition poset
\newcommandx{\orientedForestPoset}[2][1 = n, 2 = \ell]{\orient{\mathsf{Fo}}_{#1}^{#2}} % oriented partition forest poset

%Operadic diagonals
\newcommand{\SU}{\mathrm{SU}}
\newcommand{\LA}{\mathrm{LA}}
\newcommand{\SUD}{\triangle^{\mathrm{SU}}}
\newcommand{\LAD}{\triangle^{\mathrm{LA}}}
\newcommand{\SCP}{\mathrm{SCP}}
\newcommand{\PolySub}{\mathsf{Poly}}
\newcommand{\EC}{\mathcal{E}} %essential complimentary partitions
\newcommand{\OP}{\triangle} %ordered partitions
\newcommand{\BT}{\mathcal{B}} %bipartite trees
\newcommand{\Ainf}{\ensuremath{\mathrm{A}_\infty}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\tr}{\mathrm{tr}}
\newcommand{\id}{\mathrm{id}}

%Shift operators
%\vphantom{1} ensures sequential arrows aligned.
\newcommand{\rightshift}[1]{\overrightarrow{\vphantom{1}{#1}}}
\newcommand{\rightshiftk}[2]{\overrightarrow{\vphantom{1}{#1}}^{#2}}
\newcommand{\leftshift}[1]{\overleftarrow{\vphantom{1}{#1}}}
\newcommand{\leftshiftk}[2]{\overleftarrow{\vphantom{1}{#1}}^{#2}}
%Subdiv cube defs
\newcommand{\divcube}[1]{\Box_{#1}}
\newcommand{\subdivcubeofe}{C_e}
\newcommand{\subdivcubeofouter}{C}
\newcommand{\subdivpairsev}{S_e^v}
\newcommand{\maxsubdivpairsev}{M_e^v}
\newcommand{\subdivpairsv}{S^v}
\newcommand{\maxsubdivpairsv}{M^v}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% formating the part command
\makeatletter
\def\part{\@startsection{part}{1}%
\z@{.7\linespacing\@plus\linespacing}{.8\linespacing}%
{\LARGE\sffamily\centering}}
%\@addtoreset{section}{part}
\makeatother
\renewcommand{\thepart}{\Roman{part}}
%\renewcommand{\thesection}{\arabic{part}.\arabic{section}}

% formating the table of contents
\setcounter{tocdepth}{2}
\makeatletter
\def\l@part{\@tocline{1}{8pt}{0pc}{}{}}
\def\l@section{\@tocline{1}{4pt}{0pc}{}{}}
\makeatother
\let\oldtocpart=\tocpart
\renewcommand{\tocpart}[2]{\sc\large\oldtocpart{#1}{#2}}
\let\oldtocsection=\tocsection
\renewcommand{\tocsection}[2]{\bf\oldtocsection{#1}{#2}}
\let\oldtocsubsubsection=\tocsubsubsection
\renewcommand{\tocsubsubsection}[2]{\quad\oldtocsubsubsection{#1}{#2}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Cellular diagonals of permutahedra}

\thanks{}

\author[B. Delcroix-Oger]{B\'er\'enice Delcroix-Oger}
\address[B\'{e}r\'{e}nice Delcroix-Oger]{Institut Montpelli\'erain Alexander Grothendieck, Universit\'e de Montpellier, France}
\email{berenice.delcroix-oger@umontpellier.fr}
\urladdr{\url{https://oger.perso.math.cnrs.fr/}}

\author[M. Josuat-Verg\`es]{Matthieu Josuat-Verg\`es}
\address[Matthieu Josuat-Verg√®s]{}
\email{}

\author[G. Laplante-Anfossi]{Guillaume Laplante-Anfossi}
\address[Guillaume Laplante-Anfossi]{School of Mathematics and Statistics, The University of Melbourne, Victoria, Australia}
\email{guillaume.laplanteanfossi@unimelb.edu.au}

\author[V. Pilaud]{Vincent Pilaud}
\address[Vincent Pilaud]{CNRS \& LIX, \'Ecole Polytechnique, Palaiseau, France}
\email{vincent.pilaud@lix.polytechnique.fr}
\urladdr{\url{http://www.lix.polytechnique.fr/~pilaud/}}

\author[K. Stoeckl]{Kurt Stoeckl}
\address[Kurt Stoeckl]{School of Mathematics and Statistics, The University of Melbourne, Victoria, Australia}
\email{kstoeckl@student.unimelb.edu.au}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{abstract}
We provide a a systematic enumerative and combinatorial study of geometric cellular diagonals on the permutahedra. 

The first part of the paper is dedicated to the combinatorics of certain hyperplane arrangements obtained as the union of $\ell$ generically translated copies of the classical braid arrangement.
Based on Zaslavsky's theory, we derive enumerative results on the faces of these arrangements involving combinatorial objects named partition forests and rainbow forests.
This yields in particular nice formulas for the number of regions and bounded regions of these arrangements in terms of exponentials of generating functions of Fuss-Catalan numbers.
By duality, the specialization of these results to the case $\ell = 2$ gives the enumeration of any geometric diagonal of the permutahedron.

The second part of the paper focusses on more advanced combinatorial properties of the diagonals of the permutahedra.
We prove that there are only two operadic families of diagonals on the permutahedra, and we give a bijection between their facets and planar bipartite trees and characterize their vertices as pattern-avoiding pairs of permutations.
We then show that the Saneblidze--Umble diagonal can be recovered by a choice of vectors in the fundamental hyperplane arrangements of the permutahedra, resolving a conjecture of the third-named author.  
\end{abstract}

\vspace*{-.5cm}
\maketitle

%\enlargethispage{2cm}
\vspace*{-.2cm}
\centerline{\includegraphics[scale=.85]{diagonalPermutahedron3}}

\newpage
\enlargethispage{1cm}
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section*{Introduction} 
\label{s:introduction}

In this article, discrete geometry \emph{informs} higher algebra.
First, we obtain some purely combinatorial results, whose study is motivated by higher algebra: the combinatorially inclined reader can read the first part of this introduction, and go directly to Section 1.
Second, we obtain some (higher) algebraic results via discrete geometry: the algebraically inclined reader can read the second part of this introduction, and go directly to Section 2.
\Guillaume{I am not sure this is the way to go anymore}

%%%%%%%%%%%%%%%

\subsection*{Motivation}

The purpose of this article is to study cellular diagonals on the permutahedra, which are cellular maps homotopic to the usual thin diagonal $\triangle : P \to P \times P, x \mapsto (x,x)$ (\cref{def:thinDiagonal,def:cellularDiagonal,def:geometricDiagonal}).
Such diagonals, and in particular coherent families that we call \emph{operadic} diagonals (\cref{def:operadicDiagonal}), are of interest in algebraic geometry and topology: via the theory of Fulton--Sturmfels \cite{FultonSturmfels}, they give explicit formulas for the cup product on Losev--Manin toric varieties~\cite{LosevManin}; they define universal tensor products of homotopy operads, and in particular universal tensor products of homotopy associative permutads (shuffle algebras) \cite{LaplanteAnfossi}; they allow for the definition of a coproduct on permutahedral sets, which are used to models of two-fold loop spaces \cite{SaneblidzeUmble}; and their study is moreover needed to pursue the work of Baues aiming at defining explicit combinatorial models for higher iterated loop spaces \cite{Baues}. 
Moreover, using the canonical projections to the multiplihedra and the associahedra, they define universal tensor product of $\Ainf$-algebras and $\Ainf$-morphisms \cite{LaplanteAnfossiMazuir}.
\Guillaume{lien avec les matroides?}

\Guillaume{Mentionner le travail en cours de Lionel Pournin?}

The toric varieties associated with the permutahedron are called Losev--Manin varieties, introduced in \cite{LosevManin}.
\Guillaume{They are De Concini--Procesi wonderful compactifications of \dots
They are also brick manifolds?}
The cohomology ring structure was studied by Losev and Manin, and quite extensively since then. \Guillaume{See for example "Graph cohomology"} 
Our current work brings a completely combinatorially explicit description of the cup product, it would be interesting to know if this new description can lead to new results, or how it can be used to recover existing ones.

Permutades

%%%%%%%%%%%%%%%

\subsection*{\cref{part:multiBraidArrangements}. Combinatorics of multiple braid arrangements}

As the dual of the permutahedron~$\Perm$ is the classical braid arrangement~$\braidArrangement$, the dual of a diagonal of the permutahedron~$\Perm$ is an hyperplane arrangement~$\multiBraidArrangement[n][2]$ made of $2$ generically translated copies of the braid arrangement~$\braidArrangement$.
In the first part of the paper, we therefore study the combinatorics of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ defined as the union of $\ell$ generically translated copies of the braid arrangement~$\braidArrangement$ (\cref{def:multiBraidArrangement}).
We are mainly interested in the~$\ell = 2$ case for the enumeration of the faces of the diagonals of the permutahedron~$\Perm$, but the general $\ell$ case is not much harder and should algebraically correspond to the enumeration of the faces of cellular $\ell$-gonals of the permutahedron~$\Perm$.
%We observe that the flats of~$\multiBraidArrangement$ are in bijection with forests of partitions and that the faces of~$\multiBraidArrangement$ are in bijection with certain forests of ordered partitions.

\cref{sec:flatPoset} is dedicated to the combinatorial description of the flat poset of~$\multiBraidArrangement$ and its enumerative consequences.
We first observe that the flats of~$\multiBraidArrangement$ are in bijection with $(\ell,n)$-partition forests, defined as $\ell$-tuples of (unordered) partitions of~$[n]$ whose intersection hypergraph is a hyperforest (\cref{def:partitionForests}).
As this description is independent of the translations of the different copies (as long as these translations are generic), we obtain by Zaslavsky's theory that the number of \mbox{$k$-dimensional} faces and of bounded faces of~$\multiBraidArrangement$ only depends on~$k$, $\ell$, and~$n$. % (and not on the specific translation vectors choosen to construct~$\multiBraidArrangement$).
In fact, we obtain the following formula for the M\"obius polynomial of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ in terms of pairs of $(\ell,n)$-partition forests.

\begin{theorem*}[\cref{thm:MobiusPolynomialMultiBraidArrangement}]
The M\"obius polynomial of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is given by
\[
\mobPol[\multiBraidArrangement] = x^{n-1-\ell n} y^{n-1-\ell n} \sum_{\b{F} \le \b{G}} \prod_{i \in [\ell]} x^{\#F_i} y^{\#G_i} \prod_{p \in G_i} (-1)^{\#F_i[p]-1} (\# F_i[p]-1)! \; ,
\]
where~$\b{F} \le \b{G}$ ranges over all intervals of the $(\ell,n)$-partition forest poset~$\forestPoset$, and~$F_i[p]$ denotes the restriction of the partition~$F_i$ to the part~$p$ of~$G_i$.
\end{theorem*}

This formula is not particularly easy to handle, but its turns out to simplify to very elegant formulas for the number of vertices, regions, and bounded regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.
Namely, using an alternative combinatorial description of the $(\ell,n)$-partition forests in terms of $(\ell, n)$-rainbow forests and a colored analogue of the classical Pr\"ufer code, we first obtain the number of vertices of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.

\begin{theorem*}[\cref{thm:verticesMultiBraidArrangement}]
The number of vertices of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is
\[
f_0(\multiBraidArrangement) = \ell \big( (\ell-1) n + 1 \big)^{n-2}.
\]
\end{theorem*}

This result can even be refined according to the dimension of the flats of the different copies used to obtain the vertices of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.

\begin{theorem*}[\cref{thm:verticesRefinedMultiBraidArrangement}]
For any~$k_1, \dots, k_\ell$ such that~$0 \le k_i \le n-1$ for~$i \in [\ell]$ and~${\sum_{i=1}^\ell k_i = n-1}$, the number of vertices~$v$ of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ such that the smallest flat of the $i$\ordinal{} copy of~$\braidArrangement$ containing~$v$ has dimension~$n-k_i-1$ is given by
\[
n^{\ell-1} \binom{n-1}{k_1, \dots, k_\ell} \prod_{i=1}^\ell (n-k_i)^{k_i-1}.
\]
\end{theorem*}

We then consider the regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.
We first obtain a very simple exponential formula for its characteristic polynomial.

\begin{theorem*}[\cref{thm:characteristicPolynomialMultiBraidArrangement}]
The characteristic polynomial~$\charPol[\multiBraidArrangement]$ of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is given~by
\[
\charPol[\multiBraidArrangement] = \frac{(-1)^n n!}{y} \, [z^n] \, \exp \bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, y \, z^m}{m} \bigg) ,
\]
where~$\displaystyle F_{\ell,m} \eqdef \frac{1}{(\ell-1)m+1} \binom{\ell m}{m}$ is the Fuss-Catalan number.
\end{theorem*}

Evaluating the characteristic polynomial at~$y = -1$ and~$y = 1$ respectively, we obtain by Zaslavsky's theory the numbers of regions and bounded regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.

\begin{theorem*}[\cref{thm:regionsMultiBraidArrangement}]
The numbers of regions and of bounded regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ are given by
\begin{align*}
f_{n-1}(\multiBraidArrangement) 
& = n! \, [z^n] \exp \Bigg( \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m} \Bigg) \\
\text{and}\qquad
b_{n-1}(\multiBraidArrangement)
%& = - n! \, [z^n] \exp \Bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m} \Bigg) 
& = (n-1)! \, [z^{n-1}] \exp \bigg( (\ell-1) \sum_{m \ge 1} F_{\ell,m} \, z^m \bigg).
\end{align*}
where~$\displaystyle F_{\ell,m} \eqdef \frac{1}{(\ell-1)m+1} \binom{\ell m}{m}$ is the Fuss-Catalan number.
\end{theorem*}

Finally, \cref{sec:facePoset} is dedicated to the combinatorial description of the face poset of~$\multiBraidArrangement$.
We observe that the faces of~$\multiBraidArrangement$ are in bijection with certain ordered $(\ell,n)$-partition forests, defined as $\ell$-tuples of ordered partitions of~$[n]$ whose underlying unordered partitions form an (unordered) $(\ell,n)$-partition forest (\cref{def:orderedPartitionForest}).
Here, which ordered $(\ell,n)$-partition forests actually appear as faces of~$\multiBraidArrangement$ depends on the choice of the translations of the different copies.
We provide a combinatorial description of the possible orderings of a $(\ell,n)$-partition forest compatible with some given translations in terms of certain paths in the forest (\cref{prop:PFtoOPF1,prop:PFtoOPF2}), and a combinatorial characterization of the ordered partition forests which appear for some given translations in terms of the circuits of a certain oriented graph (\cref{prop:characterizationOPFs}).

%%%%%%%%%%%%%%%

\subsection*{\cref{part:diagonalsPermutahedra}. Diagonals of permutahedra}

The first cellular diagonal for the permutahedra was defined at the level of chains by S. Saneblidze and R. Umble in \cite{SaneblidzeUmble}, we will call it the \emph{SU diagonal}. 
Cellular diagonals for the associahedra and the multiplihedra were also defined there, via projection. 
The first topological map for the permutahedra was given in \cite{LaplanteAnfossi} -we will call it the \emph{LA diagonal}, where a general theory of cellular diagonals of polytopes was developed. 
The LA diagonal, however, is distinct from the SU diagonal at the cellular level \cite[Rem.~3.19]{LaplanteAnfossi}. 

computer program for the SU diagonal \cite{VejdemoJohansson}; we give a much more effective computer program (however, without the signs)

corollary: le dernier article de SU!
corollary: IJ-description of SU diagonal
corollary: left and right shifts for LA, decomposition of the cube associated to LA diagonal

Perspectives: 
-for general diagonal, obtain closed formulas for all the faces
-for specific diagonals, extend the bijection with bipartite trees

\subsubsection{Consequences of the equivalence between diagonals}


This result
\begin{enumerate}[i)]
	\item brings a positive answer to \cite[Rem.~2.19]{LaplanteAnfossi}, showing that the original $\SU$ diagonal can indeed be recovered from a choice of chambers in the fundamental hyperplane arrangement of the permutahedron. 
	Remark that this choice is precisely given by the family of vectors mentioned in \cite[Rem.~4.19]{LaplanteAnfossi}, which was already identified to be operadic,
	\item sets up the analogous question in \cite[Rem.~3.9]{LaplanteAnfossiMazuir} for the multiplihedra,
	\item provides a new proof that all known diagonals on the associahedra coincide \cite{SaneblidzeUmble-comparingDiagonals}.
	Indeed, since the family of vectors inducing the $\SU$ diagonal all have strictly decreasing coordinates, the diagonal induced on the associahedron is given by the magical formula \cite[Thm.~2]{MasudaThomasTonksVallette}, see also \cite[Prop.~3.8]{LaplanteAnfossi}.
\end{enumerate}

Moreover, it allows us to obtain alternative descriptions of all four operadic diagonals, in particular
\begin{enumerate}
	\item subset shift and $m$-shift definitions of the $\LA$ diagonal,
	\item matrix description of the $\LA$ diagonal,
	\item a new realization of the permutahedron as subdivision of the cube, and a conjectural description of the $\LA$ diagonal in terms of this subdivision, 
\end{enumerate}
in addition to the new  \Guillaume{add references}
\begin{enumerate}
	\item[(4)] geometric construction and $(I,J)$-description of the $\SU$ diagonal,
	\item[(5)] description of the facets of the $\SU$ diagonal as labelled bipartite trees,
	\item[(6)] description of the vertices of the $\SU$ diagonal as pattern avoiding permutations,
	\item[(7)] enumerative results for the facets and vertices of the $\SU$ diagonal. 
\end{enumerate}

We end this Section by applying the isomorphism between the $\SU$ and $\LA$ diagonal to obtain explicitly the Points (1)-(3) above.

\begin{definition}[$\LA$ diagonals]
\begin{enumerate}
	\item subset shift
	\item $m$-shift
	\item matrix
\end{enumerate}
\end{definition}

\begin{definition}
	New subdivision of the cube
\end{definition}

\begin{conjecture}
	The $\LA$ diagonal is given by the formula...
\end{conjecture}

This is equivalent, via the isomorphism between $\LA$ and $\SU$ diagonals, to the analogous conjecture for the $\SU$ diagonal, presented as a fact in \cite[Equ.~(1)]{SaneblidzeUmble-comparingDiagonals}.

%%%%%%%%%%%%%%%

\subsection*{\cref{part:higherAlgebraicStructures}. Higher algebraic structures}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearpage
\part{Combinatorics of multiple braid arrangements}
\label{part:multiBraidArrangements}

In this first part, we study the combinatorics of hyperplane arrangements obtained as unions of generically translated copies of the braid arrangement.
%Specializing to two copies, we derive enumerative results on the diagonals of the permutahedra.
In \cref{sec:arrangements}, we first recall some classical facts on the enumeration of hyperplane arrangements (\cref{subsec:arrangements}), present the classical braid arrangement (\cref{subsec:braidArrangement}), and define our multiple braid arrangements (\cref{subsec:multiBraidArrangement}).
Then in \cref{sec:flatPoset}, we describe their flat posets in terms of partition forests (\cref{subsec:partitionForests}) and rainbow forests (\cref{subsec:rainbowForests}), from which we obtain their M\"obius polynomial (\cref{subsec:MobiusPolynomialMultiBraidArrangement}), and some surprizing formulas for their numbers of vertices (\cref{subsec:verticesMultiBraidArrangement}) and regions (\cref{subsec:regionsMultiBraidArrangement}).
Finally in \cref{sec:facePoset}, we describe their face posets in terms of ordered partition forests (\cref{subsec:orderedPartitionForests}), and explore some combinatorial criteria to describe the ordered partition forests that appear as faces for a given multiple braid arrangement (\cref{subsec:PFtoOPF,subsec:criterionOPF}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Recollection on hyperplane arrangements and the braid arrangement}
\label{sec:arrangements}

%%%%%%%%%%%%%%%

\subsection{Hyperplane arrangements}
\label{subsec:arrangements}

We first briefly recall classical results on the combinatorics of affine hyperplane arrangements, in particular the enumerative connection between their intersection posets and their face lattices due to T.~Zaslavsky~\cite{Zaslavsky}.

\begin{definition}
A (finite affine real) \defn{hyperplane arrangement} is a finite set~$\arrangement$ of affine hyperplanes in~$\R^d$.
\end{definition}

\begin{definition}
A \defn{region} of~$\arrangement$ is a connected component of~$\R^d \ssm \bigcup_{H \in \arrangement} H$.
A \defn{face} of~$\arrangement$ is the intersection of the closure of a region of~$\arrangement$ with an hyperplane of~$\arrangement$.
The \defn{face poset} of~$\arrangement$ is the poset~$\facePoset$ of faces of~$\arrangement$ ordered by inclusion.
The \defn{$f$-polynomial}~$\fPol$ and \defn{$b$-polynomial}~$\bPol$ of~$\arrangement$ are the polynomial
\[
\fPol \eqdef \sum_{k = 0}^d f_k(\arrangement) \, x^k
\qquad\text{and}\qquad
\bPol \eqdef \sum_{k = 0}^d b_k(\arrangement) \, x^k \, ,
\]
where~$f_k(\arrangement)$ denotes the number of $k$-dimensional faces of~$\arrangement$, while~$b_k(\arrangement)$ denotes the number of bounded $k$-dimensional faces of~$\arrangement$.
\end{definition}

\begin{definition}
A \defn{flat} of~$\arrangement$ is a non-empty affine subspace of~$\R^d$ that can be obtained as the intersection of some hyperplanes of~$\arrangement$.
The \defn{flat poset} of~$\arrangement$ is poset~$\flatPoset$ of flats of~$\arrangement$ ordered by reverse inclusion.
\end{definition}

\begin{definition}
\label{def:MobiusPolynomial}
%The \defn{characteristic polynomial}~$\chi_{\arrangement}(y)$ and the \defn{M\"obius polynomial}~$\mu_{\arrangement}(x,y)$ are the polynomials respectively defined by
%\[
%\charPol \eqdef \sum_{G \in \flatPoset} \mu_{\flatPoset}(\R^d, G) \, y^{\dim(G)}
%\quad\text{and}\quad
%\mobPol \eqdef \sum_{F \le G \in \flatPoset} \mu_{\flatPoset}(F,G) \, x^{\dim(F)} \, y^{\dim(G)}
%\]
The \defn{M\"obius polynomial}~$\mu_{\arrangement}(x,y)$ is the polynomial defined by
\[
\mobPol \eqdef \sum_{F \le G} \mu_{\flatPoset}(F,G) \, x^{\dim(F)} \, y^{\dim(G)},
\]
where~$F \le G$ ranges over all intervals of the flat poset~$\flatPoset$, and~$\mu_{\flatPoset}(F,G)$ denotes the \defn{M\"obius function} on the flat poset~$\flatPoset$ defined as usual by
\[
\mu_{\flatPoset}(F, F) = 1
\qquad\text{and}\qquad
\sum_{F \le G \le H} \mu_{\flatPoset}(F,G) = 0
\]
for all~$F, G, H \in \flatPoset$.
\end{definition}

\begin{remark}
Our definition of the M\"obius polynomial slightly differs from that of \cite{Zaslavsky} as we use the dimension of~$F$ instead of its codimension, in order for the next statement to be slightly simpler.
\end{remark}

\begin{theorem}[{\cite[Thm.~A]{Zaslavsky}}]
\label{thm:Zaslavsky}
The $f$-polynomial, the $b$-polynomial, and the M\"obius polynomial of an arrangement~$\arrangement$ are related by
\[
\fPol = \mobPol[\arrangement][-x][-1]
\qquad\text{and}\qquad
\bPol = \mobPol[\arrangement][-x][1].
\]
\end{theorem}

\begin{example}
For the arrangement~$\arrangement$ of $5$ hyperplanes of \cref{fig:arrangement}, we have
\[
\mobPol = x^2y^2 - 5x^2y + 6x^2 + 5xy - 10x + 4 \, ,
\]
so that
\begin{align*}
\fPol & = \mobPol[\arrangement][-x][-1] = 12 \, x^2 + 15 \, x + 4 \\
\text{and}\qquad
\bPol & = \mobPol[\arrangement][-x][1] = 2 \, x^2 + 5 \, x + 4.
\end{align*}
%
\begin{figure}
%	\begin{overpic}[scale=.9]{intersectionPoset}
%		\put(72.5, -2){$1$}
%		\put(51, 10){$-1$}
%		\put(61, 10){$-1$}
%		\put(71, 10){$-1$}
%		\put(82, 10){$-1$}
%		\put(94, 10){$-1$}
%		\put(51.5, 32){$2$}
%		\put(66, 32){$1$}
%		\put(80, 32){$1$}
%		\put(93.5, 32){$2$}
%	\end{overpic}
%	\caption{A hyperplane arrangement (left) and its intersection poset with its M\"obius function (right).}
	\centerline{\includegraphics[scale=.9]{intersectionPoset}}
	\caption{A hyperplane arrangement (left) and its intersection poset (right).}
	\label{fig:arrangement}
\end{figure}
\end{example}

\begin{remark}
\label{rem:characteristicPolynomial}
The coefficient of~$x^d$ in the M\"obius polynomial~$\mobPol$ gives the more classical \defn{characteristic polynomial}
\[
\charPol \eqdef [x^d] \, \mobPol = \sum_F \mu_{\flatPoset}(\R^d,F) \, y^{\dim(F)}.
\]
By \cref{thm:Zaslavsky}, we thus have
\[
f_d(\arrangement) = (-1)^d \, \charPol[\arrangement][-1] 
\qquad\text{and}\qquad
b_d(\arrangement) = (-1)^d \, \charPol[\arrangement][1].
\]
\end{remark}

%%%%%%%%%%%%%%%

\subsection{The braid arrangement}
\label{subsec:braidArrangement}

We now briefly recall the classical combinatorics of the braid arrangement.
See \cref{fig:facePosetBraidArrangement3,fig:intersectionPosetBraidArrangement3,fig:intersectionPosetBraidArrangement4} for illustrations when~$n = 3$ and~$n = 4$.

%\begin{figure}
%	\centerline{\includegraphics[scale=.9]{figures/intersectionPosetBraidArrangement3Full}}
%	\caption{The braid arrangement $\braidArrangement[3]$ (left), its flat poset~$\flatPoset[{\braidArrangement[3]}]$ (middle), and the partition poset~$\partitionPoset[3]$ (right).}
%	\label{fig:braidArrangement3}
%\end{figure}

\afterpage{
\begin{figure}
	\centerline{\includegraphics[scale=.6]{figures/facePosetBraidArrangement3}}
	\caption{The face poset~$\facePoset[{\braidArrangement[3]}]$ of the braid arrangement $\braidArrangement[3]$ (left), where faces are represented as cones (middle) or as ordered set partitions of~$[3]$ (right).}
	\label{fig:facePosetBraidArrangement3}
\end{figure}
}

\afterpage{
\begin{figure}
	\centerline{\includegraphics[scale=.6]{figures/intersectionPosetBraidArrangement3}}
	\caption{The flat poset~$\flatPoset[{\braidArrangement[3]}]$ of the braid arrangement $\braidArrangement[3]$, where flats are represented as intersections of hyperplanes (left) or as set partitions of~$[3]$ (right).}
	\label{fig:intersectionPosetBraidArrangement3}
\end{figure}
}

\afterpage{
\begin{figure}
	\centerline{\includegraphics[scale=.26]{figures/intersectionPosetBraidArrangement4}}
	\caption{The flat poset~$\flatPoset[{\braidArrangement[4]}]$ of the braid arrangement $\braidArrangement[4]$, where flats are represented as intersections of hyperplanes (top) or as set partitions of~$[4]$ (bottom).}
	\label{fig:intersectionPosetBraidArrangement4}
\end{figure}
}

\begin{definition}
Fix~$n \ge 1$ and denote by~$\HH$ the hyperplane of~$\R^n$ defined by~$\sum_{s = 1}^n x_s = 0$.
The \defn{braid arrangement}~$\braidArrangement$ is the arrangement of the hyperplanes~$\set{\b{x} \in \HH}{x_s = x_t}$ for all~$1 \le s < t \le n$.
\end{definition}

\begin{remark}
\label{rem:essential}
Note that we have decided to work in the space~$\HH$ rather than in the space~$\R^n$.
The advantage is that the braid arrangement~$\braidArrangement$ is essential, so that we can speak of its vertices.
Working in~$\R^n$ would change vertices to rays, and would multiply all M\"obius polynomials by a factor~$xy$.
\end{remark}

The combinatorics of the braid arrangement~$\braidArrangement$ is well-known.
The descriptions of its face and flat posets involve both ordered and unordered set partitions.
To avoid confusions, we will always mark with an arrow the ordered structures (ordered set partitions, ordered partition forests, etc.).
Hence, $\pi$ denotes an unordered set partition (the order is irrelevant, neither inside each part, nor between two distinct part), while~$\orient{\pi}$ denotes an ordered set partition (the order inside each part is irrelevant, but the order between distinct parts is relevant).

The braid arrangement~$\braidArrangement$ has a $k$-dimensional face
\[
\Phi(\orient{\pi}) \eqdef \set{\b{x} \in \R^n}{x_s \le x_t \text{ for all $s,t$ such that the part of~$s$ is weakly before the part of~$t$ in $\pi$}}
\]
for each ordered set partition~$\orient{\pi}$ of~$[n]$ into~$k+1$ parts (or equivalently, for each surjection from~$[n]$ to~$[k+1]$).
The face poset~$\facePoset[\braidArrangement]$ is thus (isomorphic to) the refinement poset~$\orientedPartitionPoset$ on ordered set partitions (where an ordered partition~$\orient{\pi}$ is smaller than an ordered partition~$\orient{\omega}$ if each part of~$\orient{\omega}$ is the union of an interval of consecutive parts in~$\orient{\pi}$).
In particular, it has a single vertex corresponding to the ordered partition~$[n]$, $2^n-2$ rays corresponding to the proper nonempty subsets of~$[n]$ (ordered partitions of~$[n]$ into~$2$ parts), and $n!$ regions corresponding to the permutations of~$[n]$ (ordered partitions of~$[n]$ into~$n-1$ parts).
For instance, \cref{fig:facePosetBraidArrangement3} illustrates the face poset of the braid arrangement~$\braidArrangement[3]$.

The braid arrangement~$\braidArrangement$ has a $k$-dimensional~flat
\[
\Psi(\pi) \eqdef \set{\b{x} \in \R^n}{x_s = x_t \text{ for all  $s, t$ which belong to the same part of~$\pi$}}
\]
for each (unordered) set partition~$\pi$ of~$[n]$ into $k+1$ parts.
The flat poset~$\flatPoset[\braidArrangement]$ is thus (isomorphic to) the refinement poset~$\partitionPoset$ on set partitions of~$[n]$ (where a partition~$\pi$ is smaller than a partition~$\omega$ if each part of~$\pi$ is contained in a part of~$\omega$).
For instance, \cref{fig:intersectionPosetBraidArrangement3,fig:intersectionPosetBraidArrangement4} illustrate the flat posets of the braid arrangements~$\braidArrangement[3]$ and~$\braidArrangement[4]$.

The M\"obius function of~$\partitionPoset$ is given by
\[
\mu_{\partitionPoset}(\pi, \omega) = \prod_{p \in \omega} (-1)^{\#\pi[p]-1}(\#\pi[p]-1)! \, ,
\]
where~$\pi[p]$ denotes the restriction of the partition~$\pi$ to the part~$p$ of the partition~$\omega$, and $\#\pi[p]$ denotes its number of parts.
See for instance \cite{Birkhoff, Rota}.
The M\"obius polynomial of the braid arrangement~$\braidArrangement$ is given by
\[
\mobPol[\braidArrangement] = \sum_{k \in [n]} x^{k-1} S(n,k) \prod_{i \in [k-1]} (y-i) \, ,
\]
where~$S(n,k)$ denotes the Stirling number of second kind \OEIS{A008277}, \ie the number of set partitions of~$[n]$ into~$k$ parts.
For instance
\begin{align*}
\mobPol[{\braidArrangement[1]}] & = 1 \\
\mobPol[{\braidArrangement[2]}] & = x y - x + 1 = x (y - 1) + 1 \\
\mobPol[{\braidArrangement[3]}] & = x^2 y^2 - 3 x^2 y + 2 x^2 + 3 x y - 3 x + 1 = x^2 (y - 1) (y - 2) + 3 x (y - 1) + 1\\
\mobPol[{\braidArrangement[4]}] & = x^3 y^3 - 6 x^3 y^2 + 11 x^3 y - 6 x^3 + 6 x^2 y^2 - 18 x^2 y + 12 x^2 + 7 x y - 7 x + 1 \\
& = x^3 (y - 1) (y - 2) (y - 3) + 6 x^2 (y - 1) (y - 2) + 7 x (y - 1) + 1.
\end{align*}
In particular, the characteristic polynomial of the braid arrangement~$\braidArrangement$ is given by
\[
\charPol[\braidArrangement] = (y-1) (y-2) \dots (y-n-1).
\]
Working in~$\R^n$ rather than in~$\HH$ would lead to an additional~$y$ factor in this formula, which might be more familiar to the reader
See \cref{rem:essential}.

Finally, we will consider the evaluation of the M\"obius polynomial~$\mobPol[\braidArrangement]$ at~$y = 0$:
\[
\weirdPol[n] \eqdef \mobPol[\braidArrangement][x][0] = \sum_{k \in [n]} (-1)^{k-1} \, (k-1)! \, S(n,k) \, x^{k-1}.
\] 
The coefficients of this polynomial are given by the sequence \OEIS{A028246}.
We just observe here that it is connected to the $\b{f}$-polynomial of~$\braidArrangement$.

\begin{lemma}
We have~$\weirdPol[n] = (1-x) \, \fPol[\braidArrangement]$.
\end{lemma}

\begin{proof}
This lemma is equivalent to the following equality:
\begin{equation*}
\sum_{k=1}^n (-1)^{k-1} (k-1)! \, S(n,k) \, x^{k-1} = (1-x) \sum_{k=1}^{n-1} (-1)^{k-1} \, k! \, S(n-1,k) \, x^{k-1}.
\end{equation*}
Distributing $(1-x)$ in the right hand side gives:
\begin{gather*}
(1-x) \sum_{k=1}^{n-1} (-1)^{k-1} \, k! \, S(n-1,k) \, x^{k-1} \\
= \sum_{k=1}^{n-1} k! \, S(n-1,k) \, (-x)^{k-1} + \sum_{k=1}^{n-1} k! \, S(n-1,k) \, (-x)^{k} \\
= \sum_{k=1}^{n-1} k! \, S(n-1,k) \, (-x)^{k-1} + \sum_{k=2}^{n} (k-1)! \, S(n-1,k-1) \, (-x)^{k-1} + (n-1)! \, S(n-1, n-1) \, (-x)^{n-1} \\
= S(n-1,1) \, (-x)^0 + \sum_{k=2}^{n-1} (k-1)! \, \big( S(n-1,k-1) + k \, S(n-1,k) \big) \, (-x)^{k-1}.
\end{gather*}
The result thus follows from the inductive formula on Stirling numbers of the second kind
\[
S(n+1,k) = k S(n,k) + S(n,k-1)
\]
for $0<k<n$.
\end{proof}

%%%%%%%%%%%%%%%

\subsection{The $(\ell,n)$-braid arrrangement}
\label{subsec:multiBraidArrangement}

We now focus on the following specific hyperplane arrangements, illustrated in \cref{fig:multiBraidArrangements}.

\begin{figure}[t]
	\centerline{
	\begin{tabular}{c@{\hspace{.7cm}}c@{\hspace{.7cm}}c@{\hspace{.7cm}}c}
		\includegraphics[scale=.4]{multiBraidArrangement1}
		&
		\includegraphics[scale=.4]{multiBraidArrangement2}
		&
		\includegraphics[scale=.4]{multiBraidArrangement3}
		&
		\includegraphics[scale=.4]{multiBraidArrangement4}
		\\
		$\ell = 1$ & $\ell = 2$ & $\ell = 3$ & $\ell = 4$
	\end{tabular}
	}
	\caption{The $(\ell,3)$-braid arrangements for~$\ell \in [4]$.}
	\label{fig:multiBraidArrangements}
\end{figure}

\begin{definition}
\label{def:multiBraidArrangement}
The \defn{$(\ell,n)$-braid arrangement}~$\multiBraidArrangement$ is the arrangement obtained as the union of $\ell$ generically translated copies of the braid arrangement~$\braidArrangement$.
\end{definition}

This definition is slightly misleading, as the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ a priori depends on the (generic) translation vectors chosen for each copy.
We will see that many combinatorial aspects of~$\multiBraidArrangement$ are in fact independent of the translation vectors, in particular the flat poset and thus the $f$-vector of~$\multiBraidArrangement$.
However, the combinatorial description of the face poset of~$\multiBraidArrangement$ will depend on the translation vectors, so that we introduce the following more precise notation recording of the translations.

\begin{definition}
\label{def:multiBraidArrangementPrecise}
For any integers~$\ell,n \geq 1$, and a generic matrix~$\b{a} \eqdef (a_{i,j}) \in M_{\ell,n-1}(\R)$ of~$\R^n$, the \defn{$\b{a}$-braid arrangement}~$\multiBraidArrangement(\b{a})$ is the arrangement of hyperplanes~$\set{\b{x} \in \HH}{x_s - x_t = A_{i,s,t}}$ for all~$1 \le s < t \le n$ and~$i \in [\ell]$, where $A_{i,s,t} \eqdef \smash{\sum_{s \le j < t} a_{i,j}}$.
\end{definition}

%\begin{remark}
%\label{rem:multiBraidArrangement}
%In practice, consider the hyperplanes~$\set{\b{x} \in \HH}{x_s - x_t = A_{i,s,t}}$ for all~$1 \le s < t \le n$ and~$i \in [\ell]$, where $A_{i,s,t} \eqdef \smash{\sum_{s \le j < t} a_{i,j}}$ for an arbitrary generic matrix~$(a_{i,j}) \in M_{\ell,n-1}(\R)$.
%\end{remark}

The objective of \cref{part:multiBraidArrangements} is to explore the combinatorics of these multiple braid arrangements.
We have split our presentation into two sections:
\begin{itemize}
\item In \cref{sec:flatPoset}, we describe the flat poset~$\flatPoset[\multiBraidArrangement]$ of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ in terms of $(\ell,n)$-partition forests (\cref{subsec:partitionForests}) and labeled $(\ell,n)$-rainbow forests (\cref{subsec:rainbowForests}), which enables us to derive its M\"obius, $f$- and $b$- polynomials (\cref{subsec:MobiusPolynomialMultiBraidArrangement}), from which we extract interesting formulas for the number of vertices (\cref{subsec:verticesMultiBraidArrangement}) and regions (\cref{subsec:regionsMultiBraidArrangement}). Note that all these results are independent of the translation vectors.
\item In \cref{sec:facePoset}, we describe the face poset~$\facePoset[\multiBraidArrangement(\b{a})]$ of the $\b{a}$-braid  arrangement~$\multiBraidArrangement(\b{a})$ in terms of ordered $(\ell,n)$-partition forests (\cref{subsec:orderedPartitionForests}). In contrast to the flat poset, this description of the face poset depends on the translation vectors. For a given choice of translation matrix~$\b{a}$, we describe in particular the ordered $(\ell,n)$-partitions forests with a given underlying (unordered) $(\ell,n)$-partition forest (\cref{subsec:PFtoOPF}). We then give a criterion to decide whether a given ordered $(\ell,n)$-partition forest corresponds to a face of~$\multiBraidArrangement(\b{a})$ (\cref{subsec:criterionOPF}).
\end{itemize}

\begin{remark}
Note that each hyperplane of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is orthogonal to a root~$\b{e}_i-\b{e}_j$ of the type~$A$ root system.
Many such arrangements have been studied previously, for instance, the \defn{Shi arrangement}~\cite{Shi1, Shi2}, the \defn{Catalan arrangement}~\cite[Sect.~7]{PostnikovStanley}, the \defn{Linial arrangement}~\cite[Sect.~8]{PostnikovStanley}, the \defn{generic arrangement} of~\cite[Sect.~5]{PostnikovStanley}, or the \defn{discriminantal arrangements} of~\cite{ManinSchechtman,BayerBrandt}.
We refer to the work of A.~Postnikov and R.~Stanley~\cite{PostnikovStanley} and of O.~Bernardi~\cite{Bernardi} for much more references.
However, in all these examples, either the copies of the braid arrangement are perturbed, or they are translated non-generically.
We have not been able to find the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ properly treated in the literature.
\end{remark}

\begin{remark}
Part of our discussion on the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ could actually be developed for an hyperplane arrangement~$\arrangement^\ell$ obtained as the union of~$\ell$ generically translated copies of an arbitrary linear hyperplane arrangement~$\arrangement$.
Similarly to \cref{prop:flatPosetMultiBraidArrangement}, the flat poset~$\flatPoset[\arrangement^\ell]$ is isomorphic to the lower set of the $\ell$\ordinal{} Cartesian power of the flat poset~$\flatPoset$ induced by the $\ell$-tuples whose meet in the flat poset~$\flatPoset$ is the bottom element~$\b{0}$ (these are sometimes called strong antichains) and which are minimal for this property.
Similar to \cref{thm:MobiusPolynomialMultiBraidArrangement}, this yields a general formula for the M\"obius polynomial of~$\arrangement^\ell$ in terms of the M\"obius function of the flat poset~$\flatPoset$.
Here, we additionally benefit from the nice properties of the M\"obius polynomial of the braid arrangement~$\braidArrangement$ to obtain appealing formulas for the vertices, regions and bounded regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ (see \cref{thm:verticesMultiBraidArrangement,thm:verticesRefinedMultiBraidArrangement,thm:characteristicPolynomialMultiBraidArrangement,thm:regionsMultiBraidArrangement}).
We have therefore decided to restrict our attention to the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Flat poset and enumeration of~$\multiBraidArrangement$}
\label{sec:flatPoset}

In this section, we describe the flat poset of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ in terms of $(\ell,n)$-partition forests and derive explicit formulas for its $f$-vector.
Remarkably, the flat poset (and thus the M\"obius, $f$- and $b$- polynomials) of~$\multiBraidArrangement$ is independent of the translation vectors as long as they are generic.

%%%%%%%%%%%%%%%

\subsection{Partition forests}
\label{subsec:partitionForests}

We first introduce the main characters of this section, which will describe the combinatorics of the flat poset of~$\multiBraidArrangement$.

\begin{definition}
\label{def:partitionForests}
The \defn{intersection hypergraph} of a $\ell$-tuple~$\b{F} \eqdef (F_1, \dots, F_\ell)$ of set partitions of~$[n]$ is the $\ell$-regular $\ell$-partite hypergraph on all parts of all the partitions~$F_i$ for~${i \in [\ell]}$, with an hyperedge connecting the parts containing~$j$  for each~$j \in [n]$.
A \defn{$(\ell,n)$-partition forest} (\resp \defn{$(\ell,n)$-partition tree}) is a $\ell$-tuple~$\b{F} \eqdef (F_1, \dots, F_\ell)$ of set partitions of~$[n]$ whose intersection hypergraph is a hyperforest (\resp hypertree).
The \defn{dimension} of~$\b{F}$ is~$\smash{{\dim(\b{F}) \eqdef n - 1 - \ell n + \sum_{i \in [\ell]} \#F_i}}$.
See \cref{fig:forests}.
The \defn{$(\ell,n)$-partition forest poset} is the poset~$\forestPoset$ on $(\ell,n)$-partition forests ordered by componentwise refinement.
In other words, $\forestPoset$ is the lower set of the $\ell$\ordinal{} Cartesian power of the partition poset~$\partitionPoset$ induced by $(\ell,n)$-partition forests.
Note that the maximal elements of~$\forestPoset$ are the $(\ell, n)$-partition trees.
%
\begin{figure}[b]
	\centerline{\includegraphics[scale=.9]{forests}}
	\caption{Some $(3,6)$-partition forests (top) with their intersection hypergraphs (middle) and the corresponding labeled $(3,6)$-rainbow forests (bottom). The last two are trees. The order of the colors is red, green, blue.}
	\label{fig:forests}
\end{figure}
\end{definition}

The following statement is illustrated in \cref{fig:intersectionPosetMultiBraidArrangement32}.
%
\begin{figure}
	\centerline{\includegraphics[scale=.9]{figures/intersectionPosetMultiBraidArrangement32Full}}
	\caption{The $(2,3)$-braid arrangement $\multiBraidArrangement[3][2]$ (left), and its flat poset (right), where flats are represented as intersections of hyperplanes (top), as $(2,3)$-partitions forests (middle), and as labeled $(2,3)$-rainbow forests (bottom).}
	\label{fig:intersectionPosetMultiBraidArrangement32}
\end{figure}

\begin{proposition}
\label{prop:flatPosetMultiBraidArrangement}
The flat poset~$\flatPoset[\multiBraidArrangement]$ of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is isomorphic to the $(\ell,n)$-partition forest poset.
\end{proposition}

\begin{proof}
Consider the hyperplanes~$\set{\b{x} \in \HH}{x_s - x_t = A_{i,s,t}}$ described in \cref{def:multiBraidArrangementPrecise}.
For each~${i \in [\ell]}$, each set partition~$\pi$ of~$[n]$ corresponds to a $(\#\pi)$-dimensional flat
\[
\Psi_i(\pi) \eqdef \set{\b{x} \in \HH}{x_s - x_t = A_{i,s,t} \text{ for all $s,t$ in the same part of $F_i$} }
\]
of the $i$\ordinal{} copy of the braid arrangement~$\braidArrangement$.
The flats of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ are thus all of the form
\[
\Psi(\b{F}) \eqdef \bigcap_{i \in [\ell]} \Psi_i(F_i)
\]
for certain $\ell$-tuples~$\b{F} \eqdef (F_1, \dots, F_\ell)$ of set partitions of~$[n]$.
Since the parameters~$A_{i,s,t}$ are generic, $\Psi(\b{F})$ is non-empty if and only if the intersection hypergraph of~$\b{F}$ is acyclic.
Moreover, $\Psi(\b{F})$ is included in~$\Psi(\b{G})$ if and only if~$\b{F}$ refines~$\b{G}$ componentwise.
Hence, the flat poset of~$\multiBraidArrangement$ is isomorphic to the $(\ell,n)$-partition forest poset.
Finally, notice that the codimension of the flat~$\Psi(\b{F})$ is the sum of the codimensions of the flats~$\Psi_i(F_i)$ for~$i \in [\ell]$, so that~$\dim(\b{F}) \eqdef n - 1 - \ell n + \sum_{i \in [\ell]} \#F_i $ is indeed the dimension of the flat~$\Psi(\b{F})$.
\end{proof}

%%%%%%%%%%%%%%%

\subsection{M\"obius polynomial}
\label{subsec:MobiusPolynomialMultiBraidArrangement}

We thus derive the M\"obius polynomial of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ by \cref{def:MobiusPolynomial,prop:flatPosetMultiBraidArrangement}.

\begin{theorem}
\label{thm:MobiusPolynomialMultiBraidArrangement}
The M\"obius polynomial of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is given by
\[
\mobPol[\multiBraidArrangement] = x^{n-1-\ell n} y^{n-1-\ell n} \sum_{\b{F} \le \b{G}} \prod_{i \in [\ell]} x^{\#F_i} y^{\#G_i} \prod_{p \in G_i} (-1)^{\#F_i[p]-1} (\# F_i[p]-1)! \; ,
\]
where~$\b{F} \le \b{G}$ ranges over all intervals of the $(\ell,n)$-partition forest poset~$\forestPoset$, and~$F_i[p]$ denotes the restriction of the partition~$F_i$ to the part~$p$ of~$G_i$.
\end{theorem}

\begin{proof}
Observe that for~$\b{F} \eqdef (F_1, \dots, F_\ell)$ and~$\b{G} \eqdef (G_1, \dots, G_\ell)$ in~$\forestPoset$, we have
\[
[\b{F}, \b{G}] = \prod_{i \in [\ell]} [F_i, G_i] \simeq \prod_{i \in [\ell]} \prod_{p \in G_i} \partitionPoset[{\#F_i[p]}].
\]
Recall that the M\"obius function is multiplicative:
\(
\mu_{P \times Q} \big( (p,q), (p‚Äô,q‚Äô) \big) = \mu_P(p,p‚Äô) \cdot \mu_Q(q,q‚Äô),
\)
for all~$p, p' \in P$ and~$q, q' \in Q$.
Hence, we obtain that
\[
\mu_{\forestPoset}(\b{F}, \b{G}) = \prod_{i \in [\ell]} \prod_{p \in G_i} (-1)^{\#F_i[p]-1} (\# F_i[p]-1)! \, .
\]
Hence, we derive from \cref{def:MobiusPolynomial,prop:flatPosetMultiBraidArrangement} that
\begin{align*}
\mobPol[\multiBraidArrangement] 
& = \sum_{\b{F} \le \b{G}} \mu_{\forestPoset}(\b{F}, \b{G}) \, x^{\dim(\b{F})} \, y^{\dim(\b{G})} \\
& = x^{n-1-\ell n} y^{n-1-\ell n} \sum_{\b{F} \le \b{G}} \prod_{i \in [\ell]} x^{\#F_i} y^{\#G_i} \prod_{p \in G_i} (-1)^{\#F_i[p]-1} (\# F_i[p]-1)! \, .
\qedhere
\end{align*}
\end{proof}

By using the polynomial
\[
\weirdPol[n] \eqdef \mobPol[\braidArrangement][x][0] = \sum_{k \in [n]} (-1)^{k-1} \, (k-1)! \, S(n,k) \, x^{k-1}
\]
introduced at the end of \cref{subsec:braidArrangement}, the M\"obius polynomial~$\mobPol[\multiBraidArrangement]$ can also be expressed as follows.

\pagebreak
\begin{proposition} 
The M\"obius polynomial of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is given by
\[
\mobPol[\multiBraidArrangement] = x^{(n-1)(1-\ell)} \sum_{G \in \forestPoset} y^{n-1-\ell n+\sum_{i \in [\ell]} \#G_i}  \prod_{i \in [\ell]} \weirdPol[\#G_i]
\]
In terms of rainbow forests, this rewrites as
\[
\mobPol[\multiBraidArrangement] = x^{(n-1)(1-\ell)} \sum_{G \in \rainbowForests} y^{n-1+\#E(G)}  \prod_{i \in [\ell]} \weirdPol[n-\#E(G,i)]
\]
\end{proposition}

\begin{proof}
As already mentioned, the $(\ell,n)$-partition forest poset~$\forestPoset$ is a lower set of the $\ell$\ordinal{} Cartesian power of the partition poset~$\partitionPoset$.
In other words, given a $(\ell,n)$-partition forest $\b{G} \eqdef (G_1, \dots, G_\ell)$, any $\ell$-tuple~$\b{F} \eqdef (F_1, \dots, F_\ell)$ of partitions satisfying~$F_i \le_{\partitionPoset[n]} G_i$ for all~$i \in [\ell]$ is a $(\ell,n)$-partition forest.
Hence, we obtain from \cref{thm:MobiusPolynomialMultiBraidArrangement} that
\begin{align*}
\mobPol[\multiBraidArrangement]
& = \sum_{G \in \forestPoset} y^{n-\ell n - 1 + \sum_{i \in [\ell]} \#G_i} \prod_{i \in [\ell]} \sum_{F_i \leq_{\partitionPoset[n]} G_i } \mu_{\partitionPoset[n]}(F_i,G_i) \, x^{n-\ell n - 1 + \sum_{i \in [\ell]} \#F_i}, \\
& = \sum_{G \in \forestPoset} y^{n-\ell n - 1 + \sum_{i \in [\ell]} \#G_i} x^{(n-1)(1-\ell)} \prod_{i \in [\ell]} \sum_{\pi_i \in \partitionPoset[\#G_i]}  \mu_{\partitionPoset[\#G_i]}(\pi_i,\hat{1}) \, x^{\#\pi_i-1}, 
\end{align*}
where $\hat{1}$ denotes the maximal element in $\partitionPoset[\#G_i]$ and $\pi_i$ is obtained from $F_i$ by merging elements in the same part of $G_i$.
The result follows since~$\weirdPol[\#G_i] = \sum_{\pi_i \in \partitionPoset[\#G_i]}  \mu_{\partitionPoset[\#G_i]}(\pi_i,\hat{1}) \, x^{\#\pi_i-1}$.
%Hence, we obtain
%\[
%\mobPol[\multiBraidArrangement] = \sum_{G \in \forestPoset} y^{n-\ell n - 1 + \sum_{i=1}^\ell \#G_i} x^{(n-1)(1-\ell)} \prod_{i \in [\ell]} \weirdPol[\#G_i].
%\qedhere
%\]
\end{proof}

%\begin{proof}
%We have
%\begin{align*}
%\mobPol[\multiBraidArrangement]
%& = \sum_{F \leq G} \mu_{\flatPoset}(F,G) \, x^{\dim(F)} \, y^{\dim(G)}, \\
% &=\sum_{G \in \rainbowForests} y^{n-1-\ell-\#E(G)} \sum_{F \in \rainbowForests, F \leq G } \mu_{\forestPoset}(F,G) \, x^{n-1-\ell-\#E(F)}, \\
% &=\sum_{G \in \forestPoset} y^{n-1-\ell n+\sum_{i=1}^\ell \#G_i} \sum_{F \in \forestPoset, F \leq G } \mu_{\forestPoset}(F,G) \, x^{n-1-\ell n+\sum_{i=1}^\ell \#F_i},
%\end{align*}
%where $E(G)$ (\resp $E(G,i)$) denotes the set of edges (\resp of edges of color $i$) in $G$ which satisfies $n-\#E(G,i) =  \#G_i$.
%
%Observe that for~$\b{F} \eqdef (F_1, \dots, F_\ell)$ and~$\b{G} \eqdef (G_1, \dots, G_\ell)$ in~$\forestPoset$, we have
%\[
%[\b{F}, \b{G}] = \prod_{i \in [\ell]} [F_i, G_i],
%\]
%where $[F_i, G_i]$ is an interval of $\partitionPoset[n]$. Morover, given a $(\ell,n)$-partition forest $\b{G}\eqdef (G_1, \dots, G_\ell)$, any n-tuples of partition $(F_1, \dots, F_\ell)$ satisfying for any $1\leq i \leq \ell$ $F_i \leq_{\partitionPoset[n]} G_i $ is a $(\ell,n)$-partition forest as its intersection hypergraph is a subforest of the intersection hypergraph of $G$. 
%Recall moreover that the M\"obius function is multiplicative.
%
%Hence, we obtain that
%\begin{align*}
%\mobPol[\multiBraidArrangement] &=\sum_{G \in \forestPoset} y^{n-\ell n - 1 + \sum_{i=1}^\ell \#G_i} \prod_{i=1}^{\ell} \sum_{F_i \leq_{\partitionPoset[n]} G_i } \mu_{\partitionPoset[n]}(F_i,G_i) \, x^{n-\ell n - 1 + \sum_{i=1}^\ell \#F_i}, \\
% &=\sum_{G \in \forestPoset} y^{n-\ell n - 1 + \sum_{i=1}^\ell \#G_i} x^{(n-1)(1-\ell)} \prod_{i=1}^{\ell} \sum_{\pi_i \in \partitionPoset[\#G_i]}  \mu_{\partitionPoset[\#G_i]}(\pi_i,\hat{1}) \, x^{\#\pi_i-1}, 
%\end{align*}
%where $\hat{1}$ denotes the maximal element in $\partitionPoset[\#G_i]$ and $\pi_i$ is obtained from $F_i$ by merging elements in the same part of $G_i$.
%
%Finally, we get:
%\[
%\mobPol[\multiBraidArrangement]=\sum_{G \in \forestPoset} y^{n-\ell n - 1 + \sum_{i=1}^\ell \#G_i} x^{(n-1)(1-\ell)} \prod_{i=1}^{\ell} P_{\#G_i}(x).
%\qedhere
%\]
%\end{proof}

\begin{remark}
To further simplify this expression, we would need to count the number of rainbow forests with a prescribed number of colored edges, however this number does not admit a  known multiplicative formula, up to our knowledge. When there is only one color, the corresponding sequence (counting non colored forests on $n$ nodes and $k$ edges, rooted in the minimal label of each connected component) is \OEIS{A138464}.
\end{remark}

From \cref{thm:Zaslavsky,thm:MobiusPolynomialMultiBraidArrangement}, we thus obtain the face numbers and bounded face numbers of~$\multiBraidArrangement$, whose first few values are gathered in \cref{table:fvectorMultiBraidArrangements}.

%\begin{table}
%\centerline{
%	\begin{tabular}{c@{\hspace{.7cm}}c}
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $2$ & $1$ &&& $3$ \\
%			$3$ & $6$ & $6$ & $1$ && $13$ \\
%			$4$ & $24$ & $36$ & $14$ & $1$ & $75$
%		\end{tabular}
%		&
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $3$ & $2$ &&& $5$ \\
%			$3$ & $17$ & $24$ & $8$ && $49$ \\
%			$4$ & $149$ & $324$ & $226$ & $50$ & $749$
%		\end{tabular}
%		\\[2cm]
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $0$ & $1$ &&& $1$ \\
%			$3$ & $0$ & $0$ & $1$ && $1$ \\
%			$4$ & $0$ & $0$ & $0$ & $1$ & $1$
%		\end{tabular}
%		&
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $1$ & $2$ &&& $3$ \\
%			$3$ & $5$ & $12$ & $8$ && $25$ \\
%			$4$ & $43$ & $132$ & $138$ & $50$ & $363$
%		\end{tabular}
%		\\[2cm]
%		$\ell = 1$ & $\ell = 2$
%		\\[.8cm]
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $4$ & $3$ &&& $7$ \\
%			$3$ & $34$ & $54$ & $21$ && $109$ \\
%			$4$ & $472$ & $1152$ & $924$ & $243$ & $2791$
%		\end{tabular}
%		&
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $5$ & $4$ &&& $9$ \\
%			$3$ & $57$ & $96$ & $40$ && $193$ \\
%			$4$ & $1089$ & $2808$ & $2396$ & $676$ & $6969$
%		\end{tabular}
%		\\[2cm]
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $2$ & $3$ &&& $5$ \\
%			$3$ & $16$ & $36$ & $21$ && $73$ \\
%			$4$ & $224$ & $684$ & $702$ & $243$ & $1853$
%		\end{tabular}
%		&
%		\begin{tabular}[t]{c|cccc|c}
%			$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
%			\hline
%			$1$ & $1$ &&&& $1$ \\
%			$2$ & $3$ & $4$ &&& $7$ \\
%			$3$ & $33$ & $72$ & $40$ && $145$ \\
%			$4$ & $639$ & $1944$ & $1980$ & $676$ & $5239$
%		\end{tabular}
%		\\[2cm]
%		$\ell = 3$ & $\ell = 4$
%	\end{tabular}
%	}
%	\vspace{.3cm}
%	\caption{The face numbers (top) and the bounded face numbers (bottom) of the $(\ell,n)$-braid arrangements for~$\ell, n \in [4]$.}
%	\label{table:fvectorMultiBraidArrangements}
%\end{table}

\begin{table}[b]
	\centerline{\scalebox{.8}{
		\begin{tabular}{c@{\hspace{.7cm}}c@{\hspace{.7cm}}c@{\hspace{.7cm}}c}
			$\ell = 1$ & $\ell = 2$ & $\ell = 3$ & $\ell = 4$
			\\[.2cm]
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $2$ & $1$ &&& $3$ \\
				$3$ & $6$ & $6$ & $1$ && $13$ \\
				$4$ & $24$ & $36$ & $14$ & $1$ & $75$
			\end{tabular}
			&
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $3$ & $2$ &&& $5$ \\
				$3$ & $17$ & $24$ & $8$ && $49$ \\
				$4$ & $149$ & $324$ & $226$ & $50$ & $749$
			\end{tabular}
			&
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $4$ & $3$ &&& $7$ \\
				$3$ & $34$ & $54$ & $21$ && $109$ \\
				$4$ & $472$ & $1152$ & $924$ & $243$ & $2791$
			\end{tabular}
			&
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $5$ & $4$ &&& $9$ \\
				$3$ & $57$ & $96$ & $40$ && $193$ \\
				$4$ & $1089$ & $2808$ & $2396$ & $676$ & $6969$
			\end{tabular}
			\\[2.3cm]
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $0$ & $1$ &&& $1$ \\
				$3$ & $0$ & $0$ & $1$ && $1$ \\
				$4$ & $0$ & $0$ & $0$ & $1$ & $1$
			\end{tabular}
			&
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $1$ & $2$ &&& $3$ \\
				$3$ & $5$ & $12$ & $8$ && $25$ \\
				$4$ & $43$ & $132$ & $138$ & $50$ & $363$
			\end{tabular}
			&
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $2$ & $3$ &&& $5$ \\
				$3$ & $16$ & $36$ & $21$ && $73$ \\
				$4$ & $224$ & $684$ & $702$ & $243$ & $1853$
			\end{tabular}
			&
			\begin{tabular}[t]{c|cccc|c}
				$n \backslash k$ & $0$ & $1$ & $2$ & $3$ & $\Sigma$ \\
				\hline
				$1$ & $1$ &&&& $1$ \\
				$2$ & $3$ & $4$ &&& $7$ \\
				$3$ & $33$ & $72$ & $40$ && $145$ \\
				$4$ & $639$ & $1944$ & $1980$ & $676$ & $5239$
			\end{tabular}
		\end{tabular}
	}}
%	\vspace{.3cm}
	\caption{The face numbers (top) and the bounded face numbers (bottom) of the $(\ell,n)$-braid arrangements for~$\ell, n \in [4]$.}
	\label{table:fvectorMultiBraidArrangements}
\end{table}

\begin{corollary}
\label{coro:fbvectorsMultiBraidArrangement}
The $f$- and $b$-polynomials of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ are given by
\begin{align*}
\fPol[\multiBraidArrangement] & = x^{n-1-\ell n}\sum_{\b{F} \le \b{G}} \prod_{i \in [\ell]} x^{\#F_i} \prod_{p \in G_i} (\# F_i[p]-1)!\\
\text{and}\qquad
\bPol[\multiBraidArrangement] & = (-1)^\ell x^{n-1-\ell n} \sum_{\b{F} \le \b{G}} \prod_{i \in [\ell]} x^{\#F_i} \prod_{p \in G_i} -(\# F_i[p]-1)! \, ,
\end{align*}
where~$\b{F} \le \b{G}$ ranges over all intervals of the $(\ell,n)$-partition forest poset~$\forestPoset$, and~$F_i[p]$ denotes the restriction of the partition~$F_i$ to the part~$p$ of~$G_i$.
\end{corollary}

\begin{example}
For~$n = 1$, we have
\[
\mobPol[{\multiBraidArrangement[1][\ell]}] = \fPol[{\multiBraidArrangement[1][\ell]}] = \bPol[{\multiBraidArrangement[1][\ell]}] = 1.
\]
For~$n = 2$, we have
\[
\mobPol[{\multiBraidArrangement[2][\ell]}] = xy-\ell x+\ell,
\quad
\fPol[{\multiBraidArrangement[2][\ell]}] = (\ell+1)x+\ell
\quad\text{and}\quad
\bPol[{\multiBraidArrangement[2][\ell]}] = (\ell-1)x+\ell.
\]
The case~$n = 3$ is already more interesting.
Consider the set partitions~$P \eqdef \big\{ \{1\}, \{2\}, \{3\} \big\}$, $Q_i \eqdef \big\{ \{i\}, [3] \ssm \{i\} \big\}$ for~$i \in [3]$, and~$R \eqdef \big\{ [3] \big\}$.
Observe that the $(\ell,3)$-partition forests are all of the form
\begin{gather*}
\b{F} \eqdef P^\ell,
\quad
\b{G}_i^p \eqdef P^p Q_i P^{\ell-p-1}, % \text{ for } p \le \ell-1 \text{ and } i \in [3],
\quad
\b{H}_{i,j}^{p,q} \eqdef P^p Q_i P^{\ell-p-q-2} Q_j P^q \;\text{($i \ne j$)} % \text{ for } p + q \le \ell-2 \text{ and } i \ne j \in [3]
\quad\text{or}\quad
\b{K}^p \eqdef P^p R P^{\ell-p-1}. % \text{ for } p \le \ell-1.
\end{gather*}
(where we write a tuple of partitions of~$[3]$ as a word on~$\{P, Q_1, Q_2, Q_3, R\}$, and $p$ and $q$ are such that the total length is~$\ell$).
%\begin{gather*}
%\b{F} \eqdef (\underbrace{P, \dots, P}_\ell), \\
%\b{G}_i^p \eqdef (\underbrace{P, \dots, P}_p, Q_i, \underbrace{P, \dots, P}_{\ell-p-1}) \text{ for } p \le \ell-1 \text{ and } i \in [3],
%\\
%\b{H}_{i,j}^{p,q} \eqdef (\underbrace{P, \dots, P}_p, Q_i, \underbrace{P, \dots, P}_{\ell-p-q-2}, Q_j, \underbrace{P, \dots, P}_q) \text{ for } p + q \le \ell-2 \text{ and } i \ne j \in [3],
%\\
%\text{or}\quad
%\b{K}^p \eqdef (\underbrace{P, \dots, P}_p, R, \underbrace{P, \dots, P}_{\ell-p-1}) \text{ for } p \le \ell-1.
%\end{gather*}
Moreover, the cover relations in the $(\ell,3)$-partition forest poset are precisely the relations
\[
\b{F} \le \b{G}_i^p \hspace{-.4cm} \begin{array}{l} \rotatebox[origin=c]{45}{$\le$} \raisebox{.2cm}{$\b{H}_{i,j}^{p,q}$} \\[.1cm] \quad \le \b{K}^p \\[.1cm] \rotatebox[origin=c]{-45}{$\le$} \raisebox{-.2cm}{$\b{H}_{j,i}^{\ell-q-1, \ell-p-1}$} \end{array}
\]
for~$i \ne j$ and~$p, q$ such that~$p + q \le \ell-2$.
Hence, we have
\begin{align*}
\mobPol[{\multiBraidArrangement[3][\ell]}] & = x^2 y^2 - 3 \ell x^2 y + \ell (3 \ell - 1) x^2 + 3 \ell x y - 3 \ell (2 \ell - 1) x + \ell (3 \ell - 2) , \\
\fPol[{\multiBraidArrangement[3][\ell]}] & = (3 \ell^2 + 2 \ell + 1) x^2 + 6 \ell^2 x + \ell (3 \ell - 2), \\
\text{and}\qquad
\bPol[{\multiBraidArrangement[3][\ell]}] & = (3 \ell^2 - 4 \ell + 1) x^2 + 6 \ell (\ell - 1) x + \ell (3 \ell - 2).
\end{align*}
Observe that~$3 \ell^2 + 2 \ell + 1$ is~\OEIS{A056109}, that~$\ell (3 \ell - 2)$ is~\OEIS{A000567}, and that ${3 \ell^2 - 4 \ell + 1}$ is~\OEIS{A045944}.
%\vincenti{There is a weird connection between the first and the last. Namely, $3 \ell^2 - 4 \ell + 1 = 3 (\ell - 1)^2 + 2 (\ell - 1)$. Is there a bijective explanation on the arrangements?}
\end{example}

%%%%%%%%%%%%%%%

\subsection{Rainbow forests}
\label{subsec:rainbowForests}

In order to obtain more explicit formulas for the number of vertices and regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ in \cref{subsec:verticesMultiBraidArrangement,subsec:regionsMultiBraidArrangement}, we now introduce another combinatorial model for $(\ell,n)$-partition forests which is more adapted to their enumeration.

\begin{definition}
\label{def:rainbowForest}
A \defn{$\ell$-rainbow coloring} of a rooted plane forest~$F$ is an assignment of colors of~$[\ell]$ to the non-root nodes of~$F$ such that
\begin{enumerate}[(i)]
\item there is no monochromatic edge,
\item the colors of siblings are increasing from left to right.
\end{enumerate}
We denote by~$\|F\|$ the number of nodes of~$F$ and by~$\#F$ the number of trees of the forest~$F$ (\ie its number of connected components).
A \defn{$(\ell,n)$-rainbow forest} (\resp \defn{tree}) is a \mbox{$\ell$-rainbow} colored forest (\resp tree) with $\|F\| = n$ nodes.
We denote by~$\rainbowForests$ (\resp $\rainbowTrees$) the set of $(\ell,n)$-rainbow forests (\resp trees), and set~$\rainbowForests[][\ell] \eqdef \bigsqcup_n \rainbowForests$ (\resp $\rainbowTrees[][\ell] \eqdef \bigsqcup_n \rainbowTrees$).
\end{definition}

For instance, we have listed all $(2,4)$-rainbow trees in \cref{fig:rainbowTrees}\,(top).
This figure actually illustrates the following statement.

\begin{lemma}
\label{lem:FussCatalan}
The $(\ell,m)$-rainbow trees are counted by the \defn{Fuss-Catalan number}
\[
\# \rainbowTrees[m][\ell] = F_{\ell,m} \eqdef \frac{1}{(\ell-1)m+1} \binom{\ell m}{m} \qquad \text{\OEIS{A062993}}.
\]
\end{lemma}

\begin{proof}
We can transform a $\ell$-rainbow tree~$R$ to a $\ell$-ary tree~$T$ as illustrated in \cref{fig:rainbowTrees}.
Namely, the parent of a node~$N$ in~$T$ is the previous sibling colored as~$N$ in~$R$ if it exists, and the parent of~$N$ in~$R$ otherwise.
This classical map is a bijection from $\ell$-rainbow trees to a $\ell$-ary trees, which are counted by the Fuss-Catalan numbers~\cite{Klarner, HiltonPedersen}.
%
\begin{figure}
	\centerline{\includegraphics[scale=.7]{rainbowTrees}}
	\caption{The $14$ $(2,4)$-rainbow trees (top) and $14$ binary trees (bottom), and the simple bijection between them (middle). The order of the colors is red, blue.}
	\label{fig:rainbowTrees}
\end{figure}
\end{proof}

\begin{remark}
\label{rem:functionalEquationFussCatalan}
Recall that the corresponding generating function~$F_\ell(z) \eqdef \sum_{m \ge 0} F_{\ell,m} \, z^m$ satisfies the functional equiation
\[
F_\ell(z) = 1 + z \, F_\ell(z)^\ell.
\]
\end{remark}

\begin{table}
	\centerline{\scalebox{.8}{
		\begin{tabular}[t]{c|ccccccccc}
			$m \backslash \ell$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ \\
			\hline
			$1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ \\
			$2$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ \\
			$3$ & $1$ & $5$ & $12$ & $22$ & $35$ & $51$ & $70$ & $92$ & $117$ \\
			$4$ & $1$ & $14$ & $55$ & $140$ & $285$ & $506$ & $819$ & $1240$ & $1785$ \\
			$5$ & $1$ & $42$ & $273$ & $969$ & $2530$ & $5481$ & $10472$ & $18278$ & $29799$ \\
			$6$ & $1$ & $132$ & $1428$ & $7084$ & $23751$ & $62832$ & $141778$ & $285384$ & $527085$ \\
			$7$ & $1$ & $429$ & $7752$ & $53820$ & $231880$ & $749398$ & $1997688$ & $4638348$ & $9706503$ \\
			$8$ & $1$ & $1430$ & $43263$ & $420732$ & $2330445$ & $9203634$ & $28989675$ & $77652024$ & $184138713$ \\
			$9$ & $1$ & $4862$ & $246675$ & $3362260$ & $23950355$ & $115607310$ & $430321633$ & $1329890705$ & $3573805950$
		\end{tabular}
	}}
%	\vspace{.3cm}
	\caption{The Fuss-Catalan numbers~$F_{\ell,m} = \frac{1}{(\ell-1)m+1} \binom{\ell m}{m}$ for~$\ell,m \in [9]$. See \OEIS{A062993}.}
\end{table}

\begin{definition}
For a rainbow forest~$F$, we define
\[
\omega(F) \eqdef \prod_{i \in [\ell]} \prod_{N \in F} \#C_i(N)! \, ,
\]
where~$N$ ranges over all nodes of~$F$ and~$C_i(N)$ denotes the children of~$N$ colored by~$i$.
\end{definition}

\begin{definition}
\label{def:labelingRainbowForest}
A \defn{labeling} of a $(\ell,n)$-rainbow forest~$F$ is a bijective map between from the nodes of~$F$ to~$[n]$ such that
\begin{enumerate}[(i)]
\item the label of each root is minimal in its tree,
\item the labels of siblings with the same color are increasing from left to right.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lem:labelingRainbowForest}
The number~$\lambda(F)$ of labelings of a $(\ell,n)$-rainbow forest~$F$ is given by
\[
\lambda(F) = \frac{n!}{\omega(F) \prod\limits_{T \in F} \|T\|} \, .
\]
\end{lemma}

\begin{proof}
Out of all~$n!$ bijective maps from the nodes of~$F$ to~$[n]$, only~$1/\prod_{T \in F} \|T\|$ satisfy Condition~(i) of \cref{def:labelingRainbowForest}, and only $1/\prod_{i \in [\ell]} \prod_{N \in F} \#C_i(N)! = 1/\omega(F)$ satisfy Condition~(ii) of \cref{def:labelingRainbowForest}.
\end{proof}

The following statement is illustrated in \cref{fig:forests}.

\begin{proposition}
\label{prop:bijectionForests}
There is a bijection from $(\ell,n)$-partition forests to labeled $(\ell,n)$-rainbow forests, such that if the partition forest~$\b{F}$ is sent to the labeled rainbow forest~$F$, then
\[
\dim(\b{F}) = \#F-1
\qquad\text{and}\qquad
\mu_{\forestPoset}(\HH, \b{F}) = (-1)^{n-\#F} \, \omega(F).
\]
\end{proposition}

\begin{proof}
From a labeled $(\ell,n)$-rainbow forest~$F$, we construct a $(\ell,n)$-partition forest~$\b{F} \eqdef (F_1, \dots, F_\ell)$ whose $i$\ordinal{} partition~$F_i$ has a part~$\{N\} \cup C_i(N)$ for each node~$N$ of~$F$ not colored~$i$.
Condition~(i) of \cref{def:rainbowForest} ensures that each $F_i$ is indeed a partition.

Conversely, start from a $(\ell,n)$-partition forest~$\b{F} \eqdef (F_1, \dots, F_i)$.
Consider the colored clique graph~$K_{\b{F}}$ on~$[n]$ obtained by replacing each part in~$F_i$ by a clique of edges colored by~$i$.
For each~$1 < j \le n$, there is a unique shortest path in~$K_{\b{F}}$ from the vertex~$j$ to the smallest vertex in the connected component of~$j$.
Define the parent~$p$ of~$j$ to be the next vertex along this path, and color the node~$j$ by the color of the edge between~$j$ and~$p$.
This defines a labeled $(\ell,n)$-rainbow forest~$F$.

Finally, observe that
\begin{gather*}
\dim(\b{F}) = n - 1 - \ell n + \sum_{i \in [\ell]} \#F_i = \#F-1, \qquad\text{and} \\
\mu_{\forestPoset}(\HH, \b{F}) = \prod\limits_{i \in [\ell]} \prod\limits_{p \in F_i} (-1)^{\#p-1} (\#p-1) = \prod\limits_{i \in [\ell]} \prod\limits_{N \in F} (-1)^{\#C_i(N)} \#C_i(N)! = (-1)^{n-\#F} \, \omega(F).
\qedhere
\end{gather*}
\end{proof}

We finally transport via this bijection the partial order of the flat lattice on rainbow forests.

\begin{proposition}
In the flat poset~$\flatPoset[\multiBraidArrangement]$ labeled by rainbow forests using~\cref{prop:flatPosetMultiBraidArrangement,prop:bijectionForests}, a rainbow forest~$F$ covers a rainbow forest~$G$ if and only $G$ can be obtained from $F$ by:
\begin{itemize}
\item choosing a color $c$,
\item choosing two vertices $a$ and $b$ not colored in $c$ in two connected components $A$ and $B$, with the convention that the root of $A$ is smaller than the root of $B$,
\item removing edges between $b$ and its children $C_b$ of color $c$ and recursively ``pushing'' the color of $b$ to its parent until the root of $B$ is colored: we get a forest whose roots are $C_b$ and $b$, colored in $c$,
\item grafting $b$ and all the nodes in $C_b$ on $a$.
\end{itemize}
\vincent{This is really difficult to follow. We can improve the presentation. Maybe add a picture. To discuss with B√©r√©nice.}
\end{proposition}

\begin{proof}
Let us first remark that the graph obtained by these operations is indeed a rainbow forest.
First, we add an edge between two distinct connected components, so that the result is indeed acyclic.
Moreover, the condition on the color of $a$ and on the deletion of edges between $b$ and vertices of color $c$ ensures that we do not add an edge between two vertices of the same color.
Note that the parent of $b$ inherits the color of $b$ which is not $c$.

Let us recall that the cover relations in the flat poset~$\flatPoset[\multiBraidArrangement]$ are given in terms of $(\ell,n)$-partition forests by choosing a partition $\pi$ of the partition tuple (which corresponds directly to choosing a color), choosing two parts $\pi_a$ and $\pi_b$ in the partition $\pi$, and merging them, without creating a loop in the intersection hypergraph.

By choosing two vertices in different connected components of the rainbow forest, we are sure that the intersection hypergraph obtained by adding an edge is still acyclic.

The last point that has to be explained is the link between the condition on the color of~$a$ and~$b$ and merging two parts in the same partition.
If one of the two nodes, say $a$ for instance is of color~$c$, then it belongs to the same part of $\pi$ as its parent $z$.
The merging is the same if we choose~$z$ which is not colored $c$.
Moreover, as $b$ is an other connected components, the corresponding two parts are distinct in $\pi$.
Finally, a part is just a corolla so the merging corresponds to building a corolla with $a$, $b$ and their children of color $c$.
\end{proof}

%%%%%%%%%%%%%%%

\subsection{Enumeration of vertices of $\multiBraidArrangement$}
\label{subsec:verticesMultiBraidArrangement}

We now use the labeled $(\ell,n)$-rainbow forests of \cref{subsec:rainbowForests} to derive more explicit formulas for the number of vertices of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.
The first few values are gathered in \cref{table:verticesMultiBraidArrangement}.
 
\begin{table}
	\centerline{\scalebox{.8}{
		\begin{tabular}[t]{c|cccccccc}
			$n \backslash \ell$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ \\ % & $9$ \\
			\hline
		$1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ \\ % & $1$ \\
		$2$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ \\ % & $9$ \\
		$3$ & $1$ & $8$ & $21$ & $40$ & $65$ & $96$ & $133$ & $176$ \\ % & $225$ \\
		$4$ & $1$ & $50$ & $243$ & $676$ & $1445$ & $2646$ & $4375$ & $6728$ \\ % & $9801$ \\
		$5$ & $1$ & $432$ & $3993$ & $16384$ & $46305$ & $105456$ & $208537$ & $373248$ \\ % & $620289$ \\
		$6$ & $1$ & $4802$ & $85683$ & $521284$ & $1953125$ & $5541126$ & $13119127$ & $27350408$ \\ % & $51883209$ \\
		$7$ & $1$ & $65536$ & $2278125$ & $20614528$ & $102555745$ & $362797056$ & $1029059101$ & $2500000000$ \\ % & $5415228513$ \\
		$8$ & $1$ & $1062882$ & $72412707$ & $976562500$ & $6457339845$ & $28500625446$ & $96889010407$ & $274371577992$ \\ % & $678770015625$ \\
%		$9$ & $1$ & $20000000$ & $2681615217$ & $53971714048$ & $474659385665$ & $2614905943296$ & $10657046640625$ & $35184372088832$ & $99426586671873$
		\end{tabular}
	}}
	\vspace{.3cm}
	\caption{The numbers $f_0(\multiBraidArrangement) = \ell \big( (\ell-1) n + 1 \big)^{n-2}$ of vertices of~$\multiBraidArrangement$ for~$\ell,n \in [8]$.}
	\label{table:verticesMultiBraidArrangement}
\end{table}

\begin{theorem}
\label{thm:verticesMultiBraidArrangement}
The number of vertices of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is
\[
f_0(\multiBraidArrangement) = \ell \big( (\ell-1) n + 1 \big)^{n-2}.
\]
\end{theorem}

\begin{proof}
By \cref{prop:flatPosetMultiBraidArrangement,prop:bijectionForests}, we just need to count the labeled $(\ell,n)$-rainbow trees.
A common reasoning for counting Cayley trees is the use of its Pr√ºfer code defined by recursively pruning the smallest leaf while writing down the label of its parent.
This bijection can be adapted to colored Cayley trees by writing down the label of the parent colored by the color of the pruned leaf.
This leads to a bijection with certain colored words of length $n-1$.
Namely, there are two possibilities:
\begin{itemize}
\item either the pruned leaf is attached to the node~$1$ and it can have all $\ell$ colors,
\item or it is attached to one of the $n-1$ other nodes and it can only have $\ell-1$ colors.
\end{itemize}
Note that the last letter in the Pr√ºfer code (obtained by removing the last edge) is necessarily the root $1$, with $\ell$ possible different colors.
Hence, there are 
\[
\big( \ell+(n-1)(\ell-1) \big)^{n-2} \ell = \ell \big( (\ell-1) n + 1 \big)^{n-2}
\]
such words.
Similar ideas were used in~\cite{Lewis}.
\end{proof}

\begin{theorem}
\label{thm:verticesRefinedMultiBraidArrangement}
For any~$k_1, \dots, k_\ell$ such that~$0 \le k_i \le n-1$ for~$i \in [\ell]$ and~${\sum_{i=1}^\ell k_i = n-1}$, the number of vertices~$v$ of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ such that the smallest flat of the $i$\ordinal{} copy of~$\braidArrangement$ containing~$v$ has dimension~$n-k_i-1$ is given by
\[
n^{\ell-1} \binom{n-1}{k_1, \dots, k_\ell} \prod_{i=1}^\ell (n-k_i)^{k_i-1}.
\]
\end{theorem}

\begin{proof}
By \cref{prop:flatPosetMultiBraidArrangement,prop:bijectionForests}, we just need to count the labeled $(\ell,n)$-rainbow trees with~$k_i$ nodes colored by~$i$.
Forgetting the labels, the $(\ell,n)$-rainbow trees with~$k_i$ nodes colored by~$i$ are precisely the spanning trees of the complete multipartite graph~$K_{k_1, \dots, k_\ell, 1}$ (where the last~$1$ stands for the uncolored root).
Using a Pr\"ufer code similar to that of the proof of \cref{thm:verticesMultiBraidArrangement}, R.~Lewis proved in~\cite{Lewis} that the latter are counted by~${n^{\ell-1} \prod_{i=1}^\ell (n-k_i)^{k_i-1}}$.
Finally, the possible labelings are counted by the multinomial coefficient~$\binom{n-1}{k_1, \dots, k_\ell}$.
\end{proof}

%%%%%%%%%%%%%%%

\subsection{Enumeration of regions and bounded regions of $\multiBraidArrangement$}
\label{subsec:regionsMultiBraidArrangement}

We finally use the labeled $(\ell,n)$-rainbow forests of \cref{subsec:rainbowForests} to derive more explicit formulas for the number of regions and bounded regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$.
The first few values are gathered in \cref{table:regionsMultiBraidArrangement,table:boundedRegionsMultiBraidArrangement}.
We first compute the characteristic polynomial of~$\multiBraidArrangement$.

\afterpage{
\begin{table}
	\centerline{\scalebox{.8}{
		\begin{tabular}[t]{c|cccccccc}
			$n \backslash \ell$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ \\ % & $9$ \\
			\hline
			$1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ \\ % & $1$ \\
			$2$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ \\ % & $10$ \\
			$3$ & $6$ & $17$ & $34$ & $57$ & $86$ & $121$ & $162$ & $209$ \\ % & $262$ \\
			$4$ & $24$ & $149$ & $472$ & $1089$ & $2096$ & $3589$ & $5664$ & $8417$ \\ % & $11944$ \\
			$5$ & $120$ & $1809$ & $9328$ & $29937$ & $73896$ & $154465$ & $287904$ & $493473$ \\ % & $793432$ \\
			$6$ & $720$ & $28399$ & $241888$ & $1085157$ & $3442816$ & $8795635$ & $19376064$ & $38323753$ \\ % & $69841072$ \\
			$7$ & $5040$ & $550297$ & $7806832$ & $49075065$ & $200320816$ & $625812385$ & $1629858672$ & $3720648337$ \\ % & $7686190000$ \\
			$8$ & $40320$ & $12732873$ & $302346112$ & $2666534049$ & $14010892416$ & $53536186825$ & $164859458688$ & $434390214657$ \\ % & $1017282905344$ \\
%			$9$ & $362880$ & $343231361$ & $13682809216$ & $169423639713$ & $1146173002496$ & $5357227099105$ & $19506923076096$ & $59328538244801$ & $157507267166848$
		\end{tabular}
	}}
%	\vspace{.3cm}
	\caption{The numbers $f_{n-1}(\multiBraidArrangement)$ of regions of~$\multiBraidArrangement$ for~$\ell,n \in [8]$.}
	\label{table:regionsMultiBraidArrangement}
\end{table}
}

\afterpage{
\begin{table}
	\centerline{\scalebox{.8}{
		\begin{tabular}[t]{c|cccccccc}
			$n \backslash \ell$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ \\ % & $9$ \\
			\hline
			$1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ & $1$ \\ % & $1$ \\
			$2$ & $0$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ \\ % & $8$ \\
			$3$ & $0$ & $5$ & $16$ & $33$ & $56$ & $85$ & $120$ & $161$ \\ % & $208$ \\
			$4$ & $0$ & $43$ & $224$ & $639$ & $1384$ & $2555$ & $4248$ & $6559$ \\ % & $9584$ \\
			$5$ & $0$ & $529$ & $4528$ & $17937$ & $49696$ & $111745$ & $219024$ & $389473$ \\ % & $644032$ \\
			$6$ & $0$ & $8501$ & $120272$ & $663363$ & $2354624$ & $6455225$ & $14926176$ & $30583847$ \\ % & $57255488$ \\
			$7$ & $0$ & $169021$ & $3968704$ & $30533409$ & $138995776$ & $464913325$ & $1268796096$ & $2996735329$ \\ % & $6353133184$ \\
			$8$ & $0$ & $4010455$ & $156745472$ & $1684352799$ & $9841053184$ & $40179437975$ & $129465630720$ & $352560518527$ \\ % & $846588258944$ \\
%			$9$ & $0$ & $110676833$ & $7216242688$ & $108413745057$ & $813420601856$ & $4055310777025$ & $15431698810368$ & $48461340225473$ & $131823966149632$
		\end{tabular}
	}}
%	\vspace{.3cm}
	\caption{The numbers $b_{n-1}(\multiBraidArrangement)$ of bounded regions of~$\multiBraidArrangement$ for~$\ell,n \in [8]$.}
	\label{table:boundedRegionsMultiBraidArrangement}
\end{table}
}

\begin{theorem}
\label{thm:characteristicPolynomialMultiBraidArrangement}
The characteristic polynomial~$\charPol[\multiBraidArrangement]$ of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ is given~by
\[
\charPol[\multiBraidArrangement] = \frac{(-1)^n n!}{y} \, [z^n] \, \exp \bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, y \, z^m}{m} \bigg) ,
\]
where~$\displaystyle F_{\ell,m} \eqdef \frac{1}{(\ell-1)m+1} \binom{\ell m}{m}$ is the Fuss-Catalan number.
\end{theorem}

\begin{proof}
By \cref{thm:MobiusPolynomialMultiBraidArrangement,prop:bijectionForests}, the characteristic polynomial~$\charPol[\multiBraidArrangement]$ is
\[
\charPol[\multiBraidArrangement] = \sum_{\b{F} \in \forestPoset} \mu_{\forestPoset}(\HH, \b{F}) \, y^{\dim(\b{F})} = \sum_{F \in \rainbowForests} \lambda(F) \, (-1)^{n-\#F} \, \omega(F) \, y^{\#F-1}.
\]
From \cref{lem:labelingRainbowForest}, we observe that
\[
\frac{\lambda(F) \, \omega(F) \, (-y)^{\#F} \, z^{\|F\|}}{\|F\|!} = \prod_{T \in F} \frac{-y \, z^{\|T\|}}{\|T\|} \, ,
\]
where $T$ ranges over the trees of~$F$.
Now using that rainbow forests are exactly sets of rainbow trees, we obtain that
\[
\sum_{F \in \rainbowForests[][\ell]} \frac{ \lambda(F) \, \omega(F) \, (-y)^{\#F} \, z^{\|F\|}}{\|F\|!} = \sum_{F \in \rainbowForests[][\ell]} \prod_{T \in F} \frac{-y \, z^{\|T\|}}{\|T\|} = \exp \bigg( \sum_{T \in \rainbowTrees[][\ell]} \frac{-y \, z^{\|T\|}}{\|T\|} \bigg).
\]
From \cref{lem:FussCatalan}, we obtain that
\[
\exp \bigg( \sum_{T \in \rainbowTrees[][\ell]} \frac{-y \, z^{\|T\|}}{\|T\|} \bigg) = \exp \bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, y \, z^m}{m} \bigg).
\]
We conclude that
\begin{align*}
\charPol[\multiBraidArrangement] 
& = \sum_{F \in \rainbowForests}  \lambda(F) \, (-1)^{n-\#F} \, \omega(F) \, y^{\#F-1} \\
& = \frac{(-1)^n \, n!}{y} [z^n] \sum_{F \in \rainbowForests[][\ell]} \frac{ \lambda(F) \, \omega(F) \, (-y)^{\#F} \, z^{\|F\|}}{\|F\|!} \\
& = \frac{(-1)^n n!}{y} \, [z^n] \, \exp \bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, y \, z^m}{m} \bigg).
\qedhere
\end{align*}
\end{proof}

From the characteristic polynomial of~$\multiBraidArrangement$ and \cref{rem:characteristicPolynomial}, we obtain its numbers of regions and bounded regions.

\begin{theorem}
\label{thm:regionsMultiBraidArrangement}
The numbers of regions and of bounded regions of the $(\ell,n)$-braid arrangement~$\multiBraidArrangement$ are given by
\begin{align*}
f_{n-1}(\multiBraidArrangement) 
& = n! \, [z^n] \exp \Bigg( \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m} \Bigg) \\
\text{and}\qquad
b_{n-1}(\multiBraidArrangement)
%& = - n! \, [z^n] \exp \Bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m} \Bigg) 
& = (n-1)! \, [z^{n-1}] \exp \bigg( (\ell-1) \sum_{m \ge 1} F_{\ell,m} \, z^m \bigg).
\end{align*}
where~$\displaystyle F_{\ell,m} \eqdef \frac{1}{(\ell-1)m+1} \binom{\ell m}{m}$ is the Fuss-Catalan number.
\end{theorem}

\begin{proof}
By \cref{rem:characteristicPolynomial}, we obtain from \cref{thm:characteristicPolynomialMultiBraidArrangement} that
\begin{align*}
f_{n-1}(\multiBraidArrangement) & = (-1)^{n-1} \charPol[\multiBraidArrangement][-1] = n! \, [z^n]  \, \exp \bigg( \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m} \bigg), \\
% \text{and}\qquad
b_{n-1}(\multiBraidArrangement) & = (-1)^{n-1} \charPol[\multiBraidArrangement][1] = - n! \, [z^n]  \, \exp \bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m} \bigg).
\end{align*}
To conclude, we thus just need to observe that
\(
U_\ell(z) = \frac{\partial}{\partial z} V_\ell(z)
\)
where
\[
U_\ell(z) \eqdef \exp \bigg( (\ell-1) \sum_{m \ge 1} F_{\ell,m} \, z^m \bigg)
\qquad\text{and}\qquad
V_\ell(z) \eqdef - \exp \bigg( - \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m} \bigg).
\]
For this, consider the generating functions
\[
F_\ell(z) \eqdef \sum_{m \ge 0} F_{\ell,m} \, z^m
\qquad\text{and}\qquad
G_\ell(z) \eqdef \sum_{m \ge 1} \frac{F_{\ell,m} \, z^m}{m}.
\]
Recall from \cref{rem:functionalEquationFussCatalan} that~$F_\ell(z)$ satisfies the functional equation
\[
F_\ell(z) = 1 + z \, F_\ell(z)^\ell.
\]
We thus obtain that
\[
F_\ell'(z) \big( 1 - \ell \, z \, F_\ell(z)^{\ell-1} \big) = F_\ell(z)^\ell
\quad\text{and}\quad
F_\ell(z) \big( 1 - \ell \, z \, F_\ell(z)^{\ell-1} \big) = 1 - (\ell-1) \, z \, F_\ell(z)^\ell.
\]
Combining these two equations, we get
\begin{equation}
\label{eq:diff}
F_\ell(z)^{\ell+1} = F_\ell'(z) \big( 1 - (\ell-1) \, z \, F_\ell(z)^\ell \big).
\end{equation}
Observe now that
\begin{equation}
\label{eq:GF}
z \, G_\ell'(z) = F_\ell(z) - 1 = z \, F_\ell(z)^\ell
\qquad\text{and}\qquad
G_\ell''(z) = \ell \, F_\ell(z)^{\ell-1} \, F_\ell'(z).
\end{equation}
Hence
\[
U_\ell(z) = \exp \big( (\ell-1) \, (F_\ell(z) - 1) \big) = \exp \big( (\ell-1) \, z \, G_\ell‚Äô(z) \big)
\]
and
\[
V_\ell'(z) = \frac{\partial}{\partial z}  - \exp \big( \! - G_\ell(z) \big) = G_\ell'(z) \exp \big( -G_\ell(z) \big).
\]
Consider now the function
\[
W_\ell(z) = V_\ell'(z) / U_\ell(z) = G_\ell'(z) \exp \big( \! - G_\ell(z) - (\ell-1) \, z \, G_\ell'(z) \big).
\]
Clearly, $W_\ell(0) = 1$.
Moreover, using~\eqref{eq:GF}, we obtain that its derivative is
\begin{align*}
W_\ell'(z)
& = \Big( G_\ell''(z) \big(1 - (\ell-1) \, z \, G_\ell'(z) \big) - \ell \, G_\ell'(z)^2 \Big) \exp \big( \! - G_\ell(z) - (\ell-1) \, z \, G_\ell'(z) \big) \\
& = \ell \, F_\ell(z)^{\ell-1} \Big( F_\ell'(z) \big( 1 - (\ell-1) \, z \, F_\ell(z)^\ell \big) - F_\ell(z)^{\ell+1} \Big) \exp \big( \! - G_\ell(z) - (\ell-1) \, z \, G_\ell'(z) \big),
\end{align*}
which vanishes by~\eqref{eq:diff}.
%\vincent{Can we make a bijective proof of the equality $U_\ell(z) = \frac{\partial}{\partial z} V_\ell(z)$?}
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Face poset and combinatorial description of~$\multiBraidArrangement(\b{a})$}
\label{sec:facePoset}

In this section, we describe the face poset of~$\multiBraidArrangement(\b{a})$ in terms of ordered $(\ell,n)$-partition forests.
This section highly depends on the choice of the translation matrix~$\b{a}$.

%%%%%%%%%%%%%%%

\subsection{Ordered partition forests}
\label{subsec:orderedPartitionForests}

We now introduce the combinatorial objects that will be used to encode the faces of the $\b{a}$-braid arrangement~$\multiBraidArrangement(\b{a})$.

\begin{definition}
\label{def:orderedPartitionForest}
An \defn{ordered $(\ell,n)$-partition forest} (\resp \defn{tree}) is an $\ell$-tuple~$\orient{\b{F}} \eqdef (\orient{F_1}, \dots, \orient{F_\ell})$ of ordered set partitions of~$[n]$ such that the corresponding $\ell$-tuple~$\b{F} \eqdef (F_1, \dots, F_\ell)$ of unordered set partitions of~$[n]$ forms a $(\ell,n)$-partition forest (\resp tree)
The \defn{ordered $(\ell,n)$-partition forest poset} is the poset~$\orientedForestPoset$ on ordered $(\ell,n)$-partition forests ordered by componentwise refinement.
In other words, $\orientedForestPoset$ is the subposet of the $\ell$\ordinal{} Cartesian power of the ordered partition poset~$\orientedPartitionPoset$ induced by ordered $(\ell,n)$-partition forests.
Note that the maximal elements of~$\orientedForestPoset$ are the ordered $(\ell, n)$-partition trees.
\end{definition}

The following statement is the analogue of \cref{prop:flatPosetMultiBraidArrangement}, and is illustrated in \cref{fig:B23a,fig:B23b}.

\begin{proposition}
\label{prop:facePosetMultiBraidArrangement}
The face poset~$\facePoset[\multiBraidArrangement(\b{a})]$ of the $\b{a}$-braid arrangement~$\multiBraidArrangement(\b{a})$ is isomorphic to an upper set~$\orientedForestPoset(\b{a})$ of the ordered $(\ell,n)$-partition forest poset~$\orientedForestPoset$.
\end{proposition}

\begin{proof}
The proof is based on that of \cref{prop:flatPosetMultiBraidArrangement}.
A face of~$\multiBraidArrangement(\b{a})$ is an intersection of faces of the $\ell$ copies of~$\multiBraidArrangement$, hence corresponds to an $\ell$-tuple of ordered partitions of~$[n]$.
Moreover, the flats supporting these faces intersect, so that the corresponding unordered partitions must form an $(\ell,n)$-partition forest.
Hence, each face of~$\multiBraidArrangement(\b{a})$ corresponds to a certain ordered $(\ell,n)$-partition forest.
Moreover, the inclusion of faces of~$\multiBraidArrangement(\b{a})$ translates to the componentwise refinement on ordered partitions.
Finally, by genericity, it is immediate that we obtain an upper set of this componentwise refinement order.
\end{proof}

\begin{figure}
	\centerline{\includegraphics[scale=.9]{B23a}}
	\caption{Labelings of the faces of the arrangement~$\multiBraidArrangement[3][2](\b{a})$ for~$\b{a} = \begin{bmatrix} 0 & 0 \\ -1 & -1 \end{bmatrix}$.}
	\label{fig:B23a}
\end{figure}

\begin{figure}
	\centerline{\includegraphics[scale=.9]{B23b}}
	\caption{Labelings of the faces of the arrangement~$\multiBraidArrangement[3][2](\b{a})$ for~$\b{a} = \begin{bmatrix} 0 & 0 \\ 1 & -2 \end{bmatrix}$.}
	\label{fig:B23b}
\end{figure}

We now fix a generic translation matrix~$\b{a} \eqdef (a_{i,j})$ and still denote by~$A_{i,s,t} \eqdef \smash{\sum_{s \le j < t} a_{i,j}}$ for all~$1 \le s < t \le n$ and~$i \in [\ell]$ (and often write~$A_{i,t,s}$ for~$-A_{i,s,t}$).
The objective of this section is to describe
\begin{itemize}
\item the ordered $(\ell,n)$-partitions forests of the upper set~$\orientedForestPoset(\b{a})$ with a given underlying (unordered) $(\ell,n)$-partition forest (\cref{subsec:PFtoOPF}),
\item a criterion to decide whether a given ordered $(\ell,n)$-partition forest belongs to the upper set~$\orientedForestPoset(\b{a})$, \ie corresponds to a face of~$\multiBraidArrangement(\b{a})$ (\cref{subsec:criterionOPF}).
\end{itemize}

%%%%%%%%%%%%%%%

\subsection{From partition forests to ordered partition forests}
\label{subsec:PFtoOPF}

In this section, we describe the ordered $(\ell,n)$-partitions forests~$\orient{\b{F}}$ of the upper set~$\orientedForestPoset(\b{a})$ with a given underlying $(\ell,n)$-partition forest~$\b{F}$.
We denote by~$cc(\b{F})$ the connected components of~$\b{F}$, meaning the partition of~$[n]$ given by the hyperedge labels of the connected components of the intersection hypergraph of~$\b{F}$.
We first observe that the choice of~$\b{a}$ fixes the order of the parts in a common connected component of~$\b{F}$.

\begin{proposition}
\label{prop:PFtoOPF1}
Consider an $(\ell,n)$-partition forest~$\b{F} \eqdef (F_1, \dots, F_\ell)$, and two integers~$s,t \in [n]$ labeling two hyperedges in the same connected component of the intersection hypergraph of~$\b{F}$.
Assume that the unique path from~$s$ to~$t$ in the hypergraph of~$\b{F}$ passes through the hyperedges labeled by~$s = r_0, \dots, r_q = t$ and through parts of the partitions~$F_{i_1}, \dots, F_{i_q}$.
Then for any ordered $(\ell,n)$-partition forest~$\orient{\b{F}} \eqdef (\orient{F_1}, \dots, \orient{F_\ell})$ of the upper set~$\orientedForestPoset(\b{a})$ with underlying $(\ell,n)$-partition forest~$\b{F}$ and any~$i \in [\ell]$, the order of~$s$ and~$t$ in~$\orient{F}_i$ is given by the sign of~$A_{i,s,t} - \sum_{p \in [q]} A_{i_p, r_{p-1}, r_p}$.
\end{proposition}

\begin{proof}
Consider any point~$\b{x}$ in the face of~$\multiBraidArrangement(\b{a})$ corresponding to~$\orient{\b{F}}$.
Along the path from~$s$ to~$t$, we have~$x_{r_{p-1}} - x_{r_p} = A_{i_p, r_{p-1}, r_p}$ for each~$p \in [q]$.
Hence, we obtain that
\[
x_s - x_t = \sum_{p \in [q]}  (x_{r_{p-1}} - x_{r_p}) = \sum_{p \in [q]} A_{i_p, r_{p-1}, r_p}.
\]
The order of~$s,t$ in~$\orient{F}_i$ is given by the sign of~$A_{i,s,t} - (x_s - x_t)$, hence of~$A_{i,s,t} - \sum_{p \in [q]} A_{i_p, r_{p-1}, r_p}$.
\end{proof}

We now describe the different ways to order the parts in distinct connected components of~$\b{F}$.
For this, we need the following posets.

\begin{definition}
Consider an $(\ell,n)$-partition forest~$\b{F}$ and denote by~$cc(\b{F})$ the connected components of~$\b{F}$.
For each pair~$s,t \in [n]$ in distinct connected components of~$cc(\b{F})$, we define the chain~$<_{s,t}$ on the $\ell$ triples~$(i,s,t)$ for~$i \in [\ell]$ given by the order of the values~$A_{i,s,t}$.
The \defn{inversion poset}~$\Inv(\b{F}, \b{a})$ is then the poset obtained by quotienting the disjoint union of the chains~$<_{s,t}$ (for all~$s,t \in [n]$ in distinct connected components of~$cc(\b{F})$) by the equivalence relation~$(i,s,t) \equiv (i,s',t')$ if~$s$ and~$s'$ belong to the same part of~$F_i$ and~$t$ and~$t'$ belong to the same part of~$F_i$.
%Note that the map~$\phi: (i,s,t) \to (i,t,s)$ is an anti-isomorphism of the poset~$\Inv(\b{F}, \b{a})$.
We say that a subset~$X$ of~$\Inv(\b{F}, \b{a})$ is antisymmetric if~$(i,s,t) \in X \iff (i,t,s) \notin X$.
\end{definition}

\begin{proposition}
\label{prop:PFtoOPF2}
The ordered $(\ell,n)$-partition forests of the upper set~$\orientedForestPoset(\b{a})$ with a given underlying $(\ell,n)$-partition forest~$\b{F}$ are in bijection with the antisymmetric lower sets of the inversion poset~$\Inv(\b{F}, \b{a})$.
\end{proposition}

\begin{proof}
Consider an ordered $(\ell,n)$-partition forest~$\orient{\b{F}}$ of the upper set~$\orientedForestPoset(\b{a})$.
Let~$\b{x}$ be any point of the face of~$\multiBraidArrangement(\b{a})$ corresponding to~$\orient{\b{F}}$.
For each pair~$s,t \in [n]$ in distinct connected components of~$cc(\b{F})$, let~$I_{s,t}(\orient{\b{F}})$ be the set of indices~$i \in [\ell]$ such that~$x_s - x_t < A_{i,s,t}$.
Note that~$I_{s,t}$ is by definition a lower set of the chain~$<_{s,t}$ of~$\Inv(\b{F}, \b{a})$.
Hence, $I(\orient{F}) \eqdef \bigcup_{s,t} I_{s,t} / {\equiv}$ is a lower set of~$\Inv(\b{F}, \b{a})$.
Moreover, it is clearly antisymmetric since
\[
(i,s,t) \in I(\orient{F}) \iff x_s - x_t < A_{i,s,t} \iff x_t - x_s > A_{i,t,s} \iff (i,t,s) \notin I(\orient{F}).
\]

Conversely, given an antisymmetric lower set~$I$ of~$\Inv(\b{F}, \b{a})$, we can reconstruct an ordered $(\ell,n)$-partition forest~$\orient{\b{F}}$ by ordering each pair~$s,t \in [n]$ in~$\orient{F}_i$ 
\begin{itemize}
\item according to \cref{prop:PFtoOPF1} (hence independently of~$I$) if $s$ and~$t$ belong to the same connected component of~$\b{F}$,
\item according to~$I$ if~$s$ and~$t$ belong to distinct connected components of~$\b{F}$. Namely, we place the block of~$\orient{F}_i$ containing~$s$ before the block of~$\orient{F}_i$ containing~$t$ if and only if~$(i,s,t) \in I$.
\end{itemize}
It is then straightforward to check that the resulting ordered $(\ell,n)$-partition forest belongs to the upper set~$\orientedForestPoset(\b{a})$, by exhibiting a point~$\b{x}$ in of the corresponding face of~$\multiBraidArrangement(\b{a})$.
\end{proof}

%%%%%%%%%%%%%%%

\subsection{A criterion for ordered partition forests}
\label{subsec:criterionOPF}

We now consider a given ordered $(\ell,n)$-partition forest~$\orient{F}$ and provide a criterion to decide if it belongs to the upper set~$\orientedForestPoset(\b{a})$ corresponding to the faces of~$\multiBraidArrangement(\b{a})$.
For this, we need the following directed graph associated to~$\orient{\b{F}}$.

\begin{definition}
For an ordered partition~$\orient{\pi} \eqdef \orient{\pi}_1 | \dots | \orient{\pi}_k$ of~$[n]$, we denote by~$D_{\orient{\pi}}$ the directed graph on~$[n]$ with an arc~$\max(\orient{\pi}_j) \to \min(\orient{\pi}_{j+1})$ for each~$j \in [k-1]$ and a cycle~${x_1 \to \dots \to x_p \to x_1}$ for each part~$\orient{\pi}_j = \{x_1 < \dots < x_p\}$.
Note that~$D_{\orient{\pi}}$ has~$n$ vertices and~$n + k$ arcs.
For an ordered $(\ell,n)$-partition forest~$\orient{\b{F}} \eqdef (\orient{F_1}, \dots, \orient{F_\ell})$, we denote by~$D_{\orient{\b{F}}}$ the superposition of the directed graphs~$D_{\orient{F}_i}$ for~$i \in [\ell]$, where the arcs of~$D_{\orient{F}_i}$ are labeled by~$i$.
\end{definition}

\begin{proposition}
\label{prop:characterizationOPFs}
An ordered $(\ell,n)$-partition forest~$\orient{\b{F}}$ belongs to the upper set~$\orientedForestPoset(\b{a})$ if and only if $\sum_{\alpha \in \gamma} A_{i(\alpha), s(\alpha), t(\alpha)} \ge 0$ for any (simple) oriented cycle~$\gamma$ in~$D_{\orient{\b{F}}}$, where each arc~$\alpha \in \gamma$ has label~$i(\alpha)$, source~$s(\alpha)$, and target~$t(\alpha)$.
\end{proposition}

\begin{proof}
Consider an ordered $(\ell,n)$-partition forest~$\orient{\b{F}} \eqdef (\orient{F}_1, \dots, \orient{F}_\ell)$.
For each~$i \in [\ell]$, denote by
\begin{itemize}
\item $m_i$ the number of arcs of~$D_{\orient{F}_i}$
\item $M_i$ the incidence matrix of~$D_{\orient{F}_i}$, with $m_i$ rows and $n$ columns, with a row for each arc~$\alpha$ of~$D_{\orient{F}_i}$ containing a $-1$ in column~$s(\alpha)$, a $1$ in column~$t(\alpha)$, and $0$ elsewhere,
\item $\b{z}_i$ the column vector in~$\R^{m_i}$ with a row for each arc~$\alpha$ of~$D_{\orient{F}_i}$ containing the value~$A_{i(\alpha), s(\alpha), t(\alpha)}$.
\end{itemize}
Then a point~$\b{x} \in \R^n$ belongs to the face of the $i$\ordinal braid arrangement corresponding to~$\orient{F}_i$ if and only if it satisfies~$M_i \, \b{x} \le \b{z}_i$.
Hence, $\orient{\b{F}}$ appears as a face of the $\b{a}$-braid arrangement if and only if there exists~$\b{x} \in \R^n$ such that~$M \, \b{x} \le \b{z}$, where~$M$ is the $(m \times n)$-matrix (where~$m \eqdef \sum_{i \in [\ell]} m_i$), obtained by piling the matrices~$M_i$ for~$i \in [\ell]$ and similarly, $\b{z}$ is the column vector obtained by piling the vectors~$\b{z}_i$.
A direct application of the Farkas lemma (see \eg \cite[Prop.~1.7]{Ziegler}), there exists~$\b{x} \in \R^n$ such that~$M \, \b{x} \le \b{z}$ if and only if~$\b{c} \b{z} \ge 0$ for any~$\b{c} \in (\R^m)^*$ with~$\b{c} \ge \b{0}$ and~$\b{c} M = \b{0}$.
Now it is classical that the left kernel of the incidence matrix of a directed graph is generated by its circuits (non-necessarily oriented cycles), and that the positive cone in this left kernel is generated by its oriented cycles.
\end{proof}

\begin{remark}
Note that we made some arbitrary choices here by choosing the arc from~$\max(\orient{\pi}_j)$ to~$\min(\orient{\pi}_{j+1})$ between two consecutive parts~$\orient{\pi}_j$ and~$\orient{\pi}_{j+1}$ and a cycle inside each part~$\orient{\pi}_j$ (while we said that the order in each part is irrelevant).
We could instead have considered all arcs connecting two elements of two consecutive parts, or two elements inside the same part.
Our choices just limit the amount of oriented cycles in~$D_{\orient{\pi}}$.
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearpage
\part{Diagonals of permutahedra}
\label{part:diagonalsPermutahedra}

This second part is devoted to the study of the combinatorics of the diagonals of the permutahedra.
In \cref{sec:cellularDiagonals}, we first recall the definition and some know facts about diagonals of polytopes (\cref{subsec:cellularDiagonalsPolytopes}), which we immediately specialize to the classical permutahedron (\cref{sec:cellularDiagonalsPermutahedra}), and connect to \cref{part:multiBraidArrangements} to derive enumerative statements on the diagonals of permutahedra (\cref{subsec:enumerationDiagonalPermutahedra}).
In \cref{sec:operadicDiagonals}, we consider two particular diagonals, the $\LA$ and $\SU$ diagonals (\cref{subsec:LASUdiagonal}), show that these are the only two operadic diagonals which induce the weak order (\cref{subsec:operadicProperty}), and that they are isomorphic (\cref{subsec:isos-LA-SU}). 
Using results from \cref{sec:cellularDiagonals}, we then characterize their facets in terms of paths in $(2,n)$-partition trees (\cref{subsec:facets-operadic-diags}), and their vertices as pattern-avoiding pairs of permutations (\cref{subsec:vertices-operadic-diags}).

\vincent{To complete}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Cellular diagonals}
\label{sec:cellularDiagonals}

%%%%%%%%%%%%%%%

\subsection{Cellular diagonals for polytopes}
\label{subsec:cellularDiagonalsPolytopes}
 
Cellular approximations of the thin diagonal for families of polytopes are of fundamental importance in algebraic topology and geometry.
They allow one to define the cup product and thus define the ring structure on the cohomology groups of a topological space, and combinatorially on the Chow groups of a toric variety. 
We now proceed to define thin, cellular, and geometric diagonals.

\begin{definition} 
\label{def:thinDiagonal}
The \defn{thin diagonal} of a set $X$ is the map~$\delta : X \to X \times X$ defined by $\delta(x) \eqdef (x,x)$ for all $x \in X$.s
See \cref{fig:examplesDiagonals1}\,(left).
\end{definition}

\begin{definition} 
\label{def:cellularDiagonal}
A \defn{cellular diagonal} of a $d$-dimensional polytope $P$ is a continuous map ${\Delta : P \to P \times P}$ such that
\begin{enumerate}
\item its image is a union of $d$-dimensional faces of $P\times P$ (\ie it is \defn{cellular}),
\item it agrees with the thin diagonal of~$P$ on the vertices of $P$, and
\item it is homotopic to the thin diagonal of~$P$, relative to the image of the vertices of~$P$. 
\end{enumerate}
See \cref{fig:examplesDiagonals1}\,(middle left).
A cellular diagonal is said to be \defn{face-coherent} if its restriction to a face of $P$ is itself a cellular diagonal for that face. 
\end{definition}

A powerful geometric technique to define face-coherent cellular diagonals on polytopes first appeared in \cite{FultonSturmfels}, was presented in \cite{MasudaThomasTonksVallette}, and was fully developed in \cite{LaplanteAnfossi}.
We provide in \cref{thm:diagonal} the precise (but slightly technical) definition of these diagonals, even though we will only use the characterization of the faces in their image provided in \cref{thm:universalFormula}.

The key idea is that any vector $\b{v}$ in generic position with respect to $P$ defines a cellular diagonal of $P$.
For $\b{z}$ a point of $P$, let us denote by $\rho_{\b{z}} P \eqdef 2\b{z}-P$ denotes the reflection of $P$ with respect to the point~$\b{z}$.

\begin{definition}
	The \defn{fundamental hyperplane arrangement}~$\mathcal{H}_P$ of a polytope~$P \subset \R^d$ is the set of all linear hyperplanes of~$\R^d$ orthogonal to the edges of $P\cap \rho_{\b{z}} P$ for all $\b{z} \in P$. 
	See \cref{fig:examplesHyperplanes}.
\end{definition}

\begin{figure}[p]
	\centerline{
		\includegraphics[scale=.3]{HypSimplex.png}
		\includegraphics[scale=.35]{HypCube.png} \ \
		\includegraphics[scale=.3]{HypPermuto.png}
	}
	\caption{The fundamental hyperplane arrangements of the $3$-dimensional simplex, cube, and permutahedron. In blue are pictured the hyperplanes which are not perpendicular to actual edges of the polytope $P$, but only to edges of some intersection $P\cap \rho_z P$. Left and rightmost illustrations from~\cite[Fig.~12]{LaplanteAnfossi}.}
	\label{fig:examplesHyperplanes}
\end{figure}

A vector is \defn{generic with respect to~$P$} if it does not belong to the union of the hyperplanes of the fundamental hyperplane arrangement~$\mathcal{H}_P$.
In particular, such a vector is not perpendicular to any edge of $P$, and we denote by~$\min_{\b{v}}(P)$ (\resp $\max_{\b{v}}(P)$) the unique vertex of~$P$ which minimizes (\resp maximizes) the scalar product with~$\b{v}$. 

\begin{theorem}
\label{thm:diagonal}
For any vector $\b{v} \in \R^d$ in generic position with respect to $P$, the tight coherent section~$\triangle_{(P,\b{v})}$ of the projection $P \times P \to P, (\b{x}, \b{y}) \mapsto (\b{x}+\b{y})/2$ selected by the vector~$(-\b{v}, \b{v})$ defines a cellular diagonal of~$P$.
More precisely, $\triangle_{(P,\b{v})}$ is given by the explicit formula
\begin{align*}
	\begin{array}{rlcl}
		\triangle_{(P,\b{v})}\ : & P & \to & P\times P \\
		& \b{z} & \mapsto & \bigl( \min_{\b{v}}(P\cap \rho_{\b{z}} P), \, \max_{\b{v}}(P\cap \rho_{\b{z}} P) \bigr) .
	\end{array}
\end{align*}
\end{theorem}

\begin{definition}
\label{def:geometricDiagonal}
A \defn{geometric diagonal} of a polytope~$P$ is a diagonal of the form~$\triangle_{(P,\b{v})}$ for some vector~$\b{v} \in \R^d$ in generic position with respect to~$P$.
\end{definition}

A geometric diagonal~$\triangle_{(P,\b{v})}$ only depends on the region of~$\mathcal{H}_P$ containing~$\b{v}$, see~\cite[Prop.~1.23]{LaplanteAnfossi}.

\begin{figure}[p]
	\centerline{\scalebox{1.25}{
	\begin{tabular}{c@{\hspace{-.2cm}}c@{\hspace{-.2cm}}c@{\hspace{-.2cm}}c}
		\includegraphics[scale=1.2]{diagonalSegment1} &
		\includegraphics[scale=1.2]{diagonalSegment2} &
		\raisebox{-.2cm}{\includegraphics[scale=1]{diagonalSegment3}} &
		\raisebox{-.2cm}{\includegraphics[scale=1]{diagonalSegment4}}
		\\
		\includegraphics[scale=.9]{diagonalTriangle1} &
		\includegraphics[scale=.9]{diagonalTriangle2} &
		\includegraphics[scale=.6]{diagonalTriangle3} &
		\includegraphics[scale=.6]{diagonalTriangle4}	
		\\
		\includegraphics[scale=.9]{diagonalSquarre1} &
		\includegraphics[scale=.9]{diagonalSquarre2} &
		\includegraphics[scale=.6]{diagonalSquarre3} &
		\includegraphics[scale=.6]{diagonalSquarre4}
	\end{tabular}
	}}
	\caption{The diagonals of the segment (top), the triangle (middle) and the squarre (bottom). For each of them, we have represented the thin diagonal of~$P$ (left, in blue) and the cellular diagonal of~$P$ (middle left, in red) both in~$P \times P$, and the polytopal subdivision of~$P$ (middle right) and the common refinement of the two copies of the normal fan of~$P$ (right) both in~$P$.}
	\label{fig:examplesDiagonals1}
\end{figure}

%\begin{figure}[h!]
%	\includegraphics[scale=.9]{diagonalTriangle3}
%	\quad
%	\includegraphics[scale=.9]{diagonalTriangle4}
%	\quad
%	\includegraphics[scale=.9]{diagonalSquarre3}
%	\includegraphics[scale=.9]{diagonalSquarre4}
%	\caption{The thin (in blue) and cellular (in red) diagonals of the triangle and the square.}
%	\label{fig:examplesDiagonals1}
%\end{figure}

\begin{figure}
	\centerline{
		\includegraphics[scale=.3]{diagonalSimplexGuillaume.png}
		\includegraphics[scale=.35]{diagonalCubeGuillaume.png}
		\includegraphics[scale=.3]{diagonalPermutahedronGuillaume.png}
	}
	\caption{The subdivisions induced by cellular diagonals of the $3$-dimensional simplex (left), cube (middle), and permutahedron (right). Right illustration from~\cite[Fig.~13]{LaplanteAnfossi}.}
	\label{fig:examplesDiagonals2}
\end{figure}

Now the following \defn{universal formula}~\cite[Thm.~1.26]{LaplanteAnfossi} expresses combinatorially the faces in the image of the geometric diagonal~$\triangle_{(P,\b{v})}$.
Recall that the \defn{normal cone} of a face~$F$ of a polytope~$P$ in~$\R^d$ is the cone of directions~$\b{c} \in \R^d$ such that the maximum of the scalar product~$\dotprod{\b{c}}{\b{x}}$ over~$P$ is attained for some~$\b{x}$ in~$F$.

\begin{theorem}[{\cite[Thm.~1.26]{LaplanteAnfossi}}]
\label{thm:universalFormula}
Fix a vector $\b{v} \in \R^d$ in generic position with respect to $P$.
For each hyperplane~$H$ of the fundamental hyperplane arrangement~$\mathcal{H}_P$, denote by~$H^{\b{v}}$ the open half space defined by~$H$ and containing~$\b{v}$.
The faces of~$P \times P$ in the image of the geometric diagonal~$\triangle_{(P,\b{v})}$ are the faces~$F \times G$ where~$F$ and~$G$ are faces of~$P$ such that either the normal cone of~$F$ intersects~$H^{-\b{v}}$ or the normal cone of~$G$ intersects~$H^{\b{v}}$, for each~$H \in \mathcal{H}_P$.
\end{theorem}

The image of $\triangle_{(P,\b{v})}$ is a union of pairs of faces $F \times G$ of the Cartesian product~$P \times P$.
By drawing the polytopes~${(F+G)/2}$ for all pairs of faces $(F,G) \in \Ima \triangle_{(P,\b{v})}$, we can visualize~$\triangle_{(P,\b{v})}$ as a polytopal subdivision of $P$.
See \cref{fig:examplesDiagonals1}\,(middle right) and \cref{fig:examplesDiagonals2}.

It turns out that the dual of this complex is just the common refinement of two translated copies of the normal fan of~$P$.
See \cref{fig:examplesDiagonals1}\,(right).
Recall that the \defn{normal fan} of~$P$ is the fan formed by the normal cones of all faces of~$P$.
We thus obtain the following statement.

\begin{proposition}[{\cite[Coro.~1.4]{LaplanteAnfossi}}]
\label{prop:diagonalCommonRefinement}
The inclusion poset on the faces in the image of the diagonal~$\triangle_{(P,\b{v})}$ is isomorphic to the reverse inclusion poset of the faces of the common refinement of two copies of the normal fan of~$P$, translated from each other by the vector~$\b{v}$. 
\end{proposition}

Finally, the following statement relates the image of the diagonal~$\triangle_{(P, \b{v})}$ to the intervals of the poset obtained by orienting the skeleton of~$P$ in direction~$\b{v}$.

\begin{proposition}[{\cite[Prop. 1.17]{LaplanteAnfossi}}]
\label{prop:magicalFormula}
For any polytope $P$ and any generic vector $\b{v}$,
\begin{equation}
\label{eq:magique}
\Ima\triangle_{(P, \b{v})} \quad \subseteq \bigcup_{\substack{F,G \text{ faces of } P \\ \max_{\b{v}}(F) \, \le \, \min_{\b{v}}(G)}} F \times G .
\end{equation}
\end{proposition}

\begin{remark}
For some polytopes such as the simplices \cite{EilenbergMacLane}, the cubes \cite{Serre}, the freehedra \cite{Saneblidze-freeLoopFibration}, and the associahedra \cite{MasudaThomasTonksVallette}, the reverse inclusion also holds (in the case of the simplices and the cubes, the diagonals are know as \emph{Alexander--Whitney} and \emph{Serre} maps).
According to \cite{MasudaThomasTonksVallette}, the resulting equality enhancing~(\ref{eq:magique}) was called \defn{magical formula} by J.-L. Loday.
Polytopes of greater complexity such as the multiplihedra \cite{LaplanteAnfossiMazuir} or the operahedra \cite{LaplanteAnfossi}, which include the permutahedra, do not possess this exceptional property. 
\end{remark}

\begin{remark}
This is in fact precisely the content of the \emph{Fulton--Sturmfels formula} for the intersection product on toric varieties \cite[Thm.~4.2]{FultonSturmfels}, where the definition of cellular diagonals as tight coherent sections first appeared.
\end{remark}

To conclude, we define the opposite of a geometric diagonal.

\begin{definition}
The \defn{opposite} of a geometric diagonal~$\triangle \eqdef \triangle_{(P, \b{v})}$ is the geometric diagonal~$\triangle^{\op} \eqdef \triangle_{(P, -\b{v})}$.
Note that~$F \times G \in \Ima \triangle$ if and only if~$G \times F \in \Ima \triangle^{\op}$.
\end{definition}

%%%%%%%%%%%%%%%

\subsection{Cellular diagonals for the permutahedra}
\label{sec:cellularDiagonalsPermutahedra}

We now specialize the statements of \cref{subsec:cellularDiagonalsPolytopes} to the standard permutahedron.
We first recall its definition.

\begin{definition}
\label{def:permutahedron}
The \defn{permutahedron}~$\Perm$ is the polytope defined equivalently as
\begin{itemize}
\item the convex hull of the points~$\sum_{i \in [n]} i \, \b{e}_{\sigma(i)}$ for all permutations~$\sigma$ of~$[n]$, see \cite{Schoute},
\item the intersection of the hyperplane~$\smash{\bigset{\b{x} \in \R^n}{\sum_{i \in I} x_i = \binom{n+1}{2}}}$ with the affine halfspaces $\smash{\bigset{\b{x} \in \R^n}{\sum_{i \in I} x_i \ge \binom{|I|+1}{2}}}$ for all~${\varnothing \ne I \subsetneq [n]}$, see \cite{Rado}.
\end{itemize}
The normal fan of the permutahedron~$\Perm$ is the fan defined by the braid arrangement~$\braidArrangement$.
In particular, the faces of~$\Perm$ correspond to the ordered partitions of~$[n]$.
Moreover, when oriented in a generic direction, the skeleton of the permutahedron~$\Perm$ is isomorphic to the Hasse diagram of the classical weak order on permutations of~$[n]$.
% when oriented in the direction~${\b{\omega} \eqdef (n,\dots,1) - (1,\dots,n) = \sum_{i \in [n]} (n+1-2i) \, \b{e}_i}$
See \cref{fig:permutahedron}.
%
\begin{figure}
	\centerline{
		\includegraphics[scale=.8]{permutahedronWeakOrder}
		\qquad
		\includegraphics[scale=.7]{weakOrder}
	}
	\caption{The permutahedron~$\Perm[4]$ (left) and the weak order on permutations of~$[4]$ (right).}
	\label{fig:permutahedron}
\end{figure}
\end{definition}

The fundamental hyperplane arrangement of the permutahedron~$\Perm$ was described in~\cite[Sect.~3.1]{LaplanteAnfossi}.
As we will use the following set throughout the paper, we embed it in a definition.

\begin{definition}
\label{def:Un}
For~$n \in \N$, we define
\[
\Un(n) \eqdef \{ \{I,J\} \ | \ I,J \subset [n] \text{ with } |I|=|J| \text{ and } I \cap J = \varnothing\}.
\]
An \defn{ordering} of~$\Un(n)$ is a set containing exactly one of the two ordered pairs $(I,J)$ or $(J,I)$ for each $\{I,J\} \in \Un(n)$.
\end{definition}

\begin{proposition}[{\cite[Sect.~3.1]{LaplanteAnfossi}}]
The fundamental hyperplane arrangement of the permutahedron~$\Perm$ is given by the hyperplanes~$\bigset{\b{x} \in \R^n}{\sum\limits_{i \in I} x_i = \sum\limits_{j \in J} x_j}$ for all~$\{I,J\} \in \Un(n)$.
\end{proposition}

For a vector~$\b{v}$ generic with respect to~$\Perm$, we denote by~$\Or(\b{v})$ the ordering of~$\Un(n)$ such that~$\sum_{i \in I} v_i > \sum_{j \in J} v_j$ for all~$(I,J) \in \Or(\b{v})$.
Applying \cref{thm:universalFormula}, we next describe the faces in the image of the geometric diagonal~$\triangle_{(\Perm, \b{v})}$.
For this, the following definition will be convenient.

\begin{definition}
	\label{def:domination}
For $I,J \subseteq [n]$ and an ordered partition $\sigma$ of~$[n]$ into $k$ blocks, we say that $I$~\defn{dominates} $J$ in~$\sigma$ if for all $\ell \in [k]$, the first~$\ell$ blocks of~$\sigma$ contain more elements of~$I$ than of~$J$, or the same number of elements.
\end{definition}

\begin{theorem}[{\cite[Thm.~3.16]{LaplanteAnfossi}}]
\label{thm:IJ-description}
A pair~$(\sigma, \tau)$ of ordered partitions of~$[n]$ corresponds to a face in the image of the geometric diagonal~$\triangle_{(\Perm, \b{v})}$ if and only if, for all~$(I,J) \in \Or(\b{v})$, $J$ does not dominate~$I$ in~$\sigma$ or $I$ does not dominate~$J$ in~$\tau$.
\end{theorem}

As the normal fan of the permutahedron~$\Perm$ is the fan defined by the braid arrangement~$\braidArrangement$, we obtain by \cref{prop:diagonalCommonRefinement} the following connection between the diagonal of~$\Perm$ and the $(2,n)$-braid arrangement~$\multiBraidArrangement[2][n]$ studied in \cref{part:multiBraidArrangements}, illustrated in \cref{fig:diagonalPermutahedron1}.
%
\begin{figure}
	\centerline{\includegraphics[scale=.9]{diagonalPermutahedron1}}
	\caption{The duality between the $(2,3)$-braid arrangement~$\multiBraidArrangement[3][2]$ (left) and the diagonal of the permutahedron~$\Perm[3]$ (right).}
	\label{fig:diagonalPermutahedron1}
\end{figure}

\begin{proposition}
\label{prop:diagonalPermutahedraMultiBraidArrangements}
The inclusion poset on the faces in the image of the diagonal~$\triangle_{(\Perm, \b{v})}$ is isomorphic to the reverse inclusion poset of the faces of the $(2,n)$-braid arrangement~$\multiBraidArrangement[2][n]$. 
\end{proposition}

\begin{remark}
\label{rem:translationMatrix}
Note that the translation matrix~$\b{a}$ from \cref{def:multiBraidArrangementPrecise} has two rows, with first row~$\b{a}_{1,j} = 0$ and second row~$\b{a}_{2,j} = v_j-v_{j+1}$ for all~$j \in [n-1]$.
\end{remark}

\begin{remark}
Similarly, the combinatorics of the $(\ell-1)$\ordinalst{} iteration of a diagonal of the permutahedron~$\Perm$ is given by the combinatorics of the $(\ell,n)$-braid arrangement.
\end{remark}

Finally, the permutahedron~$\Perm$ is not magical in the sense of \cref{prop:magicalFormula}.
See also \cref{exm:intervalsWeakOrderNotDiagonals}.

\begin{proposition}[{\cite[Sect.~3]{LaplanteAnfossi}}]
For any~$n > 3$ and any generic vector~$\b{v}$, the diagonal~$\triangle_{(\Perm, \b{v})}$ of the permutahedron~$\Perm$ does \emph{not} satisfy the magical formula.
Namely, the inclusion	  
\begin{equation*}
\Ima\triangle_{(\Perm, \b{v})} \quad \subsetneq \bigcup_{\substack{F,G \text{ faces of } \Perm \\ \max_{\b{v}}(F) \, \le \, \min_{\b{v}}(G)}} F \times G  
\end{equation*}
is strict.
\end{proposition}

\begin{remark}
\label{rem:oppositeDiagonals}
Note that opposite diagonals have opposite orderings.
Namely, $\Or(-\b{v}) = \Or(\b{v})^{\op}$ where~$\Or^{\op} \eqdef \set{(J,I)}{(I,J) \in \Or}$.
\end{remark}

%%%%%%%%%%%%%%%

\subsection{Enumerative results on cellular diagonals of the permutahedra} 
\label{subsec:enumerationDiagonalPermutahedra}

Relying on \cref{prop:diagonalPermutahedraMultiBraidArrangements}, we now specialize the results of \cref{part:multiBraidArrangements} to the case~$\ell = 2$ to derive enumerative results on the diagonals of the permutahedra.

Observe that one can easily compute the full M\"obius polynomials of the $(2,n)$-braid arrangements~$\multiBraidArrangement[n][2]$ from \cref{thm:MobiusPolynomialMultiBraidArrangement}:
\begin{align*}
\allowdisplaybreaks
\mobPol[{\multiBraidArrangement[1][2]}] & = 1 \, , \\
\mobPol[{\multiBraidArrangement[2][2]}] & = x y - 2 x + 2 \, , \\
\mobPol[{\multiBraidArrangement[3][2]}] & = x^2 y^2 - 6 x^2 y + 10 x^2 + 6 x y - 18 x + 8 \, , \\
\mobPol[{\multiBraidArrangement[4][2]}] & = x^3 y^3 - 12 x^3 y^2 + 52 x^3 y - 84 x^3 + 12 x^2 y^2 - 96 x^2 y + 216 x^2 + 44 x y - 182 x + 50 \, , \\
\mobPol[{\multiBraidArrangement[5][2]}] & = x^4 y^4 - 20 x^4 y^3 + 160 x^4 y^2 - 620 x^4 y + 1008 x^4 \\ & \quad+ 20 x^3 y^3 - 300 x^3 y^2 + 1640 x^3 y - 3360 x^3 \\ & \quad+ 140 x^2 y^2 - 1430 x^2 y + 4130 x^2 + 410 x y - 2210 x + 432 \, .
\end{align*}
%which can be encoded in matrices as
%{\small
%\[
%\left(\begin{array}{r}
%1
%\end{array}\right)
%\left(\begin{array}{rr}
%2 & -2 \\
%0 & 1
%\end{array}\right)
%\left(\begin{array}{rrr}
%8 & -18 & 10 \\
%0 & 6 & -6 \\
%0 & 0 & 1
%\end{array}\right)
%\left(\begin{array}{rrrr}
%50 & -182 & 216 & -84 \\
%0 & 44 & -96 & 52 \\
%0 & 0 & 12 & -12 \\
%0 & 0 & 0 & 1
%\end{array}\right)
%\left(\begin{array}{rrrrr}
%432 & -2210 & 4130 & -3360 & 1008 \\
%0 & 410 & -1430 & 1640 & -620 \\
%0 & 0 & 140 & -300 & 160 \\
%0 & 0 & 0 & 20 & -20 \\
%0 & 0 & 0 & 0 & 1
%\end{array}\right)
%%\left(\begin{array}{r}
%%1
%%\end{array}\right)
%%\left(\begin{array}{rr}
%%2 & 0 \\
%%-2 & 1
%%\end{array}\right)
%%\left(\begin{array}{rrr}
%%8 & 0 & 0 \\
%%-18 & 6 & 0 \\
%%10 & -6 & 1
%%\end{array}\right)
%%\left(\begin{array}{rrrr}
%%50 & 0 & 0 & 0 \\
%%-182 & 44 & 0 & 0 \\
%%216 & -96 & 12 & 0 \\
%%-84 & 52 & -12 & 1
%%\end{array}\right)
%%\left(\begin{array}{rrrrr}
%%432 & 0 & 0 & 0 & 0 \\
%%-2210 & 410 & 0 & 0 & 0 \\
%%4130 & -1430 & 140 & 0 & 0 \\
%%-3360 & 1640 & -300 & 20 & 0 \\
%%1008 & -620 & 160 & -20 & 1
%%\end{array}\right)
%%\left(\begin{array}{rrrrrr}
%%4802 & 0 & 0 & 0 & 0 & 0 \\
%%-31922 & 4732 & 0 & 0 & 0 & 0 \\
%%82560 & -23100 & 1830 & 0 & 0 & 0 \\
%%-104400 & 41560 & -6210 & 340 & 0 & 0 \\
%%64800 & -32760 & 6960 & -720 & 30 & 0 \\
%%-15840 & 9568 & -2580 & 380 & -30 & 1
%%\end{array}\right)
%\]
%}

We now focus on the number of vertices, regions, and bounded regions of the $(2,n)$-braid arrangement~$\multiBraidArrangement[n][2]$, to obtain the number of facets, vertices, and internal vertices of the diagonal of the permutahedron~$\Perm$.
The first few values are gathered in \cref{table:enumerationDiagonalPermutahedra1,table:enumerationDiagonalPermutahedra2}.

\begin{table}
	\centerline{\scalebox{1}{
		\begin{tabular}[t]{c|ccccccccccc}
			$n$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ & $\dots$ & OEIS \\
			\hline
			facets & $1$ & $2$ & $8$ & $50$ & $432$ & $4802$ & $65536$ & $1062882$ & $20000000$ & $\dots$ & \OEIS{A007334} \\
			vertices & $1$ & $3$ & $17$ & $149$ & $1809$ & $28399$ & $550297$ & $12732873$ & $343231361$ & $\dots$ & \OEIS{A213507} \\
			int. verts. & $1$ & $1$ & $5$ & $43$ & $529$ & $8501$ & $169021$ & $4010455$ & $110676833$ & $\dots$ & \OEIS{A251568}
		\end{tabular}
	}}
	\vspace{.3cm}
	\caption{The numbers of facets, vertices, and internal vertices of the diagonal of the permutahedron~$\Perm$ for~$n \in [9]$.}
	\label{table:enumerationDiagonalPermutahedra1}
\end{table}

\begin{table}
	\centerline{
		\begin{tabular}{c@{\quad}c@{\quad}c@{\quad}c}
			$n = 1$ & $n = 2$ & $n = 3$ & $n = 4$
			\\[.1cm]
			\begin{tabular}[t]{r|c}
				\textbf{dim} & \textbf{0}  \\
				\hline
				\textbf{0} & 1  
			\end{tabular}
			&
			\begin{tabular}[t]{r|cc}
				\textbf{dim} & \textbf{0} & \textbf{1}  \\
				\hline
				\textbf{0} & 3 & 1 \\
				\textbf{1} & 1 &  
			\end{tabular}
			&
			\begin{tabular}[t]{r|ccc}
				\textbf{dim} & \textbf{0} & \textbf{1} & \textbf{2}  \\
				\hline
				\textbf{0} & 17 & 12 & 1 \\
				\textbf{1} & 12 &  6 & \\
				\textbf{2} & 1 &  & 
			\end{tabular}
			&
			\begin{tabular}[t]{r|cccc}
				\textbf{dim} & \textbf{0} & \textbf{1} & \textbf{2} & \textbf{3} \\
				\hline
				\textbf{0} & 149 & 162 & 38 & 1 \\
				\textbf{1} & 162 & 150 & 24 & \\
				\textbf{2} & 38 & 24 & & \\
				\textbf{3} & 1 & & &
			\end{tabular}
		\end{tabular}
	}
	\vspace{.3cm}
	\centerline{
		\begin{tabular}{c@{\quad}c}
			$n = 5$ & $n = 6$
			\\[.1cm]
			\begin{tabular}[t]{r|ccccc}
				\textbf{dim} & \textbf{0} & \textbf{1} & \textbf{2} & \textbf{3} & \textbf{4} \\
				\hline
				\textbf{0} & 1809 & 2660 & 1080 & 110 & 1 \\
				\textbf{1} & 2660 & 3540 & 1200 & 80 & \\
				\textbf{2} & 1080 & 1200 & 270 & & \\
				\textbf{3} & 110 & 80 & && \\
				\textbf{4} & 1 & & & &
			\end{tabular}
			&
			\begin{tabular}[t]{r|cccccc}
				\textbf{dim} & \textbf{0} & \textbf{1} & \textbf{2} & \textbf{3} & \textbf{4} & \textbf{5} \\
				\hline
				\textbf{0} & 28399 & 52635 & 30820 & 6165 & 302 & 1 \\
				\textbf{1} & 52635 & 90870 & 67580 & 7785 & 240 & \\
				\textbf{2} & 30820 & 47580 & 20480 & 2160 & & \\
				\textbf{3} & 6165 & 7785 & 2160 & && \\
				\textbf{4} & 302 & 240 & & &&\\
				\textbf{5} & 1 & & & &&
			\end{tabular}
		\end{tabular}
	}
	\caption{Number of pairs of faces in the cellular image of the diagonal of the permutahedron~$\Perm$ for~$n \in [6]$.}
	\label{table:enumerationDiagonalPermutahedra2}
\end{table}

\begin{corollary}
\label{coro:enumerationDiagonalPermutahedra}
The diagonal of the permutahedron~$\Perm$ has 
\begin{itemize}
\item $2 (n + 1)^{n-2}$ facets,
\item $n \binom{n-1}{k_1} (n-k_1)^{k_1-1} (n-k_2)^{k_2-1}$ facets corresponding to pairs~$(F_1, F_2)$ of faces of the permutahedron~$\Perm$ with~$\dim(F_1) = k_1$ and~$\dim(F_2) = k_2$ (thus~$k_1 + k_2 = n-1$),
\item $\displaystyle n! \, [z^n] \exp \bigg( \sum_{m \ge 1} \frac{C_m \, z^m}{m} \bigg)$ vertices,
\item $\displaystyle (n-1)! \, [z^{n-1}] \exp \bigg( \sum_{m \ge 1} C_m \, z^m \bigg)$ internal vertices,
\end{itemize}
where~$\displaystyle C_m \eqdef \frac{1}{m+1} \binom{2m}{m}$ denotes the $m$\ordinal{} Catalan number.
\end{corollary}

\begin{proof}
Use the duality between the $(2,n)$-braid arrangement~$\multiBraidArrangement[n][2]$ and the diagonal of the permutahedron~$\Perm$ (see \cref{fig:diagonalPermutahedron1}), and specialize \cref{thm:verticesMultiBraidArrangement,thm:regionsMultiBraidArrangement} to~$\ell = 2$.
\end{proof}

\begin{remark}
For completeness, we provide an alternative simpler proof of the first point of \cref{coro:enumerationDiagonalPermutahedra}.
By \cref{prop:flatPosetMultiBraidArrangement}, we just need to count the $(2,n)$-partition trees.
Consider a $(2,n)$-partition tree~$\b{F} \eqdef (F_1,F_2)$ (hence~$\# F_1 + \# F_2 = n + 1$).
Consider the intersection tree~$T$ of~$\b{F}$ with vertices labeled by the parts of~$F_1$ and of~$F_2$ and edges labeled by~$[n]$, root~$T$ at the part of~$F_1$ containing vertex~$1$, forget the vertex labels of~$T$, and send each edge label of~$T$ to the next vertex away from the root, and label the root by~$0$.
See \cref{fig:tree}.
The result is a spanning tree of the complete graph~$K_{n+1}$ on~$\{0, \dots, n\}$ which must contain the edge~$(0,1)$ (because we have chosen the root to be the part of~$F_1$ containing~$1$).
%
\begin{figure}
	\centerline{\includegraphics[scale=1]{tree}}
	\caption{The bijection from rooted $(\ell,n)$-partition trees (left) to spanning trees of~$K_{n+1}$ containing the edge~$(0,1)$ (right).}
	\label{fig:tree}
\end{figure}
%
Finally, by double counting the pairs~$(T,e)$ where $T$ is a spanning tree of~$K_{n+1}$ and $e$ is an edge of~$T$, we see that $n$ times the number of spanning trees of~$K_{n+1}$ equals $\binom{n+1}{2}$ times the number of spanning trees of~$K_{n+1}$ containing~$(0,1)$.
Hence, by Cayley's formula for spanning trees of~$K_{n+1}$, we obtain that the number of $(2,n)$-partition trees~is
\[
\frac{2n}{n(n+1)} (n+1)^{n-1} = 2 (n + 1)^{n-2}.
\]
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Operadic diagonals}
\label{sec:operadicDiagonals}

This section is devoted to the combinatorics of two specific diagonals of the permutahedra, which are shown to be the only operadic diagonals of the permutahedra.

%%%%%%%%%%%%%%%

\subsection{The $\LA$ and $\SU$ diagonals}
\label{subsec:LASUdiagonal}

Recall from \cref{sec:cellularDiagonalsPermutahedra} that a geometric diagonal of the permutahedron~$\Perm$ gives a choice of ordering of the sets~$\Un(n)$ (see \cref{def:Un}).
As we consider in this section diagonals for all permutahedra, we now consider families of orderings.

\begin{definition}
An \defn{ordering} of $\Un \eqdef \{\Un(n)\}_{n \ge 1}$ is a family~$\Or \eqdef \{\Or(n)\}_{n \ge 1}$ where~$\Or(n)$ is an ordering of~$\Un(n)$ for each~$n \ge 1$.
\end{definition}

The orderings define the following diagonals.

\begin{definition}
The \defn{$\LA$} and~\defn{$\SU$ orderings} are defined by
\begin{itemize} 
	\item $\LA(n) \eqdef \set{(I,J)}{\{I,J\} \in \Un(n) \text{ and } \min(I\cup J) = \min I}$ and
	\item $\SU(n) \eqdef \set{(I,J)}{\{I,J\} \in \Un(n) \text{ and } \max(I\cup J) = \max J}$.
\end{itemize}
\end{definition}

\begin{definition}
\label{def:LA-and-SU}
The \defn{$\LA$ diagonal} $\LAD$ (\resp \defn{$\SU$ diagonal} $\SUD$) of the permutahedron~$\Perm$ is the geometric diagonal~$\triangle_{(\Perm,\b{v})}$ given by any vector $\b{v} \in \R^n$ satisfying  
\[
\sum_{i \in I} v_i > \sum_{j \in J} v_j,
\]
for all~$(I,J) \in \LA(n)$ (\resp $(I,J) \in \SU(n)$).
\end{definition}

Note that the $\LA$ and $\SU$ diagonals coincide up to dimension $2$ (but differ in dimension~$\ge 3$).
They are illustrated in dimension~$2$ in \cref{fig:LUSAdiagonals}.
%Their faces for the $2$-dimensional permutahedron are illustrated on the first page of this article.  

\begin{figure}
	\centerline{\includegraphics[scale=1]{diagonalPermutahedron3}}
	\caption{The $\LA$ (and~$SU$) diagonal of~$\Perm[3]$ with faces labeled by ordered $(2,3)$-partition forests. (See also \cref{fig:B23a} for the dual hyperplane arrangement.)}
	\label{fig:LUSAdiagonals}
\end{figure}

We will prove in \cref{thm:recover-SU} that $\SUD$ is a topological enhancement of the Saneblidze--Umble diagonal from \cite{SaneblidzeUmble}.
The faces of the $\LA$ and $\SU$ diagonals are described the following specialisation of \cref{thm:IJ-description}.

\begin{theorem}
\label{thm:minimal}
For a pair $(\sigma,\tau)$ of ordered partitions of $[n]$, we have~$(\sigma,\tau) \notin \LAD$ if and only if there is~$(I,J) \in \LA(n)$ such that~$J$ dominates~$I$ in~$\sigma$ and~$I$ dominates~$J$ in~$\tau$.
%\[
%(\sigma,\tau) \notin \LAD \iff \text{there is } (I,J) \in \LA(n) \text{ such that } J \text{ dominates } I \text{ in } \sigma \text{ and } I \text{ dominates } J \text{ in } \tau.
%\]
The same holds for the $\SU$ diagonal by replacing $\LAD$ by $\SUD$ and $\LA(n)$ by $\SU(n)$.
\end{theorem}

%%%%%%%%%%%%%%%

\subsection{The operadic property}
\label{subsec:operadicProperty}

The goal of this section is to prove that the $\LA$ and $\SU$ diagonals are the only two operadic diagonals which induce the weak order on the vertices of the permutahedra (\cref{prop:unique-operad}). 

Let~$A \sqcup B = [n]$ be a partition of~$[n]$ where~$A \eqdef \{a_1,\dots,a_p\}$ and~$B \eqdef \{b_1,\dots,b_q\}$.
Recall that the ordered partition $B | A$ corresponds to a facet of the permutahedron~$\Perm$ defined by the inequality~$\sum_{b \in B} x_b \ge \binom{|B|+1}{2}$.
This facet is isomorphic to the cartesian product
\[
(\Perm[p] +q \one_{[p]}) \times \Perm[q]
\]
of lower dimensional permutahedra (where the first factor is translated by~$q \one_{[p]} \eqdef q \sum_{i \in [p]} \b{e}_i$), via the permutation of coordinates
\begin{equation*}
	\begin{matrix}
		\Theta & : & \R^{p} \times \R^{q} & \overset{\cong}{\longrightarrow} & \R^{n} \\
		 & & (x_1,\ldots,x_p) \times (x_{p+1}, \ldots, x_{n})  & \longmapsto & (x_{\sigma^{-1}(1)},\ldots,x_{\sigma^{-1}(n)})
	\end{matrix}
\end{equation*}
where $\sigma$ is the $(p,q)$-shuffle defined by $\sigma(i) \eqdef a_i$ for~$i \in [p]$, and $\sigma(p+j)\eqdef b_j$ for~$j \in [q]$.
Note that this map is a particular instance of the eponym map introduced in Point (5) of \cite[Prop.~2.3]{LaplanteAnfossi}.

\begin{definition}
\label{def:operadicDiagonal}
A family of diagonals $\triangle \eqdef \{\triangle_n : \Perm \to \Perm \times \Perm\}_{n\geq 1}$ of the permutahedra is \defn{operadic} if for every face $A_1 | \ldots | A_k$ of the permutahedron $\Perm[|A_1|+\cdots + |A_k|]$, the map $\Theta$ induces a topological cellular isomorphism \[  \triangle(A_1) \times \ldots \times \triangle(A_k) \cong \triangle(A_1 | \ldots | A_k) . \]
\end{definition}
In other words, we require that the diagonal $\triangle$ commutes with the map $\Theta$, see \cite[Sect.~4.2]{LaplanteAnfossi}.
At the algebraic level, this property is called ``comultiplicativity" in \cite{SaneblidzeUmble}.
Note that in particular, such an isomorphism respects the poset structures. 

We will now translate this operadic property for geometric diagonals to the corresponding orderings~$\Or$ of~$\Un$.
We need the following standardization map (this map is classical for permutations or words, but we use it here for pairs of sets).

\begin{definition}
The \defn{standardization} of a pair~$(I,J)$ of disjoint subsets of~$[n]$ is the only partition~$\std(I,J)$ of~$[|I|+|J|]$ where the relative order of the elements is the same as in~$(I,J)$.
More precisely, it is defined recursively by
\begin{itemize}
\item $\std(\varnothing, \varnothing) \eqdef (\varnothing, \varnothing)$, and
\item if~$k \eqdef |I|+|J|$ and~$\ell \eqdef \max(I \cup J)$ belongs to~$I$ (resp. $J$), then~$\std(I,J) = (U \cup \{k\}, V)$ (resp. $\std(I,J) \! = \! (U, V \cup \{k\})$) where~$(U,V) \! = \! \std(I \ssm \{\ell\}, J)$ (resp. ${(U,V) \! = \! \std(I, J \ssm \{\ell\})}$).
\end{itemize}
\end{definition}

For example, $\std(\{5,9,10\},\{6,8,12\}) = (\{1,4,5\},\{2,3,6\})$.

\begin{definition}
\label{def:operadicOrdering}
An ordering $\Or$ of $\Un$ is \defn{operadic} if every $\{I,J\} \in \Un$ satisfies the following two conditions
\begin{enumerate}
\item $\std(I,J) \in \Or$ implies~$(I,J) \in \Or$,
\item if there exist~$I'\subset I, J'\subset J$ such that $(I',J') \in \Or$ and $(I\ssm I',J\ssm J') \in \Or$, then~$(I,J) \in \Or$.
\end{enumerate}
We call \defn{indecomposables} of $\Or$ the pairs $(I,J) \in \Or$ for which the only subpair $(I',J')$ satisfying Condition (2) above is the pair $(I,J)$ itself.
\end{definition}

\begin{proposition}
\label{prop:equiv-operadic}
A geometric diagonal~$\triangle \eqdef \bigl( \triangle_{(\Perm, \b{v}_n)} \bigr)_{n \in \N}$ of the permutahedra is operadic if and only if its associated ordering~$\Or \eqdef \bigl( \Or(\b{v}_n) \bigr)_{n \in \N}$ is operadic. 
\end{proposition}

\begin{proof}
Every operadic diagonal satisfies \cite[Prop.~4.14]{LaplanteAnfossi}, which amounts precisely to an operadic ordering of $\Un$ in the above sense. 
\end{proof}

We now turn to the study of the $\LA$ and $\SU$ orderings.

\begin{lemma} 
\label{lem:operadic-ordering}
The $\LA$ and $\SU$ orderings are operadic, and their indecomposables are the pairs whose standardisation are $(\{1\},\{2\})$ and
\begin{align}
(\{1,k+2,k+3,\dots,2k-1,2k\}, \{2,3,\dots,k+1\}) \tag{$\LA$} \label{eq:std-LA} \\
(\{k,k+1,\dots,2k-1\},\{1,2,3,\dots,k-1,2k\}) \tag{$\SU$}
\end{align} 
for all~$k\geq 1$. 
The opposite orderings $\LA^{op}$ and $\SU^{op}$ are also operadic, and generated by the opposite pairs.
\end{lemma}

\begin{proof}
We present the proof for the $\LA$ ordering, the proofs for the $\SU$ and opposite orders are similar.
First, we verify that $\LA$ is operadic. 
Condition (1) follows from the fact that standardising a pair preserves its minimal element.
Condition (2) also holds, since whenever $(I',J')$ and its complement are in $\LA$, we have $\min(I)=\min\{\min(I'),\min(I\ssm I')\}$, and thus $(I,J)$ itself is in $\LA$.

Second, we compute the indecomposables. 
Let $(I,J)$ be a pair with standardisation (\ref{eq:std-LA}).
If we try to decompose $(I,J)$ as a non-trivial union, there is always one pair $(I',J')$ in this union for which~$\min (I\cup J) \notin I'$, so we have $\min ( I' \cup J') = \min J'$, which implies that $(I',J') \notin \LA$.
Thus, the pair~$(I,J)$ is indecomposable. 

It remains to show that any pair $(I,J)$ in $\LA$ whose standardisation is not of the form (\ref{eq:std-LA}) can be decomposed as a union of such pairs. 
Let us denote by $(I_k,J_k)$ the standard form (\ref{eq:std-LA}) and let $(I,J)\in \LA$ be such that $\std(I,J) \neq (I_k,J_k)$.
Then there exists $i_2 \in I\ssm \min I$ such that $i_2 < \max J$.
This means that $(I,J)$ can be decomposed as a union: if we write it as $(\{i_1,\dots,i_k\},\{j_1,\dots,j_k\})$, where each set ordered smallest to largest, then we must have $\min (I\cup J)=i_1<i_2<j_k$, in which case $(\{i_2\},\{j_k\})$ and $(\{i_1,i_3,\dots,i_k\},\{j_1,\dots,j_{k-1}\})$ are both smaller $\LA$ pairs.
Then it must be the case that $\std((\{i_2\},\{j_k\})) = (\{1\},\{2\})$, and $\std((\{i_1,i_3,\dots,i_k\},\{j_1,\dots,j_{k-1}\}))$ is either $(I_{k-1},J_{k-1})$, or we can repeat this decomposition.
This process must eventually terminate with the right-hand side reducing to $(I_l,J_l)$ for some $1 \leq l \leq k-1$.
In other words, any ${(I,J) = (\{i_1,\dots,i_k\}, \{j_1,\dots,j_k\})}$ decomposes as
\begin{align*}
	(I,J) = (\{i_2\},\{j_k\}) \sqcup (\{i_3\},\{j_{k-1}\}) \sqcup \dots \sqcup (\{i_{l+1} \},\{j_{k-l-1} \}) \sqcup (I',J')
\end{align*}
where $\std((I',J')) = (I_l,J_l)$, and $1\leq l \leq k$.
\end{proof}

\begin{remark}
We note that the decomposition in \cref{lem:operadic-ordering} is one of potentially many different decompositions of the pair $(I,J)$. 
However, by definition of the $\LA$ order, for any decomposition $(I,J) = (\bigsqcup_{a\in A} I_a, \bigsqcup_{a \in A} J_a)$, we have that $\std(I_a, J_a) \in \LA$ for all~$a \in A$.
As such all decompositions of a pair $(I,J)$ order it the same way.
\end{remark}

\begin{proposition}
\label{prop:operadic-ordering}
The only operadic orderings of $\Un=\{\Un(n)\}_{n\geq 1}$ are the $\LA,\SU,\LA^{\op}$ and $\SU^{\op}$ orderings.
\end{proposition}

\begin{proof}
We build operadic orderings inductively, showing that the choices for $\Un(n)$, $n\leq 4$ determine higher ones. 
We prove the statement for the $\LA$ order, the $\SU$ and opposite orders are similar. 
First, we decide to order the unique pair of $\Un(2)$ as $(\{1\},\{2\})$.
The operadic property then determines the orders of all the pairs of $\Un(3)$ and $\Un(4)$, except the pair $\{\{1,4\},\{2,3\}\}$, for which we choose the order $(\{1,4\},\{2,3\})$.
Now, we claim that all the higher choices are forced by the operadic property. 
Starting instead with the orders $(\{1\},\{2\})$ and $(\{2,3\},\{1,4\})$ would give the $\SU$ diagonal, and reversing the pairs would give the opposite orders. 

Let $l\geq 2$ and suppose that for all $k\leq l$, we have given the pair $\{I_k,J_k\} \eqdef \{\{1,k+2,k+3,\dots,2k-1,2k\},\{2,3,\dots,k+1\}\}$ the $\LA$ ordering $(I_k,J_k)$.
Then from \cref{lem:operadic-ordering}, we know that the only $\{I,J\}$ pair of order $l+1$ that will not decompose, and hence be specified by the already chosen conditions, is $\{I_{l+1},J_{l+1}\}$.
As such, the only way we can vary from $\LA$ is to order this element in the opposite direction $(J_{l+1},I_{l+1})$. 
We now define a particular decomposable pair $\{I'_m,J'_m\}:= I_m \sqcup \{3\} \ssm \{m+2\}, J_m \sqcup \{m+2\} \ssm \{3\}$, of order $m \eqdef l+2$, that will lead to a contradiction (see \cref{ex:Non-coherent order contradiction}).
On the one side, we can decompose $\{I'_m,J'_m\} = \{I_a \cup I_b, J_a \cup J_b\}$ with $I_a \eqdef  \{1,m+3,\dots,2m\}, J_a \eqdef  \{4,5,\dots,m+2\}, I_b \eqdef \{3\}$ and $J_b \eqdef  \{2\}$. 
By hypothesis, we have the orders $(J_a,I_a)$ and $(J_b,I_b)$ which imply the order $(J'_m,I'_m)$ since our ordering is operadic. 
On the other side, we can decompose $\{I'_m,J'_m\} = \{I_c \cup I_d, J_c \cup J_d\}$, where $I_c \eqdef  \{1,m+3,\dots,  2m-1\}, J_c \eqdef \{2,5,\dots,m+1\}, I_d \eqdef \{3, 2m\}$ and $J_d \eqdef  \{4, m+2\}$.
By hypothesis, we have the orders $(I_c,J_c)$ and $(I_d,J_d)$ which imply that $(I'_m,J'_m)$, a contradiction.
Thus, the only possible operadic choice of ordering for $\{I_{l+1},J_{l+1}\}$ is the $\LA$ ordering, which finishes the proof. 
\end{proof}

\begin{example} 
\label{ex:Non-coherent order contradiction}
Suppose that the $\LA$ ordering holds for pairs of order $1$ and $2$, but is reversed for pairs of order $3$, \ie
\begin{align*}
	(\{1\}, \{2\}) \in \Or, \quad (\{1,4\}, \{2,3\}) \in \Or, \text{ and } (\{2, 3, 4\}, \{1, 5, 6 \}) \in \Or.
\end{align*}
Then $\{I'_4,J'_4\}=\{\{1, 3, 7, 8\}, \{2, 4, 5, 6\}\}$ admits two different orientations.
In particular, 
\begin{align*}
	(\{ 4, 5, 6 \} , \{1, 7, 8\}) \in \Or \text{ and } (\{2\}, \{3\}) \in \Or & \Longrightarrow (\{2, 4, 5, 6\}, \{1, 3, 7, 8\} ) \in \Or \ \text{and} \\
	(\{1, 7\}, \{2, 5\}) \in \Or \text{ and } (\{3, 8\}, \{4, 6\}) \in \Or & \Longrightarrow (\{1, 3, 7, 8\}, \{2, 4, 5, 6\}) \in \Or.
\end{align*}
\end{example}

Combining \cref{prop:equiv-operadic} with \cref{prop:operadic-ordering}, we get the main result of this section.
Recall that a vector induces the weak order on the vertices of the standard permutahedron if and only if it has strictly decreasing coordinates (see \cref{def:permutahedron}).

\begin{theorem}
\label{prop:unique-operad}
There are exactly four operadic geometric diagonals of the permutahedra, given by the $\LA$ and $\SU$ diagonals, and their opposites~$\LA^{\op}$ and $\SU^{\op}$. 
The $\LA$ and $\SU$ diagonals are the only operadic geometric diagonals which induce the weak order on the vertices of the permutahedron.
\end{theorem}

\begin{remark}
This answers by the negative a conjecture regarding unicity of diagonals on the permutahedra, raised at the beginning of \cite[Sect.~3]{SaneblidzeUmble}, and could be seen as an alternative statement. 
See \cref{sec:shifts} where we prove that the geometric $\SU$ diagonal is a topological enhancement of the $\SU$ diagonal from \cite{SaneblidzeUmble}.
\end{remark}

%%%%%%%%%%%%%%%

\subsection{Isomorphisms between operadic diagonals}
\label{subsec:isos-LA-SU}

Let $P$ be a centrally symmetric polytope, and let $s : P \to P$ be its involution, given by taking a point $\b{p} \in P$ to its reflection $s(\b{p})$ with respect to the center of symmetry of $P$. 
Note that this map is cellular, and induces an involution on the face lattice of $P$. 
For $P$ the permutahedron, this face poset involution is given by the assignment $A_1 | \cdots | A_k \mapsto A_k | \cdots | A_1$. 

The permutahedron possesses another symmetry: the cellular involution $r : P \to P$ which sends a point $p \in P$ to its reflection with respect to the hyperplane of equation \[ \sum_{i=1}^{\lfloor n/2 \rfloor}x_i = \sum_{i=1}^{\lfloor n/2 \rfloor}x_{n-i+1} . \]
This involution also respects the face poset structure. 
In terms of ordered partitions, it replaces each block $A_j$ in $A_1 | \cdots | A_k$ by the block $r(A_j) \eqdef \{r(i) \ | \ i \in A_j\}$ where~$r(i) \eqdef n-i+1$.

The involution $t : P \times P \to P \times P$ sending $(x,y)$ to~$(y,x)$ takes a cellular diagonal to another cellular diagonal.
As we have already remarked in \cref{subsec:LASUdiagonal}, in the case of the permutahedron it sends $\LAD$ to $(\LAD)^\op$ and $\SUD$ to $(\SUD)^\op$.

\begin{theorem}
	\label{thm:bijection-operadic-diagonals}
	For $P$ the permutahedron, the involutions $t$ and $rs \times rs$ are cellular isomorphisms between the four operadic diagonals, through the following commutative diagram
	\begin{center}
		\begin{tikzcd}
		\LAD \arrow[r,"t"] \arrow[d,"rs \times rs"']&
		(\LAD)^{\op}\arrow[d,"rs \times rs"]\\
		\SUD \arrow[r,"t"'] &
		(\SUD)^\op
		\end{tikzcd}
		\end{center}
	Moreover, they induce poset isomorphisms at the level of the face lattices. 
\end{theorem}

\begin{proof}
The result for the transpositions $t$ and the commutativity of the diagram are straightforward, so we prove that $rs\times rs$ is a cellular isomorphism respecting the poset structure. 
First, since $r(\min(I\cup J))=\max(r(I) \cup r(J))$, we observe that the map $(I,J) \mapsto (r(J),r(I))$ defines a bijection between $\LA(n)$ and $\SU(n)$.
Then, if $\sigma$ is an ordered partition such that $I$ dominates $J$ in $\sigma$ (\cref{def:domination}), it must be the case that $J$ dominates $I$ in $s\sigma$, and consequently $rJ$ dominates $rI$ in $rs\sigma$.
As such, the domination characterisation of the diagonals (\cref{thm:minimal}), tells us~$(\sigma,\tau) \in \LAD$ if and only if $(rs(\sigma),rs(\tau)) \in \SUD$.
Finally, since both $t,r$ and $s$ preserve the poset structures, so does their composition, which finishes the proof.
\end{proof}

\begin{remark} \label{rem:Alternate Isomorphism}
There is a second, distinct isomorphism given by $t(r\times r)$.
This follows as $s\times s:\LAD \to (\LAD)^{\op}$ is an isomorphism (and also for  $s\times s:\SUD \to (\SUD)^{\op}$ ), as such the composite 
\begin{center}
\begin{tikzcd}
t(r\times r):\LAD \arrow[r,"s\times s"] &
(\LAD)^{\op}\arrow[r,"rs \times rs"] &
(\SUD)^\op \arrow[r,"t"] & \SUD
\end{tikzcd}
\end{center}
is also an isomorphism.
This second isomorphism has the conceptual benefit of sending left shift operators to left shift operators (and right to right), see \cref{prop:trr is an isomorphism of shifts}.
\end{remark}

%%%%%%%%%%%%%%%

\subsection{Facets of operadic diagonals}
\label{subsec:facets-operadic-diags}

We aim at describing the facets of the $\LA$ and $\SU$ diagonals. 
We have seen in \cref{subsec:multiBraidArrangement} that facets of any diagonal of the permutahedron~$\Perm$ are in bijection with $(2,n)$-partition trees, that is, pairs of unordered partitions of $[n]$ whose intersection graph is a tree.
These pairs of partitions were first studied and called \defn{essential complementary partitions} in \cite{Chen, ChenGoyal, KajitaniUenoChen}.
Specializing \cref{prop:PFtoOPF1}, we now explain how to order these pairs of partitions to get the facets of $\LAD$ and $\SUD$. 

\begin{theorem}
\label{thm:facet-ordering}
Let $(\sigma,\tau)$ be two ordered partitions of $[n]$ whose underlying intersection graph is a $(2,n)$-partition tree.
We have~$(\sigma,\tau) \in \LAD$ (\resp $\SUD$) if and only if the minimum (\resp maximum) of every directed path between two consecutive blocks of $\sigma$ or $\tau$ is oriented from $\sigma$ to $\tau$, that is from left to right (\resp from $\tau$ to $\sigma$, that is from right to left).
\end{theorem}

\begin{proof}
We specialize \cref{prop:PFtoOPF1} to the $\LA$ diagonal, the proof for the $\SU$ diagonal is similar. 
Let $\b{v}$ be a vector inducing the $\LA$ diagonal as in \cref{def:LA-and-SU}.
Without loss of generality, we place the first copy of the braid arrangement centered at $0$, and the second copy centered at $\b{v}$.
From \cref{def:multiBraidArrangementPrecise,rem:translationMatrix}, we get that $A_{1,s,t}=0$ and $A_{2,s,t}=v_s-v_t$ for any edges $s,t$.
We treat the case of a two consecutive blocks $A$ and $B$ of $\sigma$, the analysis for $\tau$ is similar. 
The directed path between $A$ and $B$ is a sequence of edges $r_0,r_1,\dots,r_q$.  
Let us denote by $I \eqdef \{r_0,r_2,\dots\}$ de set of edges directed from $\sigma$ to $\tau$, and by $J \eqdef \{r_1,r_3,\dots\}$ its complement. 
According to \cref{prop:PFtoOPF1}, the order between $A$ and $B$ is determined by the sign of $A_{1,r_0,r_q}- \sum_{p \in [q]} A_{i_p,r_{p-1},r_p}$, where $i_p$ is the copy of the block adjacent to both edges $r_{p-1}$ and $r_p$. 
Thus, the order between $A$ and $B$ is determined by the sign of $\sum_{i \in I} v_i - \sum_{j \in J} v_j$, which according to the definition of $\LAD$ is positive whenever $\min(I\cup J) \in I$. 
Thus, the pair $(\sigma,\tau) \in \LAD$ if and only if the mimum of every directed path between two consecutive blocks of $\sigma$ or $\tau$ is oriented from $\sigma$ to $\tau$. 
\end{proof}

\begin{example}
\label{ex:ECbijection}
Below are the two orderings of the $(2,7)$-partition tree $\{15,234,6,7\} \times \{13,2,46,57\}$ giving facets of the $\LA$ (left) and $\SU$ (right) diagonals, obtained via \cref{thm:facet-ordering}.
Note that ordered partitions should be read from top to bottom.
\begin{center}
	\begin{tikzpicture}[scale=.7]  
		\node[anchor=east] (1) at (-1.5, -1) {$15$};
		\node[anchor=east] (2) at (-1.5, -2) {$7$};
		\node[anchor=east] (3) at (-1.5, -3) {$234$};
		\node[anchor=east] (4) at (-1.5, -4) {$6$};
		%
		\node[anchor=west] (5) at (1.5, -1) {$57$};
		\node[anchor=west] (6) at (1.5, -2) {$46$};
		\node[anchor=west] (7) at (1.5, -3) {$13$};
		\node[anchor=west] (8) at (1.5, -4) {$2$};
		%
		\draw[thick] (1.east) -- (5.west); 
		\draw[thick] (1.east) -- (7.west);
		\draw[thick] (2.east) -- (5.west); 
		\draw[thick] (3.east) -- (6.west); 
		\draw[thick] (3.east) -- (7.west); 
		\draw[thick] (3.east) -- (8.west); 
		\draw[thick] (4.east) -- (6.west);
	\end{tikzpicture}
	$\quad$
	\begin{tikzpicture}[scale=.7]  
		\node[anchor=east] (7) at (-1.5, -4) {$7$};
		\node[anchor=east] (6) at (-1.5, -3) {$6$};
		\node[anchor=east] (234) at (-1.5, -2) {$234$};
		\node[anchor=east] (15) at (-1.5, -1) {$15$};
		%
		\node[anchor=west] (2) at (1.5, -4) {$2$};
		\node[anchor=west] (13) at (1.5, -3) {$13$};
		\node[anchor=west] (46) at (1.5, -2) {$46$};
		\node[anchor=west] (57) at (1.5, -1) {$57$};
		%
		\draw[thick] (2.west) -- (234.east);
		\draw[thick] (13.west) -- (15.east); 
		\draw[thick] (13.west) -- (234.east);
		\draw[thick] (46.west) -- (234.east);
		\draw[thick] (46.west) -- (6.east); 
		\draw[thick] (57.west) -- (15.east);
		\draw[thick] (57.west) -- (7.east);
	\end{tikzpicture}
\end{center}
In the $\LA$ facet (left), we have $7 < 234$, since in the path between the two vertices $7 \xrightarrow{7} 57 \xrightarrow{5} 15 \xrightarrow{1} 13 \xrightarrow{3} 234$, the minima $1$ oriented from left to right. 
In this case, we have $(I,J)=(\{1,7\},\{3,5\})$.
Similarly, the path $57 \xrightarrow{5} 15 \xrightarrow{1} 13 \xrightarrow{3} 234 \xrightarrow{4} 46$ imposes that $57 < 46$, for $(I,J)=(\{1,4\},\{3,5\})$.
\end{example}

\begin{remark}
Note that forgetting the order in a facet of $\LAD$, and then ordering again the $(2,n)$-partition tree to obtain a facet of $\SUD$, provides a bijection between facets that was not considered in \cref{subsec:isos-LA-SU}.
However this map is not defined on the other faces.
\end{remark}

\begin{example}
The isomorphism $rs\times rs$ from \cref{thm:bijection-operadic-diagonals} sends the $\LA$ facet from \cref{ex:ECbijection} (left) to the following $\SU$ facet (right).
\begin{center}
	\begin{tikzpicture}[scale=.7]  
		\node[anchor=east] (1) at (-1.5, -1) {$15$};
		\node[anchor=east] (2) at (-1.5, -2) {$7$};
		\node[anchor=east] (3) at (-1.5, -3) {$234$};
		\node[anchor=east] (4) at (-1.5, -4) {$6$};
		%
		\node[anchor=west] (5) at (1.5, -1) {$57$};
		\node[anchor=west] (6) at (1.5, -2) {$46$};
		\node[anchor=west] (7) at (1.5, -3) {$13$};
		\node[anchor=west] (8) at (1.5, -4) {$2$};
		%
		\draw[thick] (1.east) -- (5.west); 
		\draw[thick] (1.east) -- (7.west);
		\draw[thick] (2.east) -- (5.west); 
		\draw[thick] (3.east) -- (6.west); 
		\draw[thick] (3.east) -- (7.west); 
		\draw[thick] (3.east) -- (8.west); 
		\draw[thick] (4.east) -- (6.west);
		%
	\end{tikzpicture}
	\raisebox{3.4em}{$\xrightarrow{rs\times rs}$}
	\begin{tikzpicture}[scale=.7]  
		\node[anchor=east] (5) at (-1.5, -4) {$37$};
		\node[anchor=east] (6) at (-1.5, -3) {$1$};
		\node[anchor=east] (7) at (-1.5, -2) {$456$};
		\node[anchor=east] (8) at (-1.5, -1) {$2$};
		%
		\node[anchor=west] (1) at (1.5, -4) {$13$};
		\node[anchor=west] (2) at (1.5, -3) {$24$};
		\node[anchor=west] (3) at (1.5, -2) {$57$};
		\node[anchor=west] (4) at (1.5, -1) {$6$};
		%
		\draw[thick] (1.west) -- (5.east);
		\draw[thick] (1.west) -- (6.east); 
		\draw[thick] (2.west) -- (7.east);
		\draw[thick] (2.west) -- (8.east);
		\draw[thick] (3.west) -- (5.east); 
		\draw[thick] (3.west) -- (7.east);
		\draw[thick] (4.west) -- (7.east);
	\end{tikzpicture}
\end{center}
Moreover, it sends the path $57 \xrightarrow{5} 15 \xrightarrow{1} 13 \xrightarrow{3} 234 \xrightarrow{4} 46 $ to the path $24 \xrightarrow{4} 456 \xrightarrow{5} 57 \xrightarrow{7} 37 \xrightarrow{3} 13$, where the maximum $7$ is oriented from right to left, witnessing the fact that $24 < 13$. 
The associated $(I,J)=(\{1,4 \},\{3,5\})$ becomes $(r(J),r(I))=(\{3,5 \},\{4,7\})$.
\end{example}


%%%%%%%%%%%%%%%

\subsection{Vertices of operadic diagonals}
\label{subsec:vertices-operadic-diags}

We are now interested in characterizing the vertices that occur in an operadic diagonal as pattern-avoiding pairs of partitions of $[n]$. 
These pairs form a strict subset of the weak order intervals. 
We first need the following Lemma, which follows directly from the definition of domination (\cref{def:domination}).

\begin{lemma}
\label{lem:Coherent Domination}
Let $\sigma$ be an ordered partition of $[n]$ and let $I,J \subseteq [n]$ be such that $I$ dominates $J$ in~$\sigma$. 
For an element $i$ in $I$ or $J$, we denote by $\sigma^{-1}(i)$ the index of the block containing it in $\sigma$. 
Then, for any $i \in I,j \in J$, we have that $I\ssm i$ dominates $J\ssm j$ in $\sigma$ if and only if either
\begin{enumerate}
	\item either~$\sigma^{-1}(j) < \sigma^{-1}(i)$ (meaning that $j$ comes strictly before $i$ in $\sigma$),
	\item or for all $k$ between $\sigma^{-1}(i)$ and $\sigma^{-1}(j)$, the first $k$ blocks of $\sigma$ contain stricly more elements of $I$ than of $J$.
\end{enumerate}
\end{lemma}

% As before, we represent a permutation $\sigma: [n] \to [n]$ by the non-commutative word~$\sigma(1)\cdots \sigma(n)$.

\begin{definition}
For $k\leq n$, a permutation $\tau$ of $[k]$ is a \defn{pattern} of a permutation $\sigma$ of $[n]$ if there exists a subset $I \eqdef \{i_1 < \dots < i_k\} \subset [n]$ so that the permutation~$\tau$ gives the relative order of the entries of~$\sigma$ at positions in~$I$, \ie $\tau_u < \tau_v \eqdef \sigma_{i_u} < \sigma_{i_v}$.
We say that $\sigma$ \defn{avoids} $\tau$ if $\tau$ is not a pattern~of~$\sigma$. 
\end{definition}

\begin{example}
The pairs of permutations $(\sigma,\tau)$ avoiding the patterns $(21,12)$ are precisely the intervals of the weak order. 
\end{example}

\begin{theorem}
\label{prop: LAD Fish Pattern}
A pair of permutations of $[n]$ is in the $\LA$ (\resp $\SU$) diagonal if and only if for any~$k\geq 1$ and for any $(I,J) \in \LA(k)$ (\resp $\SU(k)$) of size $|I|=|J|=k$ it avoids the patterns 
\begin{align}
	(j_1 i_1 j_2 i_2 \cdots j_k i_k,\ i_2 j_1 i_3 j_2 \cdots i_k j_{k-1} i_1 j_k), \tag{LA} \label{eq:pattern} \\
	\text{ \resp } (j_1 i_1 j_2 i_2 \cdots j_k i_k, \ i_1 j_k i_2 j_1 \cdots i_{k-1} j_{k-2}i_k j_{k-1}), \tag{SU}
\end{align}
where $I=\{i_1,\dots,i_k\}$, $J=\{j_1,\dots,j_k\}$ and $i_1=1$ (\resp $j_k=2k$).
\end{theorem}

\begin{example}\label{exm:intervalsWeakOrderNotDiagonals}
For each $k$, there are $\binom{2k-1}{k-1,k}(k-1)!k!$ avoided standardised patterns.
For $k=1$, both diagonals avoid $(21,12)$, so the vertices are intervals of the weak order.
For $k=2$, 
\begin{itemize}
    \item $\LA$ avoids 
    $(3142,2314), (4132,2413),
    (2143,3214), (4123,3412),
    (2134,4213), (3124,4312)$.
    \item $\SU$ avoids 
    $(1243,2431),(1342,3421),
    (2143,1432),(2341,3412),
    (3142,1423),(3241,2413)$.
\end{itemize}
As such, the vertices of $\LA$ and $\SU$ are a strict subset of all intervals of the weak order.
Here is an illustration of the patterns avoided for $k=4$.
The $\LA$ pattern is drawn on the left, the $\SU$ pattern is drawn on the right, and they are in bijection under the isomorphism $t(r\times r)$ (\cref{subsec:isos-LA-SU}), where the bijection between elements is $(i_1,i_2,i_3,i_4)\mapsto (j'_4,j'_1,j'_2,j'_3)$ and $(j_1,j_2,j_3,j_4)\mapsto (i'_1,i'_2,i'_3,i'_4)$.
\begin{center}
\begin{tikzpicture}[scale=.7]  
\node[anchor=east] (0) at (-1.5, 0) {$j_1$};
\node[anchor=east] (1) at (-1.5, -1) {$i_1$};
\node[anchor=east] (2) at (-1.5, -2) {$j_2$};
\node[anchor=east] (3) at (-1.5, -3) {$i_2$};
\node[anchor=east] (4) at (-1.5, -4) {$j_3$};
\node[anchor=east] (5) at (-1.5, -5) {$i_3$};
\node[anchor=east] (6) at (-1.5, -6) {$j_4$};
\node[anchor=east] (7) at (-1.5, -7) {$i_4$};
%
\node[anchor=west] (8) at (1.5, 0) {$i_2$};
\node[anchor=west] (9) at (1.5, -1) {$j_1$};
\node[anchor=west] (10) at (1.5, -2) {$i_3$};
\node[anchor=west] (11) at (1.5, -3) {$j_2$};
\node[anchor=west] (12) at (1.5, -4) {$i_4$};
\node[anchor=west] (13) at (1.5, -5) {$j_3$};
\node[anchor=west] (14) at (1.5, -6) {$i_1$};
\node[anchor=west] (15) at (1.5, -7) {$j_4$};
%
\draw[thick, green] (0.east) -- (9.west);
\draw[thick, blue, dashed] (1.east) -- (14.west);
\draw[thick, green] (2.east) -- (11.west);
\draw[thick, blue] (3.east) -- (8.west);
\draw[thick, green] (4.east) -- (13.west);
\draw[thick, blue] (5.east) -- (10.west);
\draw[thick, green] (6.east) -- (15.west);
\draw[thick, blue] (7.east) -- (12.west);
%
\end{tikzpicture}
\raisebox{7em}{$\xrightarrow{t(r\times r)}$}
\begin{tikzpicture}[scale=.7]  
\node[anchor=east] (0) at (-1.5, 0) {$j'_1$};
\node[anchor=east] (1) at (-1.5, -1) {$i'_1$};
\node[anchor=east] (2) at (-1.5, -2) {$j'_2$};
\node[anchor=east] (3) at (-1.5, -3) {$i'_2$};
\node[anchor=east] (4) at (-1.5, -4) {$j'_3$};
\node[anchor=east] (5) at (-1.5, -5) {$i'_3$};
\node[anchor=east] (6) at (-1.5, -6) {$j'_4$};
\node[anchor=east] (7) at (-1.5, -7) {$i'_4$};
%
\node[anchor=west] (8) at (1.5, 0) {$i'_1$};
\node[anchor=west] (9) at (1.5, -1) {$j'_4$};
\node[anchor=west] (10) at (1.5, -2) {$i'_2$};
\node[anchor=west] (11) at (1.5, -3) {$j'_1$};
\node[anchor=west] (12) at (1.5, -4) {$i'_3$};
\node[anchor=west] (13) at (1.5, -5) {$j'_2$};
\node[anchor=west] (14) at (1.5, -6) {$i'_4$};
\node[anchor=west] (15) at (1.5, -7) {$j'_3$};
%
\draw[thick, green] (0.east) -- (11.west);
\draw[thick, blue] (1.east) -- (8.west);
\draw[thick, green] (2.east) -- (13.west);
\draw[thick, blue] (3.east) -- (10.west);
\draw[thick, green] (4.east) -- (15.west);
\draw[thick, blue] (5.east) -- (12.west);
\draw[thick, green, dashed] (6.east) -- (9.west);
\draw[thick, blue] (7.east) -- (14.west);
%
\end{tikzpicture}
\end{center}
The alternate isomorphism $t(s\times s)$, provides an alternate way to establish a bijection between these two patterns.
The avoided patterns for higher $k$ extend this crisscrossing shape.

\end{example}

\begin{proof}
We give the proof for the $\LA$ diagonal, the one for the $\SU$ diagonal is similar, and can be obtained by applying either of the two isomorphisms of \cref{subsec:isos-LA-SU}.
According to \cref{thm:IJ-description}, we have that $(\sigma,\tau) \notin \LAD$ if and only if there is an $(I,J)$ such that~$J$ dominates $I$ in $\sigma$ and~$I$ dominates $J$ in $\tau$.
It is clear that if a pair of permutations $(\sigma,\tau)$ contains a pattern of the form~(\ref{eq:pattern}), then the associated $(I,J)$ satisfies the domination condition.
Thus, we just need to show the reverse implication. 
We proceed by induction on the cardinality $|I|=|J|$. 
The case of cardinality $1$ is clear. 
Now suppose that for all $(I,J)$ of size $|I|=|J|\leq m-1$, we have that if~$J$ dominates $I$ in $\sigma$ and $I$ dominates $J$ in $\tau$, then $(\sigma,\tau)$ contains a pattern of the form~(\ref{eq:pattern}).

We need to show that this is still true for the pairs $(I,J)$ of size $|I|=|J|=m$.
Firstly, we need only consider standardised $I,J$ conditions, and pairs of permutations of $[2m]$.
Why?
If we define $(\sigma',\tau') := \std(\sigma \cap (I\cup J),\tau \cap (I\cup J))$, and $(I',J'):=\std(I',J')$, 
then if $(\sigma,\tau)$ satisfies the $(I,J)$ domination condition, this implies $(\sigma',\tau')$ satisfies $(I',J')$.
Conversely, if $(\sigma',\tau')$ has a pattern, then this implies $(\sigma,\tau)$ has the same pattern.
Which yields the indicated simplification.

Let $(\sigma,\tau)$ be such a pair of permutations.
Suppose the leftmost element $i_1$ of $I$ in $\sigma$ is not $1$, and let us write $j_1$ for the leftmost element of $J$ in $\tau$.
Consider the pair ${(I',J') \eqdef (I\ssm \{i_1\}, J \ssm \{j_1\})}$.
Using both cases of \cref{lem:Coherent Domination}, we have that $J'$ dominates $I'$ in $\sigma$, and $I'$ dominates $J'$ in $\tau$, and we can thus conclude by induction that $(\sigma,\tau)$ contains a smaller pattern.

So, we assume the leftmost element of $I$ in $\sigma$ is $i_1=1$, and for $n\geq1$ we prove that,
\begin{enumerate}[(a)]
    \item If $(\sigma,\tau)=(j_1 i_1 j_2 i_2 ... j_{n-1} i_{n-1} w i_{n} w', \ i_2 j_1 i_3 j_2 ... i_{n}j_{n-1}w'') $, and $j_n$ is the leftmost element of $J\ssm \{j_1,...,j_{n-1}\}$ in $\tau$, then either $w = j_n$, or it matches a smaller pattern.
    \item If $(\sigma,\tau)=(j_1 i_1 j_2 i_2 ... j_{n-1} i_{n-1} w'', \ i_2 j_1 i_3 j_2 ... i_{n-1}j_{n-2} w j_{n-1} w'')$, and $i_n$ is the leftmost element of ${I\ssm \{i_1,...,i_{n-1}\}}$ in $\sigma$, then either $w = i_n$, or it matches a smaller pattern.
\end{enumerate}
We prove $(a)$, the proof of $(b)$ proceeds similarly. 
Let $j_n$ be the leftmost element of $J\ssm \{j_1,...,j_{n-1} \}$ in $\tau$.
If $w\neq j_n$, then either (i) $w$ consists of multiple elements of $J$ including $j_n$, or (ii) $j_n$ comes after $i_n$ in $\sigma$.
Now consider the pair $(I',J') \eqdef (I\ssm \{i_n\}, J \ssm \{j_n\})$.
As was the case for the proof that $i_1=1$, we have that $I'$ dominates $J'$ in $\tau$.
To prove that $J'$ dominates $I'$ in $\sigma$, we split by the cases.
In case (i), we may apply condition $(2)$ of \cref{lem:Coherent Domination}.
In case (ii), either $i_n$ comes before~$j_n$, in which case we meet condition $(1)$ of \cref{lem:Coherent Domination}, or $j_n$ comes before $i_n$.
In this last situation, we have that condition $(2)$ of \cref{lem:Coherent Domination} holds as $i_n$ is the leftmost element of~${I\ssm \{i_1,...,i_{n-1}\}}$ in $\sigma$.
Thus, if $w \neq j_n$, by the inductive hypothesis, we match a smaller pattern.

Finally, using statements (a) and (b) above, we can inductively generate $(\sigma,\tau)$, determining $j_1$ via $(a)$, then $i_2$ via $(b)$, then $j_2$ via $(a)$ and so on.
This inductive process fully generates $\sigma$, and places all elements of $\tau$ except $i_1$, yielding $\tau=i_2 j_1 i_3 j_2 \cdots i_k j_{k-1} w j_k w''$.
However, as $j_k$ must be dominated by an element of $I$, this forces $w = i_1$ and $w'' =\varnothing$, completing the proof.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section{Shifts and the lattice of facets}
\label{sec:shifts}

In this section we show that the geometric $\SU$ diagonal $\SUD$ is a topological enhancement of the original Saneblidze-Umble diagonal \cite{SaneblidzeUmble}.
This study leads to a natural lattice structure on the set of facets of operadic diagonals, and to alternative combinatorial descriptions such as a matrix and a cubical representations. 
Throughout this Section, we borrow notation from \cite{SaneblidzeUmble-comparingDiagonals}.

%%%%%%%%%%%%%%%

\subsection{Topological enhancement of the original $\SU$ diagonal}

In this section, we prove that the geometric $\SU$ diagonal $\SUD$ agrees at the cellular level with the original Saneblidze-Umble diagonal defined in \cite{SaneblidzeUmble}.
The proof is technical and proceeds in several steps: we introduce two additional combinatorial descriptions of the diagonal, that we call the $1$-shift and $m$-shift $\SU$ diagonals, and show the sequence of equivalences
\begin{center}
\begin{tikzcd}
\text{original $\SUD$} \arrow[r,leftrightarrow,"\ref{prop:iso-original-shift-diagonals}"]&
\text{$1$-shift $\SUD$} \arrow[r,leftrightarrow,"\ref{prop:iso-1-to-m-shift}"]&
\text{$m$-shift $\SUD$} \arrow[r,leftrightarrow,"\ref{prop:iso-shift-IJ-diagonals}"]&
\text{geometric $\SUD$} .
\end{tikzcd}
\end{center}

%%%%%%%%%%%%%%%

\subsubsection{Strong complementary pairs}

We start by the following definition.

\begin{definition}
\label{def:strong-complementary-pairs}
A \defn{strong complementary pair} (or~\defn{$\SCP$} for short) is a pair $(\sigma,\tau)$ of ordered partitions of $[n]$ where $\sigma$ is obtained from a permutation of $[n]$ by merging the adjacent elements which are decreasing, and $\tau$ is obtained from the same permutation by merging the adjacent elements which are increasing.
\end{definition}

We denote by $\SCP(n)$ the set of $\SCP$s of $[n]$, which is in bijection with the set of permutations of $[n]$.
As is clear from the definition, the intersection graph of a $\SCP$ is a $(2,n)$-partition tree.

\begin{example}
\label{ex:strong-complementary}
The SCP associated to the permutation $3|1|7|4|2|5|6$ is
\begin{center}
	\begin{tikzpicture}[scale=.7]  
		\node (p) at (0, 0) {$13|247|5|6 \times 3|17|4|256$};
		\node[anchor=east] (1) at (-1.5, -1) {$13$};
		\node[anchor=east] (2) at (-1.5, -2) {$247$};
		\node[anchor=east] (3) at (-1.5, -3) {$5$};
		\node[anchor=east] (4) at (-1.5, -4) {$6$};
		%
		\node[anchor=west] (5) at (1.5, -1) {$3$};
		\node[anchor=west] (6) at (1.5, -2) {$17$};
		\node[anchor=west] (7) at (1.5, -3) {$4$};
		\node[anchor=west] (8) at (1.5, -4) {$256$};
		%
		\draw[thick] (1.east) -- (5.west); 
		\draw[thick] (1.east) -- (6.west); 
		\draw[thick] (2.east) -- (6.west); 
		\draw[thick] (2.east) -- (7.west); 
		\draw[thick] (2.east) -- (8.west); 
		\draw[thick] (3.east) -- (8.west); 
		\draw[thick] (4.east) -- (8.west);
		%
	\end{tikzpicture}
\end{center}
Observe that the permutation can be read off the intersection graph of the SCP by a vertical down slice through the edges.
\end{example}

\begin{notation}
	For a $(2,n)$-partition tree $(\sigma,\tau)$, we denote by $\sigma_{i,j}$ (\resp $\tau_{i,j}$) the unique oriented path between blocks $\sigma_{i}$ and $\sigma_j$ (\resp $\tau_{i}$ and $\tau_j$).
\end{notation}
Note that we make a slight abuse in notation, as the path $\sigma_{i,j}$ also depends on $\tau$.
We can immediately characterize the paths between adjacent blocks in $\SCP$s.

\begin{proposition} 
\label{lem:SCP-path-desc}
For any strong complementary pair $(\sigma,\tau)$, we have that
\begin{enumerate}
	\item $ \sigma_{i,i+1} = ( \min \sigma_i, \max \sigma_{i+1} )$ and $\min \sigma_i< \max \sigma_{i+1}$, and
	\item $  \tau_{i,i+1} =  ( \max \tau_i, \min \tau_{i+1} )$ and $\min \tau_{i+1}< \max \tau_{i}$.
\end{enumerate}
As a consequence, all strong complementary pairs are in both $\LAD$ and $\SUD$, and constitute precisely the set of facets $(\sigma,\tau)$ such that $\max_{\b{v}}(\sigma) = \min_{\b{v}}(\tau)$.
\end{proposition}
\begin{proof}
First, the path description of $(\sigma,\tau)$ is a straightforward observation. 
Second, since the minima of these paths are traversed from left to right, and the maxima from right to left, \cref{thm:facet-ordering} implies that strong complementary partitions are in both geometric operadic diagonals~$\LAD$ and~$\SUD$.
Third, the fact that these constitute the facets $(\sigma,\tau) \in \LAD$ or $\SUD$ satisfying $\max_{\b{v}}(\sigma) = \min_{\b{v}}(\tau)$ can be seen as follows.
The maximal (\resp minimal) vertex of a face $\sigma$ of the permutahedron with respect to the weak order, is obtained by ordering the elements of each block of $\sigma$ in decreasing (\resp increasing) order. 
Thus, it is clear that the original permutation giving rise to a $\SCP$ $(\sigma,\tau)$ is the permutation $\max_{\b{v}}(\sigma)=\min_{\b{v}}(\tau)$, for any vector $\b{v}$ inducing the weak order.
Since both diagonals agree with this order on the vertices, we have that $\SCP$s are indeed facets of $\LAD$ and $\SUD$ with the desired property. 
The fact that these are \emph{all} the facets with this property follows from the bijection between $\SCP(n)$ and the permutations of~$[n]$.
\end{proof}


%%%%%%%%%%%%%%%

\subsubsection{$\SU$ diagonals}

We recall the definition of the original $\SU$ diagonal of \cite{SaneblidzeUmble}, based on the description given in \cite{SaneblidzeUmble-comparingDiagonals}.
We introduce two other descriptions, the $1$-shift and $m$-shift $\SU$ diagonals, which will be shown later to be equivalent to the original one.

\begin{definition}
\label{def:subset shifts}
Let $\sigma=\sigma_1|\dots|\sigma_k$ be an ordered partition, and let~$M \subsetneq \sigma_{i}$ be a non-empty subset of the block $\sigma_i$.
For $m\geq 1$, the \defn{right $m$-shift} moves $m$ blocks to the right the subset $M$, \ie
\begin{align*}
	R_M(\sigma) \eqdef \sigma_1 | \dots | \sigma_i \ssm M | \dots | \sigma_{i+m} \cup M | \dots | \sigma_k
\end{align*}
while the \defn{left $m$-shift} moves $m$ blocks to the left the subset $M$, \ie
\begin{align*}
	L_M(\sigma) \eqdef \sigma_1 | \dots | \sigma_{i-m} \cup M | \dots | \sigma_{i} \ssm M | \dots | \sigma_k .
\end{align*}
\end{definition}

\begin{definition}
\label{def:movable-subsets}
Let $\sigma$ denote either one of the two ordered partitions of $[n]$ in a ordered $(2,n)$-partition tree, and let $M \subsetneq \sigma_i$.
The right $m$-shift $R_M$ (\resp the left $m$-shift $L_M$) is 
\begin{enumerate}
	\item \defn{block-admissible} if $\min \sigma_i \notin M$ and $\min M > \max \sigma_{i+m}$ (\resp $\min M > \max \sigma_{i-m}$),
	\item \defn{path-admissible} if $\min M > \max \sigma_{i,i+m}$ (\resp $\min M > \max \sigma_{i,i-m}$).
\end{enumerate}
\end{definition}

\begin{remark}
\label{rem:inverses}
Observe that for a given subset $M$, an inverse to the right $m$-shift $R_M$ (\resp left $m$-shift $L_M$) is given by the left $m$-shift $L_M$ (\resp right $m$-shift $R_M$).
Moreover, one $m$-shift is path-admissible if and only if its inverse is. 
\end{remark}

\begin{example}
Performing the $1$-shifts $R_7$ and $L_{56}$ (they are both block and path admissible) of the strong complementary pair~$(\sigma,\tau)$ of \cref{ex:strong-complementary}, one obtains the pair~$R_{7}(\sigma) \times L_{56}(\tau)$, as illustrated below.
\begin{center}
	\begin{tikzpicture}[scale=.7]  
		\node (p) at (0, 0) {$13|247|5|6 \times 3|17|4|256$};
		\node[anchor=east] (1) at (-1.5, -1) {$13$};
		\node[anchor=east] (2) at (-1.5, -2) {$247$};
		\node[anchor=east] (3) at (-1.5, -3) {$5$};
		\node[anchor=east] (4) at (-1.5, -4) {$6$};
		%
		\node[anchor=west] (5) at (1.5, -1) {$3$};
		\node[anchor=west] (6) at (1.5, -2) {$17$};
		\node[anchor=west] (7) at (1.5, -3) {$4$};
		\node[anchor=west] (8) at (1.5, -4) {$256$};
		%
		\draw[thick] (1.east) -- (5.west); 
		\draw[thick] (1.east) -- (6.west); 
		\draw[thick] (2.east) -- (6.west); 
		\draw[thick] (2.east) -- (7.west); 
		\draw[thick] (2.east) -- (8.west); 
		\draw[thick] (3.east) -- (8.west); 
		\draw[thick] (4.east) -- (8.west);
	\end{tikzpicture}
	\quad
	\raisebox{3.4em}{$\xrightarrow{R_{7} \times L_{56}}$}
	\quad
	\begin{tikzpicture}[scale=.7]  
		\node (p) at (0, 0) {$13|24|57|6 \times 3|17|456|2$};
		\node[anchor=east] (1) at (-1.5, -1) {$13$};
		\node[anchor=east] (2) at (-1.5, -2) {$24$};
		\node[anchor=east] (3) at (-1.5, -3) {$57$};
		\node[anchor=east] (4) at (-1.5, -4) {$6$};
		%
		\node[anchor=west] (5) at (1.5, -1) {$3$};
		\node[anchor=west] (6) at (1.5, -2) {$17$};
		\node[anchor=west] (7) at (1.5, -3) {$456$};
		\node[anchor=west] (8) at (1.5, -4) {$2$};
		%
		\draw[thick] (1.east) -- (5.west); 
		\draw[thick] (1.east) -- (6.west); 
		\draw[thick] (3.east) -- (6.west); 
		\draw[thick] (2.east) -- (7.west); 
		\draw[thick] (2.east) -- (8.west); 
		\draw[thick] (3.east) -- (7.west); 
		\draw[thick] (4.east) -- (7.west);
	\end{tikzpicture}
\end{center}
\end{example}

We shall concentrate on two distinct families of shifts: block-admissible $1$-shifts of subsets of various sizes, and path-admissible $m$-shifts of singletons, for various $m\geq 1$,
and show that specific sequences generate the same diagonal. 

\begin{definition}
\label{def:admissible-shift-sequences}
Let $\sigma$ denote either one of the two ordered partitions of $[n]$ in an ordered $(2,n)$-partition tree, and let~$\b{M} = (M_1,\dots,M_p)$ with $M_1 \subsetneq \sigma_{i_1}, \dots, M_p \subsetneq \sigma_{i_p}$ for some~$p \ge 1$.
Then the sequence of right shifts~$R_\mathbf{M}(\sigma) \eqdef R_{M_p} \dots R_{M_1}(\sigma)$ is 
\begin{enumerate}
	\item \defn{block-admissible} if we have $1\leq i_1 < i_2 < \dots < i_p \leq k-1$, and each $R_{M_j}$ is a block-admissible $1$-shift,
	\item \defn{path-admissible} if each $R_{M_j}$ is a path-admissible $m_j$-shift, for some $m_j \geq 1$.
\end{enumerate}
Admissible sequences of left shifts are defined similarly and are denoted by $L_\mathbf{M}(\tau)$.
\end{definition}

By convention, we declare the empty sequence of shift operators to be admissible, and to act by the identity, \ie we have $R_{\mathbf{\varnothing}}(\sigma)  \eqdef  \sigma$ and $L_{\mathbf{\varnothing}} (\tau) \eqdef  \tau$.

\begin{definition}
\label{def:classical-SU}
The facets of the \defn{original $\SU$ diagonal} (\resp the \defn{$m$-shift $\SU$ diagonal}) are defined by the formula
\begin{align*}
\SUD([n]) = \bigcup_{(\sigma,\tau)} \bigcup_{\mathbf{M}, \mathbf{N}} R_\mathbf{M}(\sigma)\times L_\mathbf{N}(\tau)
\end{align*}
where the unions are taken over all strong complementary partitions $(\sigma, \tau)$ of $[n]$, and over all block-admissible sequences of subset $1$-shifts $\b{M},\b{N}$ (\resp over all path-admissible sequences of singleton $m_j$-shifts, for various $m_j \ge 1$).
\end{definition}

\begin{remark}
	Observe that the left (\resp right) shifts acts on the right (\resp left) ordered partition.
	In the analogous description for the $\LA$ diagonal $\LAD$ obtained at in \cref{subsec:shifts-under-iso}, left and right shifts act on the left and right ordered partitions, respectively.
\end{remark}

\vincent{Change the notations everywhere...}

%%%%%%%%%%%%%%%

\subsubsection{First isomorphism between $\SU$ diagonals}

First, we show that the $m$-shift $\SU$ diagonal is equivalent to the $1$-shift $\SU$ diagonal, which is given by exactly the same definition, but where only $1$-shifts are performed. 

\begin{proposition}
	\label{prop:iso-1-to-m-shift}
	The $1$-shift and $m$-shift $\SU$ diagonals coincide.
\end{proposition}

\begin{proof}
It is clear that any path-admissible sequence of $1$-shifts is a path-admissible sequence of $m$-shifts, and thus that the facets of the $1$-shift $\SU$ diagonal are facets of the $m$-shift $\SU$ diagonal. 
For the reverse inclusion, we need to show that any $m$-shift can be re-expressed as a path-admissible sequence of $1$-shifts. 
We proceed by induction.
For the case $m=1$, there is nothing to prove.
Let $(\sigma,\tau)$ be a pair of ordered partitions in the $m$-shift diagonal. 
Suppose now that for an element $\rho \in \sigma_i$, the right $m$-shift $R_\rho$ is path-admissible, \ie $\rho > \max \sigma_{i,i+m}$.
Since $\sigma_{i,i+m}=\sigma_{i,i+1}\sigma_{i+1,i+m}$ we have that $\max \sigma_{i,i+m}\geq \max \sigma_{i,i+1}$,\Kurt{} which means that the $1$-shift $R_\rho$ is path-admissible.
We will show in \cref{cor:SU-shift-preserves-max} that $1$-shifts conserve the maximal element of paths between adjacent blocks, and its directions.
\Kurt{Need this, probably not worth re-ordering for.}
Consequently, the following $(m-1)$-shift $R_\rho$ is path-admissible, and we can thus apply the induction hypothesis. 
\end{proof}

We will now compare the $1$-shift and original $\SU$ diagonals. 
The key to the equivalence is the following technical result. 

\begin{proposition} 
\label{prop:SU-preserves-max}
Block-admissible sequences of $1$-shifts, defining the original $\SU$ diagonal, conserve 
\begin{enumerate}
	\item the maximal element of any path between two blocks of the same ordered partition,
	\item the direction in which this element is traversed. 
\end{enumerate}
In particular, for a pair of ordered partitions $(R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$ obtained via a block-admissible sequence of $1$-shifts from a strong complementary pair~$(\sigma,\tau)$, we have that
\begin{align}
	\label{eq:max-1}
	\max R_{\mathbf{M}}(\sigma)_{i,j} = \max \sigma_{i,j} \text{ and } \max L_{\mathbf{N}}(\tau)_{i,j} = \max \tau_{i,j}
\end{align}
and consequently that
\begin{align}
	\label{eq:max-2}
	\max R_{\mathbf{M}}(\sigma)_{i,i+1} = \max \sigma_{i+1} \text{ and } \max L_{\mathbf{N}}(\tau)_{i,i+1} = \max \tau_{i}  .
\end{align}
\end{proposition}

\begin{remark}
	Note that in \cref{eq:max-1}, the maxima $\max \sigma_{i,j}$ and $\max \tau_{i,j}$ are maxima of \emph{paths}, while in \cref{eq:max-2} the maxima $\max \sigma_{i+1}$ and $\max \tau_{i}$ are maxima of \emph{blocks}.
\end{remark}

\begin{proof}
We consider the right shift operator; the left shift operator proceeds similarly.
Let us start with Point $(1)$.
As $\SCP$s trivially meet the above conditions, we will prove the result inductively by assuming that the result holds for $(R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$, and then showing that applying a block-admissible operator $R_{M_k}$ conserves the maximal elements of paths.
By the inductive hypothesis, we know that $\max R_{\mathbf{M}}(\sigma)_{k,k+1}= \max \sigma_{k+1}$.
As $R_{M_k}$ is an admissible operator, we know two things: firstly that $\min M_k > \max R_{\mathbf{M}}(\sigma)_{k+1}$, and secondly that $\max \sigma_{k+1} = \max R_{\mathbf{M}}(\sigma)_{k+1}$, as $k$ is greater than the maximal index used by $\mathbf{M}$.
So combining these, we know that
\begin{align}
	\label{eq:shift-subset-dominates}
	\min M_k > \max R_{\mathbf{M}}(\sigma)_{k+1} = \max \sigma_{k+1} = \max R_{\mathbf{M}}(\sigma)_{k,k+1} . 
\end{align}
A key consequence of this inequality is that the intersection graph of $(R_{M_k}R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$ is a bipartite tree conditional on $(R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$ being a bipartite tree: the shift will not disconnect the graph as none of the shifted elements are in the path $R_{\mathbf{M}}(\sigma)_{k,k+1}$. 
So, it is legitimate to speak of unique paths between blocks. 

We now explicitly explore how the shift operator $R_{M_k}$ alters paths. 
Throughout the rest of this proof, we use the following shorthand: we denote by $\delta_{k,k+1} \eqdef  R_{\mathbf{M}}(\sigma)_{k,k+1}$ the path between the $k$\ordinal{} and $(k+1)$\ordinalst{} blocks in $(R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$, and by $\delta_{k+1,k}$ the same path reversed.
Let~$\gamma$ be any path between two blocks of $(R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$, and let~$\gamma'$ be the path between the same blocks, by indices, in $(R_{M_k}R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$. 
There are four cases to consider. 
\begin{enumerate}
\item the path $\gamma$ does not contain an element of $M_k$.
In this case, it is unaffected by the shift, so $\gamma' = \gamma$.
We note that in light of \cref{eq:shift-subset-dominates}, the path $\delta_{k,k+1}$ meets this case. \Kurt{Maybe more natural here, but also a repeat of above so maybe cut sentence.}

\item the path $\gamma$ contains one element $m\in M_k$, \ie it is of the form $\gamma = \alpha m \beta$, with $\alpha$ or $\beta$ possibly empty.
We assume that $m$ is incoming to $R_\mathbf{M}(\sigma)_{k}$, the case when it is outgoing is similar.
We must have $\alpha \cap \delta_{k,k+1}=\varnothing$, since otherwise there would be an oriented loop from $R_\mathbf{M}(\sigma)_{k}$ to itself.
For the same reason, $\beta \cap \delta_{k,k+1}$ must be connected and starting at $R_\mathbf{M}(\sigma)_{k}$.
Then there are two cases to consider:
	\begin{enumerate}
	\item the path $\beta$ does not use any steps of $\delta_{k,k+1}$, in which case $\gamma' = \alpha m \delta_{k+1,k} \beta$.
	This is a path in the tree of $(R_{M_k}R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$ with no repeated steps, as such it must be the unique minimal path. 

	\item the path $\beta$ uses steps of $\delta_{k,k+1}$, in which case $\gamma' = \alpha m (\delta_{k+1,k}\ssm \beta)(\beta \ssm \delta_{k+1,k})$.
	This follows, as we know that $\beta$ must follow the path $\delta_{k,k+1}$ for some time before diverging ($\beta$ could also be a subset of $\delta_{k,k+1}$, in which case it will never diverge).
	As such, the path $(\delta_{k+1,k}\ssm \beta)$ reaches the point of divergence from $R_{\mathbf{M}}(\sigma)_{k+1}$ instead of $R_{\mathbf{M}}(\sigma)_{k}$, and the path $(\beta \ssm \delta_{k+1,k})$ completes the rest of the route unchanged.
	\end{enumerate}

\item the path $\gamma$ contains two elements of $M_k$. 
In this case we still have $\gamma'=\gamma$ (in path elements) but $\gamma'$ will step through the $(k+1)$\ordinalst{} block instead of $\gamma$ stepping through the $k$\ordinal{} block.

\item the path $\gamma$ contains more than two elements of $M_k$. 
This is impossible, as $\gamma$ would not be a minimal path on a tree.

\end{enumerate}
Observe that all (non-trivial or non-contradictory) paths $\gamma'$ contain $m \geq \min M_k$ and either some addition or deletion by $\delta_{k,k+1}$.
It thus follows from \cref{eq:shift-subset-dominates} that $\max \gamma' = \max \gamma$: in each case, the maximal element will either be $m$, or in $\alpha$, or in $\beta$.
This finishes the proof of Point (1).

For Point (2), we need to see that the maximal element $\max \gamma = \max \gamma'$ is traversed in the same direction.
It is immediate for cases (1), (2a) and (3); the condition is empty in the case~(4).
For the case (2b) it follows from the observation that the number of steps of $\beta \cap \delta_{k,k+1}$ and~$\delta_{k,k+1} \ssm \beta$ have the same parity: since~$\delta_{k,k+1}$ has an even number of steps, either they both have an even number of steps, or an odd number, which completes the proof.
\end{proof}

\begin{corollary} 
\label{cor:SU-shift-preserves-max}
Path-admissible sequences of $m$-shifts, defining the $m$-shift $\SU$ diagonal, conserve 
\begin{enumerate}
	\item the maximal element of any path between two blocks of the same ordered partition,
	\item the direction in which this element is traversed. 
\end{enumerate}
In particular, if a pair of ordered partitions $(\sigma',\tau')$ is generated from a strong complementary pair~$(\sigma,\tau)$ by path-admissible $m$-shifts, then we have
\begin{align}
	\label{eq:max-3}
	\max \sigma'_{i,i+m} = \max \sigma_{i+m} \text{ and } \max \tau'_{i,i+m} = \max \tau_{i} .
\end{align}
\end{corollary}

\begin{proof}
By \cref{prop:iso-1-to-m-shift}, it suffices to treat the case of $1$-shifts. 
By definition of the path-admissible $1$-shifts, \cref{eq:shift-subset-dominates} holds, and we can run the proof of \cref{prop:SU-preserves-max} \emph{mutatis mutandis}.
\end{proof}

We have now dropped the assumption that $\min M_k > \max R_{\mathbf{M}}(\sigma)_{k+1}$, and the assumption that we need to perform shifts in an increasing order; once this is done, we can generate all subset shifts by chains of singleton set shifts.

\begin{theorem}
\label{prop:iso-original-shift-diagonals}
The original and $m$-shift $\SU$ diagonals coincide.
\end{theorem}

\begin{proof}
\vincent{Change the notations in this proof}
Since $m$-shift and $1$-shift diagonals are equivalent (\cref{prop:iso-1-to-m-shift}), it suffices to show that the $1$-shift and original $\SU$ diagonals coincide. 
We analyze the right shift operator, the case of the left shift is similar. 
First, we observe that any block-admissible right shift $R_{M_k}(\sigma)$ can be decomposed into a series of singleton right shifts: since $\min M_k > \max \sigma_{k,k+1}$ by the proof of \cref{prop:SU-preserves-max}, we can shift the elements of $M_k$ to the right, one after the other (in any order!).
This shows that any facet of the original $\SU$ diagonal is also a facet in the $1$-shift $\SU$ diagonal.

For the reverse inclusion, we proceed by induction. 
We are required to show that if we apply a right $1$-shift to $(R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$, say $(R_{\rho}R_{\mathbf{M}}(\sigma),L_{\mathbf{N}}(\tau))$, then this can be re-expressed as a well-defined subset shift operation $(R_{\mathbf{M'}}(\sigma),L_{\mathbf{N}}(\tau))$. 
Suppose that prior to the $1$-shift, the element $\rho$ lives in block $l$, then we must have
\begin{align*}
	1 \leq i_1 < \dots < i_j \leq l < i_{j+1} <\dots< i_p \leq k-1
\end{align*}
for some $j$. 
If $i_j < l$, then we have $R_{\rho}R_{\mathbf{M}}(\sigma) = R_{M_{i_p}}\dots R_{\{\rho\}_{l}}R_{M_{i_j}}\dots R_{M_{i_1}}(\sigma)$, and we are done.
Otherwise, if $i_j = l$, we set $M'_{i_j} \eqdef M_{i_j} \cup \{\rho \}$. 
It is clear that we have $R_{\rho}R_{\mathbf{M}}(\sigma) = R_{M_{i_p}}\dots R_{M'_{i_j}}\dots R_{M_{i_1}}(\sigma)$, however, we need to check that $R_{M'_{i_j}}$ is block-admissible. 
That is, we need to check that $\min M_{i_j}' > \max (R_{M_{i_{j-1}}}\dots R_{M_{i_1}}(\sigma))_{i_j+1}$.
If we have~$\rho > \min M_{i_j}$, then we are done since in this case $\min M_{i_j}'=\min M_{i_j}$ and $R_{M_{i_j}}$ is block-admissible.
Otherwise, we have that $\rho=\min M_{i_j}'$. 
Since by definition block-admissible shift operators do not move the minimal element of a block, we have that $\rho > \min R_{\mathbf{M}}(\sigma)_{i_j}= \min (R_{M_{i_{j-1}}}\dots R_{M_{i_1}}(\sigma))_{i_j}$.
Then, using the induction hypothesis, \cref{prop:SU-preserves-max} shows that $\rho>\max \sigma_{i_j+1} = \max (R_{M_{i_{j-1}}}\dots R_{M_{i_1}}(\sigma))_{i_j + 1}$, where the equality follows as $i_1<\dots<i_{j-1}<i_j$. 
This proves that $R_{M'_{i_j}}$ is block-admissible, completing the inductive proof.
\end{proof}

\Kurt{Finished proof reading to here.}

%%%%%%%%%%%%%%%

\subsubsection{Inversions}

Our next goal is to prove the equivalence between the $m$-shift and geometric $\SU$ diagonals (\cref{prop:iso-shift-IJ-diagonals}).
As a tool for this proof, we study here \emph{inversions}, or crossings in the partition trees of the geometric $\SU$ diagonal.
In addition, we shall see later (\cref{sec:Shift-lattice}) that these inversions are compatible with a lattice structure on the set of facets. 

\begin{definition}
Let $(\sigma,\tau)$ be a pair of ordered partitions of $[n]$, we say that $(x,y)$, where $x<y$, is an \defn{inversion} if $x$ appears before $y$ in $\sigma$ and $y$ appears before $x$ in $\tau$. 
\end{definition}

\begin{remark}
	If $(\sigma,\tau)$ is a pair of permutations, the inversions of $(\sigma,\tau)$ are the classical inversions of $\tau$ which are not inversions of $\sigma$. 
	In particular, if $\sigma$ is the identity permutation, then the inversions of $(\sigma,\tau)$ coincide with the classical inversions of $\tau$. 
\end{remark}

\begin{proposition}
\label{p:crossings}
The set of inversions of a facet of the geometric $\SU$ diagonal facet is in bijection with its set of edge crossings. 
Moreover, under this bijection strong complementary pairs correspond to facets with no crossings.
\end{proposition}

\begin{proof}
For the first part of the statement, it is clear that every inversion gives rise to a crossing. 
For the converse, one needs to check that an anti-inversion, where $y$ appears before $x$ in $\sigma$ and $x$ appears before $y$ in $\tau$, cannot occur in a facet of the geometric $\SUD$; this follows immediately from the $(I,J)$-conditions for $|I|=|J|=1$. 
The second part of the statement follows from the fact that facets of the diagonal with no crossings are in bijection with permutations.
As explained above, from a partition one obtains a strong complementary pair, which is in the geometric $\SUD$. 
In the other way around, given a strong complementary pair, one can read-off the partition in the associated tree, which has no crossings, by a vertical down-slice of edges, see \cref{ex:strong-complementary}.
\end{proof}

We say that an edge crossing is an \defn{adjacent crossing} if the two crossing elements are in adjacent blocks of the partition tree (\ie they are of the form $\sigma_i|\sigma_{i+1}$ or $\tau_i|\tau_{i+1}$).

\begin{lemma}
\label{lem:adjacent-crossing}
A facet $(\sigma,\tau)$ of the geometric $\SU$ diagonal has a crossing if and only if it has an adjacent crossing.
\end{lemma}

\begin{proof}
An adjacent crossing is clearly a crossing. 
In the other direction, suppose there is a crossing between an element of $\sigma_i$ and an element of $\sigma_j$. 
If $\sigma_i$ and $\sigma_j$ are not adjacent, then the ``triangle" produced by the crossing elements encloses other $\sigma_k$ such that $i<k<j$, and this produces other crossings. We may repeat this process until an adjacent crossing is found.
\end{proof}

\Guillaume{Add example of inversions and picture of crossings?}

%%%%%%%%%%%%%%%

\subsubsection{Second isomorphism between $\SU$ diagonals}
\label{sec:Iso m-shifts to IJ}

We now aim at showing that the $m$-shift and the geometric $\SU$ diagonal coincide (\cref{prop:unique-operad}).
Recall from \cref{rem:inverses} that left and right path-admissible $m$-shifts are inverses to one another. 

\begin{proposition} 
\label{lem:IJ-closed-under-shifts}
Let $(\sigma,\tau)$ be a facet of the geometric $\SU$ diagonal $\SUD$.
Then,
\begin{enumerate}
\item any pair of ordered partitions obtained by applying a path-admissible $m$-shift to $(\sigma,\tau)$ is also in the geometric $\SU$ diagonal,
\item applying a path-admissible $m$-shift defining the $m$-shift $\SU$ diagonal strictly increases the number of inversions of $(\sigma,\tau)$.
Dually, applying inverse $m$-shifts strictly decreases the number of inversions.
\end{enumerate}
\end{proposition}

\begin{proof}
We consider a right path-admissible shift $R_\rho$ for the primary statement, the left shift and dual result proceeds similarly. 
By \cref{cor:SU-shift-preserves-max}, we have that the maxima of paths between consecutive vertices in $(R_{\rho}(\sigma),\tau)$ are the same as the ones in $(\sigma,\tau)$, and are moreover traversed in the same direction.
Thus, all maxima of paths in $(R_{\rho}(\sigma),\tau)$ are traversed from right to left, and hence by \cref{thm:facet-ordering}, we have that $(R_{\rho}(\sigma),\tau)$ is in the geometric $\SU$ diagonal, which proves Point (1).
For Point (2), we observe that the $(I,J)$ conditions for $|I|=|J|=1$ (\cref{p:minimal}) imply that $\rho$ must appear before $\min \sigma_i$ in $\tau$; as a result, after the $m$-shift these two edges will create a new intersection.
\end{proof}

\begin{lemma}
\label{lem:inverse-to-SCP}
Any facet $(\sigma,\tau)$ of the geometric $\SU$ diagonal $\SUD$ is mapped to a strong complementary pair by a path-admissible sequence of inverse $m$-shifts.
\end{lemma}

\begin{proof}
Since the number of inversions of a pair of ordered partitions $(\sigma,\tau)$ in the geometric $\SU$ diagonal is finite, we will only be able to apply a finite chain of inverse shift operators to it before no further operations are available. 
It thus remains to show that for any pair $(\sigma,\tau)$ which is not a strong complementary one, performing a path-admissible inverse $m$-shift is possible. 
We consider the following cases, illustrated in \cref{ex:proof-inverse-shift}.
\begin{enumerate}
	\item All adjacent blocks are connected by paths of length $2$.
	\item There exist adjacent blocks which are connected by a path of length $2k$ for $k>1$.
	\begin{enumerate}
		\item The maximal step of this path is not the last step.
		\item The maximal step of this path is the last step.
		\begin{enumerate}
			\item The $\tau$ block containing the maximal step is not the greatest block.
			\item The $\tau$ block containing the maximal step is the greatest block.
		\end{enumerate}
	\end{enumerate}
\end{enumerate}
In Case $(1)$, if the facet $(\sigma,\tau)$ is not a $\SCP$ then it must have a crossing, and hence an adjacent crossing by \cref{lem:adjacent-crossing}. 
This adjacent crossing is of the following form (we illustrate the case where the crossing happens on the left, the case when it happens on the right is similar): 
\begin{center}
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_i$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i+1}$};
%
\node[anchor=west] (4) at (1.5, -1) {$\tau_j$};
\node[anchor=west] (5) at (1.5, -2) {$\tau_{k}$};
%
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (5.west);
\draw[thick] (2.east) -- (4.west);
\node (6) at (0.9, -0.8) {$\rho$};
\node (7) at (0, -2.3) {$b$};
\node (8) at (-0.9, -0.8) {$c$};
\end{tikzpicture}
\quad
\raisebox{1.9em}{$\xrightarrow{R^{-1}_{\rho}}$}
\quad
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_i \sqcup \rho$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i+1}\ssm \rho$};
%
\node[anchor=west] (4) at (1.5, -1) {$\tau_j$};
\node[anchor=west] (5) at (1.5, -2) {$\tau_{k}$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west);
\draw[thick] (2.east) -- (5.west);
\node (6) at (0.9, -0.75) {$\rho$};
\node (7) at (0, -2.3) {$b$};
\node (8) at (-0.9, -1.45) {$c$};
\end{tikzpicture}
\end{center}
By definition of the geometric $\SU$ diagonal, the fact that $\tau_j < \tau_k$ implies that $\rho > b$, and the fact that $\sigma_i < \sigma_{i+1}$ implies that $b>c$.
Thus, we have $\rho > \max \sigma_{i,i+1}$ which implies that a path-admissible left shift $R_\rho^{-1}$ can be performed.

In Case $(2.a)$, consider the two adjacent blocks say $\sigma_i|\sigma_{i+1}$ (the $\tau$ case is similar), let $\rho \eqdef \max \sigma_{i,i+1}$ denote the maximum of the path between them, and let $m\geq 1$ be such that $\rho$ steps into $\sigma_{i+1+m}$. 
Since $\max \sigma_{i,i+1+m} = \max \sigma_{i,i+1}= \rho$ the definition of the geometric $\SU$ diagonal implies that the block $\sigma_{i+1+m}$ comes after the block $\sigma_{i}$, and by assumption after the block $\sigma_{i+1}$. 
Thus, we know that $m > 1$, and using dashed lines to denote paths of length $\geq 1$ we have the following picture
\begin{center}
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_i$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i+1}$};
\node[anchor=east] (3) at (-1.5, -3) {$\sigma_{i+1+m}$};
%
\node[anchor=west](4) at (1.5, -1) {$\hphantom{.}$};
\node[anchor=west](5) at (1.5, -2) {$\hphantom{.}$};
%
\draw[thick,dashed] (1.east) -- (4.west); 
\draw[thick,dashed] (2.east) -- (5.west);
\draw[thick] (3.east) -- (4.west);
\draw[thick,dashed] (3.east) -- (5.west);
%
\node (6) at (1.3, -1.4) {$\rho$};
\end{tikzpicture}
\raisebox{2.15em}{$\xrightarrow{R^{-1}_{\rho}}$}
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_i$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i+1}\sqcup \rho$};
\node[anchor=east] (3) at (-1.5, -3) {$\sigma_{i+1+m}\ssm \rho$};
%
\node[anchor=west] (4) at (1.5, -1) {$\hphantom{.}$};
\node[anchor=west] (5) at (1.5, -2) {$\hphantom{.}$};
%
\draw[thick,dashed] (1.east) -- (4.west); 
\draw[thick,dashed] (2.east) -- (5.west);
\draw[thick] (2.east) -- (4.west);
\draw[thick,dashed] (3.east) -- (5.west);
%
\node (6) at (1.3, -1.4) {$\rho$};
\end{tikzpicture}
\end{center}
As we have $\rho=\max \sigma_{i,i+1} > \max\sigma_{i+1+m,i+1}$, an inverse $m$-shift operation can be performed.

In the Case $(2.b.i)$, there exists $j,m>0$ such that $\tau_{j-m}$ is the block of $\tau$ which contains the maximal element $\rho$, and $\tau_j$ is any greater block on the path from $\sigma_i$ to $\sigma_{i+1}$. 
Then we may apply the following inverse $m$-shift operator.
\begin{center}
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_i$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i+1}$};
\node[anchor=east] (3) at (-1.5, -3) {$\sigma_{i+1+m}$};
%
\node[anchor=west] (4) at (1.5, -1) {$\tau_{j-m}$};
\node[anchor=west] (5) at (1.5, -2) {$\tau_j$};
%
\draw[thick,dashed] (1.east) -- (4.west); 
\draw[thick,dashed] (1.east) -- (5.west);
\draw[thick,dashed] (2.east) -- (5.west);
\draw[thick] (3.east) -- (4.west);
%
\node (6) at (-0.5, -2.8) {$\rho$};
\end{tikzpicture}
\raisebox{2.15em}{$\xrightarrow{L_\rho^{-1}}$}
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_i$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i+1}$};
\node[anchor=east] (3) at (-1.5, -3) {$\sigma_{i+1+m}$};
%
\node[anchor=west] (4) at (1.5, -1) {$\tau_{j-m}\ssm \rho$};
\node[anchor=west] (5) at (1.5, -2) {$\tau_j \sqcup \rho$};
%
\draw[thick,dashed] (1.east) -- (4.west); 
\draw[thick,dashed] (1.east) -- (5.west);
\draw[thick,dashed] (2.east) -- (5.west);
\draw[thick] (3.east) -- (5.west);
%
\node (6) at (0.3, -2.8) {$\rho$};
\end{tikzpicture}
\end{center}

There remains to be treated Case $(2.b.ii)$.
We consider the path $\sigma_{i,i+1} \eqdef (i_1,j_1,i_2,...,i_{k},\rho)$ to be of length $2k$, $k>1$. 
We denote by $\tau_j$ the block of $\tau$ containing the maximal step $\rho$ of this path, which by hypothesis is the last block of $\tau$. 
Let $\sigma_{i-n}$ be the last block of $\sigma$ which is attained by the path $\sigma_{i,i+1}$ before the block $\sigma_{i+1}$. 
We must have $n>1$, since $\rho$ is the last step and $\sigma_i|\sigma_{i+1}$ are adjacent blocks.
The situation can be pictured as on the left.
\begin{center}
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_{i-n}$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i}$};
\node[anchor=east] (3) at (-1.5, -3) {$\sigma_{i+1}$};
%
\node[anchor=west] (4) at (1.5, -1) {$\tau_{j-m}$};
\node[anchor=west] (5) at (1.5, -2) {$\tau_j$};
%
\draw[thick,dashed] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west);
\draw[thick,dashed] (2.east) -- (4.west);
\draw[thick] (3.east) -- (5.west);
%
\node (6) at  (1.1, -2.5) {$\rho$};
\node (7) at  (1.1, -1.5) {$i_k$};
\end{tikzpicture}
\raisebox{2.15em}{$\xrightarrow{L_{\rho'}^{-1}}$}
\begin{tikzpicture}[scale=.6]  
\node[anchor=east] (1) at (-1.5, -1) {$\sigma_{i-n}$};
\node[anchor=east] (2) at (-1.5, -2) {$\sigma_{i}$};
\node[anchor=east] (3) at (-1.5, -3) {$\sigma_{i+1}$};
%
\node[anchor=west] (4) at (1.5, -1) {$\tau_{j-m}\ssm \rho'$};
\node[anchor=west] (5) at (1.5, -2) {$\tau_j \sqcup \rho'$};
%
\draw[thick,dashed] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west);
\draw[thick,dashed] (2.east) -- (5.west);
\draw[thick] (3.east) -- (5.west);
%
\node (6) at  (1.1, -2.5) {$\rho$};
\node (7) at  (1.1, -1.5) {$i_k$};
\end{tikzpicture}
\end{center}
Now let $\rho' \eqdef \max\sigma_{i,i-n}$ be the maximum of the path $\sigma_{i,i-n}=(i_1,j_1,i_2,...,i_{k-1},j_{k-1})$, and let~$\tau_{j-m}$, $m\geq 1$ be the block of $\tau$ containing $\rho'$.
We want to show that an inverse left $m$-shift can bring $\rho'$ back to $\tau_j$.  
We just need to show that $\rho' > i_k$, since the path $\tau_{j-m,j}$ is a subset of the path $\sigma_{i,i+1}$. 
This would imply that both $\rho' > \max \tau_{j-m,j}$ and $\rho' > i_k \geq \min \tau_j$, and thus that an inverse left shift $L_{\rho'}^{-1}$ can be performed.
To see that this is indeed the case, it suffices to look at the last steps $$\tau_l \overset{j_{k-1}}{\longrightarrow} \sigma_{i-n} \overset{i_{k}}{\longrightarrow} \tau_j \overset{\rho}{\longrightarrow} \sigma_{i+1}$$ of the path $\sigma_{i,i+1}$. 
By the definition of the geometric $\SU$ diagonal, the fact that $\tau_l < \tau_j$ implies that $j_{k-1} > i_k$, and thus that $\rho' > i_k$, which finishes the proof. 
\end{proof}

\begin{example}
\label{ex:proof-inverse-shift}
Here are examples of each of the cases in the proof of \cref{lem:inverse-to-SCP}. 
We display cases $(1)$, $(2.a)$, $(2.b.i)$ and, $(2.b.ii)$ respectively, reading the diagrams from top-left to bottom-right. 

\begin{center}
\begin{tikzpicture}[scale=.6,xscale=0.8]  
\node[anchor=east] (1) at (-1.5, -1) {$1$};
\node[anchor=east] (2) at (-1.5, -2) {$23$};
%
\node[anchor=west] (4) at (1.5, -1) {$3$};
\node[anchor=west] (5) at (1.5, -2) {$12$};
%
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (5.west);
\draw[thick] (2.east) -- (4.west);
\end{tikzpicture}
\quad
\raisebox{1.3em}{$\xrightarrow{R^{-1}_{3}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.8]  
\node[anchor=east] (1) at (-1.5, -1) {$13$};
\node[anchor=east] (2) at (-1.5, -2) {$2$};
%
\node[anchor=west] (4) at (1.5, -1) {$3$};
\node[anchor=west] (5) at (1.5, -2) {$12$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west);
\draw[thick] (2.east) -- (5.west);
\end{tikzpicture}
,
\begin{tikzpicture}[scale=.6,xscale=0.8] 
\node[anchor=east] (1) at (-1.5, -1) {$1$};
\node[anchor=east] (2) at (-1.5, -2) {$2$};
\node[anchor=east] (3) at (-1.5, -3) {$34$};
%
\node[anchor=west] (4) at (1.5, -1) {$14$};
\node[anchor=west] (5) at (1.5, -2) {$23$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (2.east) -- (5.west); 
\draw[thick] (3.east) -- (4.west);
\draw[thick] (3.east) -- (5.west);
\end{tikzpicture}
\quad
\raisebox{2.15em}{$\xrightarrow{R^{-1}_{4}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.8]  
\node[anchor=east] (1) at (-1.5, -1) {$1$};
\node[anchor=east] (2) at (-1.5, -2) {$24$};
\node[anchor=east] (3) at (-1.5, -3) {$3$};
%
\node[anchor=west] (4) at (1.5, -1) {$14$};
\node[anchor=west] (5) at (1.5, -2) {$23$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (2.east) -- (4.west);
\draw[thick] (2.east) -- (5.west);
\draw[thick] (3.east) -- (5.west);
\end{tikzpicture}
\end{center}
\begin{center}
\begin{tikzpicture}[scale=.6,xscale=0.8]    
\node[anchor=east] (1) at (-1.5, -1) {$13$};
\node[anchor=east] (2) at (-1.5, -2) {$2$};
\node[anchor=east] (3) at (-1.5, -3) {$4$};
%
\node[anchor=west] (4) at (1.5, -1) {$34$};
\node[anchor=west] (5) at (1.5, -2) {$12$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (5.west); 
\draw[thick] (3.east) -- (4.west);
\end{tikzpicture}
\quad
\raisebox{2.15em}{$\xrightarrow{L^{-1}_{4}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.8]    
\node[anchor=east] (1) at (-1.5, -1) {$13$};
\node[anchor=east] (2) at (-1.5, -2) {$2$};
\node[anchor=east] (3) at (-1.5, -3) {$4$};
%
\node[anchor=west] (4) at (1.5, -1) {$3$};
\node[anchor=west] (5) at (1.5, -2) {$124$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (5.west); 
\draw[thick] (3.east) -- (5.west);
\end{tikzpicture}
,
\begin{tikzpicture}[scale=.6,xscale=0.8]   
\node[anchor=east] (1) at (-1.5, -1) {$12$};
\node[anchor=east] (2) at (-1.5, -2) {$3$};
\node[anchor=east] (3) at (-1.5, -3) {$4$};
%
\node[anchor=west] (4) at (1.5, -1) {$23$};
\node[anchor=west] (5) at (1.5, -2) {$14$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west);
\draw[thick] (2.east) -- (4.west);
\draw[thick] (3.east) -- (5.west);
\end{tikzpicture}
\quad
\raisebox{2.15em}{$\xrightarrow{L^{-1}_{3}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.8]    
\node[anchor=east] (1) at (-1.5, -1) {$12$};
\node[anchor=east] (2) at (-1.5, -2) {$3$};
\node[anchor=east] (3) at (-1.5, -3) {$4$};
%
\node[anchor=west] (4) at (1.5, -1) {$2$};
\node[anchor=west] (5) at (1.5, -2) {$134$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west);
\draw[thick] (2.east) -- (5.west);
\draw[thick] (3.east) -- (5.west);
\end{tikzpicture}
\end{center}
Note that, as we have chosen minimal illustrative examples, each inverse $m$-shift is an inverse $1$-shift, and after each shift we obtain a $SCP$. 
This is not typically the case.
\end{example}

\begin{theorem} 
\label{prop:iso-shift-IJ-diagonals}
The $m$-shift and the geometric $\SU$ diagonals coincide.
\end{theorem}

\begin{proof}
We first note that $\SCP$s are known elements of both the $m$-shift and the geometric $\SU$ diagonals (\cref{lem:SCP-path-desc}).
The proof that every facet of the $m$-shift $\SUD$ is in geometric $\SUD$ follows from the closure of $\SUD$ under the shift operators (\cref{lem:IJ-closed-under-shifts}).
The proof that every facet of geometric $\SUD$ is in shift $\SUD$ follows from the closure of $\SUD$ under the inverse shift operator (\cref{lem:IJ-closed-under-shifts}) and the fact that every facet is sent to a $\SCP$ after a finite number of inverse shifts (\cref{lem:inverse-to-SCP}).
In particular, for any given facet in geometric $\SUD$, this provides a $\SCP$ and a sequence of shifts to form it, showing it is a facet of shift $\SUD$.
\end{proof}

Combining \cref{prop:iso-original-shift-diagonals} and \cref{prop:iso-shift-IJ-diagonals} we obtain the desired equivalence between the original $\SU$ diagonal from \cite{SaneblidzeUmble} and the geometric $\SU$ diagonal from \cref{def:LA-and-SU}.

\begin{theorem}
\label{thm:recover-SU}
The original and geometric $\SU$ diagonals coincide.
\end{theorem}

%%%%%%%%%%%%%%%

\subsection{Shifts under the face poset isomorphism}
\label{subsec:shifts-under-iso}

Now that we have the equivalence between the original and geometric $\SU$ diagonals in hand, we can use the face poset isomorphisms between the geometric $\LA$ and $\SU$ diagonals from \cref{subsec:isos-LA-SU} to translate results and combinatorial descriptions from one to the other. 
Under the isomorphism $t(r\times r):\LAD\to\SUD$ from \cref{rem:Alternate Isomorphism}, we get a straighforward analogue of \cref{def:SU-admissible} for the $\LA$ diagonal.
Specifically, the morphism $r \times r$ exchanges $\max$ and $\min$, giving the following ``dual" notions of admissibility.

\begin{definition}
\label{def:LA-admissible}
Let $\sigma$ denote either one of the two ordered partitions of $[n]$ in a $(2,n)$-partition tree, and let $M_i \subsetneq \sigma_i$.
The right $m$-shift $R_{M_i}$ (\resp. the left $m$-shift $L_{M_{i}}$) is 
\begin{enumerate}
	\item \defn{block-admissible} if $\max \sigma_i \notin M_i$ and $\max M_i < \min \sigma_{i+m}$ (\resp $\max M_{i} < \min \sigma_{i-m}$),
	\item \defn{path-admissible} if $\max M_i< \min \sigma_{i,i+m}$ (\resp $\max M_{i} < \min \sigma_{i,i-m}$).
\end{enumerate}
\end{definition}

Admissible sequence of shifts are defined similarly (simply replace $\sigma$ with $\tau$ in \cref{def:admissible-shift-sequences}).
The morphism $t$ permutes the terms, providing the following analogue of \cref{def:classical-SU} for the $\LA$ diagonal. 

\begin{proposition}
\label{def:classical-LA}
The facets of the $\LA$ diagonal are given defined by the formula
\begin{align*}
\LAD([n]) = \bigcup_{(\sigma,\tau)} \bigcup_{\mathbf{M}, \mathbf{N}} L_\mathbf{M}(\sigma)\times R_\mathbf{N}(\tau)
\end{align*}
where the unions are taken over all strong complementary partitions $(\sigma, \tau)$ of $[n]$, and over all block-admissible sequences of subset $1$-shifts $\b{M},\b{N}$, or over all path-admissible sequences of $1$-shifts, or over all path-admissible sequences of singleton $m$-shifts, for various $m\geq 1$.
\end{proposition}

It turns out that the isomorphism $t(r \times r)$ between the $\LA$ and $\SU$ diagonals has the agreable property of sending left shifts to left shifts, and right shifts to right shifts. 

\begin{proposition} 
\label{prop:trr is an isomorphism of shifts}
Let $(\sigma,\tau) \in \LAD$.
For each type of $\LA$ shift, let $\b{M},\b{N}$ be admissible sequences of this type, then 
\begin{align*}
	t(r,r)(L_\mathbf{N}(\sigma), R_\mathbf{M}(\tau)) = (R_{r\mathbf{M}}(r\tau), L_{r\mathbf{N}}(r\sigma))
\end{align*}
where $r\mathbf{M} \eqdef (rM_{i_1},...,rM_{i_p})$ and $r\mathbf{N}$ (defined similarly) are admissible sequences of $\SU$ shifts of the same type.
\end{proposition}
\begin{proof}
As reversing the elements then shifting them is the same as shifting the elements then reversing them,
it is clear that the equality holds if $r\mathbf{M},r\mathbf{N}$ are admissible sequences of $\SU$ shifts.
As such, we must simply verify the admissibility, and given the equivalence of the various shift definitions, we just do this for path-admissibility of $1$-shifts.
Consider a right shift $R_{M_i}$ which is path-admissible in the $\LA$ sense (\cref{def:LA-admissible}). 
Then, we have that $\max \sigma_i \notin M_i$ implies that $ \min r\sigma_i \not \in r M_i$ and $\max M_i < \min \sigma_{i+m}$  implies that $\min r M_i > \max r \sigma_{i+m}$, and thus the right shift $R_{rM_i}$ is path-admissible in the $\SU$ sense (\cref{def:SU-admissible}).
Here, $rM_i \in r\sigma_i$ is interpreted as being in a block of the right partition ($\tau$ in the notation of the definition).
So, if $\mathbf{M} = (M_{i_1},...,M_{i_p})$, define $r(\mathbf{M}) \eqdef (rM_{i_1},...,rM_{i_p})$, and from the prior it is clear this is a path-admissible sequence of $\SU$ shifts, finishing the proof.
\end{proof}

\begin{remark}
The isomorphism $rs\times rs:\LAD \to \SUD$ identified in \cref{thm:bijection-operadic-diagonals}, also sends shifts operators to shift operators, but it sends left shift operators to right shift operators and vice versa.
The $\LA^{op}$ and $\SU^{op}$ diagonals also admit obvious dual shift descriptions.
\end{remark}

We now explore in example how the isomorphism $t(r\times r)$ translates the shift operators.

\begin{example} 
	\label{ex:shift translation by theta}
The isomorphism $t(r\times r)$ sends the $\SCP$ $(\sigma,\tau)  \eqdef  (5|17|4|236,57|146|3|2)$ to the $\SCP$ $(\sigma',\tau')  \eqdef  (13|247|5|6,3|17|4|156)$. 
The corresponding $(2,n)$-partition trees present a clear symmetry
\begin{center}
\begin{tikzpicture}[scale=.7]  
\node[anchor=east] (1) at (-1.5, -1) {$5$};
\node[anchor=east] (2) at (-1.5, -2) {$17$};
\node[anchor=east] (3) at (-1.5, -3) {$4$};
\node[anchor=east] (4) at (-1.5, -4) {$236$};
%
\node[anchor=west] (5) at (1.5, -1) {$57$};
\node[anchor=west] (6) at (1.5, -2) {$146$};
\node[anchor=west] (7) at (1.5, -3) {$3$};
\node[anchor=west] (8) at (1.5, -4) {$2$};
%
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (5.west); 
\draw[thick] (2.east) -- (6.west); 
\draw[thick] (3.east) -- (6.west); 
\draw[thick] (4.east) -- (6.west); 
\draw[thick] (4.east) -- (7.west); 
\draw[thick] (4.east) -- (8.west);
%
\end{tikzpicture}
\raisebox{3.4em}{$\xrightarrow{t(r\times r)}$}
\begin{tikzpicture}[scale=.7]  
\node[anchor=east] (1) at (-1.5, -1) {$13$};
\node[anchor=east] (2) at (-1.5, -2) {$247$};
\node[anchor=east] (3) at (-1.5, -3) {$5$};
\node[anchor=east] (4) at (-1.5, -4) {$6$};
%
\node[anchor=west] (5) at (1.5, -1) {$3$};
\node[anchor=west] (6) at (1.5, -2) {$17$};
\node[anchor=west] (7) at (1.5, -3) {$4$};
\node[anchor=west] (8) at (1.5, -4) {$256$};
%
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (5.west); 
\draw[thick] (2.east) -- (6.west); 
\draw[thick] (3.east) -- (6.west); 
\draw[thick] (4.east) -- (6.west); 
\draw[thick] (4.east) -- (7.west); 
\draw[thick] (4.east) -- (8.west);
%
\end{tikzpicture}
\end{center}
We now illustrate all possible $\LA$ singleton $1$-shifts of $(\sigma,\tau)$ and all possible $\SU$ singleton $1$-shifts of $(\sigma',\tau')$. 
We first display how the $\LA$ left shifts act on $\sigma$, and the $\SU$ left shifts act on $\tau'$.
The $LA$ shifts have been drawn so that the leftmost arrow shifts the smallest element, and the $SU$ shifts have been drawn so that the leftmost arrow shifts the largest element.
As such, the face poset isomorphism $t(r\times r)$ directly translates one diagram to the other.
The specific element being shifted can be inferred by the source and target of the arrow.
\begin{center}
{\small
\begin{tikzcd}
& 5|17|4|236 \arrow[ld] \arrow[d] \arrow[rd]\\
15|7|4|236 \arrow[rd] \arrow[d]&
5|17|24|36  \arrow[dl] \arrow[rd]&
5|17|34|26 \arrow[d] \arrow[dl]\\
15|7|24|36 \arrow[dr]&
15|7|34|26  \arrow[d]&
5|17|234|6  \arrow[dl]\\
&15|7|234|6 
\end{tikzcd}
\begin{tikzcd}
& 3|17|4|256 \arrow[ld] \arrow[d] \arrow[rd]\\
37|1|4|256 \arrow[rd] \arrow[d]&
3|17|46|25  \arrow[dl] \arrow[rd]&
3|17|44|26 \arrow[d] \arrow[dl]\\
37|1|46|25 \arrow[dr]&
36|17|44|26  \arrow[d]&
3|17|456|2  \arrow[dl]\\
&37|1|456|2
\end{tikzcd}
}
\end{center}
We now illustrate all the possible $\LAD$ right shifts acting on $\tau$
\begin{center}
\begin{tikzcd}
\sigma \times 57|146|3|2 \arrow[r,"\rho=1"] & \sigma \times 57|46|13|2 \arrow[r,"\rho=1"] & \sigma \times 57|46|3|12
\end{tikzcd}
\end{center}
and all possible $\SUD$ right shifts acting on $\sigma'$
\begin{center}
\begin{tikzcd}
13|247|5|6 \times \tau' \arrow[r,"\rho=7"] & 13|24|57|6 \arrow[r,"\rho=7"] \times \tau' & 13|24|5|67 \times \tau' .
\end{tikzcd}
\end{center}
No other shifts are possible; observe for instance that we cannot perform the $\LAD$ left shift $15|7|234|6 \times 57|46|13|2 \xrightarrow{\rho=2} 15|27|34|6 \times 57|46|13|2$ as the minimal path connecting $234$ and $7$ contains $1$ which is smaller than $2$ (see \cref{ex:ECbijection}).
We shall see in \cref{sec:Shift-lattice}, that these diagrams are the Hasse diagrams of lattices.
\end{example}

\begin{example}
It was observed in \cite{LaplanteAnfossi} that the $\LA$ and $\SU$ diagonals coincided up until $n=3$, however due to their dual shift structure they generate the non-$\SCP$ pairs in a dual fashion.
In particular, the two center faces of the subdivided hexagon of \cref{fig:LUSAdiagonals} are generated by 
\begin{center}
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$13$};
\node[anchor=east] (2) at (-1.5, -2) {$2$};
%
\node[anchor=west] (4) at (1.5, -1) {$3$};
\node[anchor=west] (5) at (1.5, -2) {$12$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (1.east) -- (5.west);
\draw[thick] (2.east) -- (5.west);
\end{tikzpicture}
\quad
\raisebox{1.3em}{$\xrightarrow{R^{SU}_{3}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$1$};
\node[anchor=east] (2) at (-1.5, -2) {$23$};
%
\node[anchor=west] (4) at (1.5, -1) {$3$};
\node[anchor=west] (5) at (1.5, -2) {$12$};
%
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (5.west);
\draw[thick] (2.east) -- (4.west);
\end{tikzpicture}
,\quad \quad
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$12$};
\node[anchor=east] (2) at (-1.5, -2) {$3$};
%
\node[anchor=west] (4) at (1.5, -1) {$2$};
\node[anchor=west] (5) at (1.5, -2) {$13$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (2.east) -- (5.west);
\draw[thick] (1.east) -- (5.west);
\end{tikzpicture}
\quad
\raisebox{1.3em}{$\xrightarrow{L^{SU}_{3}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$12$};
\node[anchor=east] (2) at (-1.5, -2) {$3$};
%
\node[anchor=west] (4) at (1.5, -1) {$23$};
\node[anchor=west] (5) at (1.5, -2) {$1$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (2.east) -- (4.west);
\draw[thick] (1.east) -- (5.west);
\end{tikzpicture}

\end{center}
and
\begin{center}
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$1$};
\node[anchor=east] (2) at (-1.5, -2) {$23$};
%
\node[anchor=west] (4) at (1.5, -1) {$13$};
\node[anchor=west] (5) at (1.5, -2) {$2$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (2.east) -- (4.west);
\draw[thick] (2.east) -- (5.west);
\end{tikzpicture}
\quad
\raisebox{1.3em}{$\xrightarrow{R^{LA}_{1}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$1$};
\node[anchor=east] (2) at (-1.5, -2) {$23$};
%
\node[anchor=west] (4) at (1.5, -1) {$3$};
\node[anchor=west] (5) at (1.5, -2) {$12$};
%
\draw[thick] (1.east) -- (5.west); 
\draw[thick] (2.east) -- (4.west);
\draw[thick] (2.east) -- (5.west);
\end{tikzpicture}
,\quad \quad
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$2$};
\node[anchor=east] (2) at (-1.5, -2) {$13$};
%
\node[anchor=west] (4) at (1.5, -1) {$23$};
\node[anchor=west] (5) at (1.5, -2) {$1$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (2.east) -- (4.west);
\draw[thick] (2.east) -- (5.west);
\end{tikzpicture}
\quad
\raisebox{1.3em}{$\xrightarrow{L^{LA}_{1}}$}
\quad
\begin{tikzpicture}[scale=.6,xscale=0.6]  
\node[anchor=east] (1) at (-1.5, -1) {$12$};
\node[anchor=east] (2) at (-1.5, -2) {$3$};
%
\node[anchor=west] (4) at (1.5, -1) {$23$};
\node[anchor=west] (5) at (1.5, -2) {$1$};
%
\draw[thick] (1.east) -- (4.west); 
\draw[thick] (2.east) -- (4.west);
\draw[thick] (1.east) -- (5.west);
\end{tikzpicture}

\end{center}
where we have aligned each element, of each diagonal, vertically with its dual element.
\end{example}

%%%%%%%%%%%%%%%

\subsection{Shift lattice structure}\label{sec:Shift-lattice}

In this section, we show that the 1-shifts of each diagonal admit a simple lattice structure, that is to say, each $\SCP$ is the minimal element of a lattice isomorphic to a product of chains, where the partial order is given by shifts.
We will discuss how this lattice is compatible with a generalised weak order, and latter we will use the lattice structure to relate the cubical and shift definitions of the $\SUD$ diagonal (\cref{sec:Cubical}).

\begin{definition}
Let $(\sigma,\tau) \in \LAD$ or $\SUD$. For $\rho \in [n]$, let $r_\rho$ (or $l_\rho$) be the maximal value of $m$ such that $R_\rho$ (\resp $L_\rho$) is a well-defined $m$-shift of $(\sigma,\tau)$, or $0$ if there are no such $m$-shifts.

\end{definition}

The maximal $m$-shift for an element $\rho$ of a $SCP$ can be explicitly calculated as follows. 

\begin{proposition}\label{prop:maximal m-shift formulae}
Let $(\sigma,\tau)$ be a SCP. Then the  maximal $\LAD$ shifts admit the following formulae.
\begin{itemize}
	\item For $\rho \in \sigma_i$, $l_\rho = \# $ consecutive blocks to the left of $i$ whose minima is larger than $\rho$.
	\item For $\rho \in \tau_i$, $r_\rho = \# $ consecutive blocks to the right of $i$ whose minima is larger than $\rho$.
\end{itemize}
The maximal $\SUD$ shifts admit the following formulae.
\begin{itemize}
	\item For $\rho \in \sigma_i$, $r_\rho = \# $ consecutive blocks to the right of $i$ whose maxima is smaller than $\rho$.
	\item For $\rho \in \tau_i$, $l_\rho = \# $ consecutive blocks to the left of $i$ whose maxima is smaller than $\rho$.
\end{itemize}
\end{proposition}

\begin{proof}
We show the formula holds in $\SUD$ for $r_\rho$, the other cases are similar. 
As $(\sigma,\tau)$ is a SCP, $\max \sigma_{k,k+1} = \max \sigma_{k+1}$. 
From the equivalence of $1$-shifts and $m$-shifts there exists an $m$-shift of $\rho$ from $\sigma_i$, if, and only if, there exists a sequence of $m$ consecutive $1$-shifts each satisfying $\rho > \max \sigma_{j,j+1}=\max \sigma_{j+1}$.
These iterated one shifts will be well-defined until the first failure at $j=r_\rho+1$.
\end{proof}

\begin{lemma}[$m$-shifts commute] \label{lem:m-shifts commute}
Let $(\sigma,\tau) \in \LAD$ or $\SUD$.
If either side of the following equations are  well-defined sequences of $m_1,m_2$ shift operators, then the other side is a well-defined sequence of $m_2,m_1$ shift operators, and their outputs are equal.
\begin{align*}
	R_{\rho} L_{\rho'}(\sigma,\tau) = L_{\rho'} R_{\rho}(\sigma,\tau), \quad R_{\rho} R_{\rho'}(\sigma,\tau) = R_{\rho'} R_{\rho}(\sigma,\tau), \quad L_{\rho} L_{\rho'}(\sigma,\tau) = L_{\rho'} L_{\rho}(\sigma,\tau)
\end{align*}
\end{lemma}
\begin{proof}
A $\SUD$ ($\LAD$) $m$-shift is defined when $\rho$ is greater (smaller) than the (minimal) maximal element of the connecting path.
From \cref{cor:SU-shift-preserves-max}, we know $m$-shifts conserve the maximal (minimal) elements of paths and their directions.
As such, we can commute any two shift operators.
\end{proof}

\begin{proposition} \label{prop:shift lattice}
Let $(\sigma,\tau)$ be an $\SCP$, and define
\begin{align*}
	L^{\LA}(\sigma,\tau) \eqdef \bigcup_{\mathbf{M}, \mathbf{N}} L_\mathbf{N}(\sigma)\times R_\mathbf{M}(\tau), \quad L^{\SU}(\sigma,\tau) \eqdef \bigcup_{\mathbf{M}, \mathbf{N}} R_\mathbf{M}(\sigma)\times L_\mathbf{N}(\tau)
\end{align*}
where the union is taken over all admissible sequences of $1$-shifts $\b{M},\b{N}$, for each diagonal.
Then each set is isomorphic as a lattice to a product of chains
\begin{align*}
	L^{\LA}(\sigma,\tau) \cong \prod_{\rho \in [n]} [l_\rho]
	\times \prod_{\rho \in [n]} [r_\rho], \quad L^{\SU}(\sigma,\tau) \cong \prod_{\rho \in [n]} [r_\rho]
	\times \prod_{\rho \in [n]} [l_\rho]
\end{align*}
where the maximal shifts $r_\rho,l_\rho$, are calculated with respect to $(\sigma,\tau)$, for each diagonal.
\end{proposition}

\begin{proof}

We identify $(0,0,...,0)$ with the SCP $(\sigma,\tau)$ and every other element $(r_1,...,r_n,l_1,...l_n)$, with 
$R^{r_n}_{n}...R^{r_{1}}_{1}
L^{l_n}_{n}...L^{l_{1}}_{1}(\sigma,\tau)$.
Given \cref{lem:m-shifts commute}, it is straightforward to confirm that the join (meet) of any two elements is given by their element wise maximum (minimum).
In particular, the maximal element of the lattice is given by shifting each element of $(\sigma,\tau)$ by its maximal shift.
\end{proof}

The Hasse diagram of the lattice corresponds to $1$-shifts, and we can step backwards in the diagram by applying inverse $1$-shifts.
Furthermore, we saw in \cref{lem:IJ-closed-under-shifts}, that shifts increase the number of inversions, and inverse shifts decrease the number of inversions.
As such, this lattice structure is compatible with ordering these pairs of ordered partitions by their inversions sets, \ie it is compatible with a generalised Bruhat order.\Guillaume{@Vincent, est-ce que ca coincide avec l'ordre de Ronco?}
For a clear example of the Hasse diagram we direct the reader back to
\cref{ex:shift translation by theta}.

Given our previously obtained formulae for the number of elements in the diagonal (\cref{subsec:enumerationDiagonalPermutahedra}), and the results of this section we obtain the following statistics on permutations.
\begin{corollary}
Let $l_\rho^{\LA}(\sigma)$ be the result of calculating $l_\rho$ for the $\LA$ diagonal for the the $\SCP$ resulting from the permutation $\sigma$, and similarly for variants of this notation. Then,
\begin{align*}
	2(n+1)^{n-2} = \sum_{\sigma \in \mathbb{S}_n} \prod_{\rho=1}^n (l_\rho^{\LA}(\sigma)+1)(r_\rho^{\LA}(\sigma)+1) 
	= \sum_{\sigma \in \mathbb{S}_n} \prod_{\rho=1}^n (r_\rho^{\SU}(\sigma)+1)(l_\rho^{\SU}(\sigma)+1)
\end{align*}
Let $P_{k_1,k_2}^n\subseteq \mathbb{S}_n$ be those permutations with $k_1/k_2$ ascending/descending runs ($k_1+k_2=n-1$). Then,
\begin{align*}
	n \binom{n-1}{k_1} (n-k_1)^{k_1-1} (n-k_2)^{k_2-1} &= \sum_{\sigma \in P_{k_1,k_2}^n} \prod_{\rho=1}^n (l_\rho^{\LA}(\sigma)+1)(r_\rho^{\LA}(\sigma)+1)\\
	&= \sum_{\sigma \in P_{k_1,k_2}^n} \prod_{\rho=1}^n (r_\rho^{\SU}(\sigma)+1)(l_\rho^{\SU}(\sigma)+1)
\end{align*}
\end{corollary}
\begin{proof}
This follows directly from \cref{coro:enumerationDiagonalPermutahedra}, with the observation that shifts conserve the number of blocks, and hence the dimensions of the faces.
\end{proof}

\begin{remark}
Whilst each $l_\rho^{\SU}(\sigma)$ and similar can be calculated from the $\SCP$ they can also be reformulated directly in terms of the permutation.
For instance $l_\rho^{\SU}(\sigma)$ is the number of consecutive ascending runs, to the right of the ascending run containing $\rho$, whose maximal element is smaller than $\rho$.
\end{remark}

%%%%%%%%%%%%%%%

\subsection{Matrix description}

We first recall the alternate descriptions of the $\SUD$ diagonal from \cite{SaneblidzeUmble} and\cite{SaneblidzeUmble-comparingDiagonals}, that we would like to transfer to $\LAD$. 
In particular, we explicitly relate the matrix and cubical descriptions of the $\SUD$ diagonal, to the description of the $\SUD$ diagonal given in \cref{def:classical-SU}.
\\\\
We previously saw that SCPs and permutations are in bijection (\cref{def:strong-complementary-pairs}). 
There is also a third equivalent way to encode this data, the \emph{step matrices} of Definition 6 of \cite{SaneblidzeUmble}.
Informally, given a permutation $\sigma$, start in the bottom left corner of a matrix, and write increasing sequences vertically, and decreasing sequences horizontally. All other entries are $0$. Here is an example permutation, its SCP, and its step matrix, with all $0$ entries omitted.
{\small
\begin{center}
\raisebox{3em}{$6524713$}
$\quad \quad$
\begin{tikzpicture}[scale=.7]  
\node[anchor=east] (1) at (-1.5, -1) {$256$};
\node[anchor=east] (2) at (-1.5, -2) {$4$};
\node[anchor=east] (3) at (-1.5, -3) {$17$};
\node[anchor=east] (4) at (-1.5, -4) {$3$};
%
\node[anchor=west] (5) at (1.5, -1) {$6$};
\node[anchor=west] (6) at (1.5, -2) {$5$};
\node[anchor=west] (7) at (1.5, -3) {$247$};
\node[anchor=west] (8) at (1.5, -4) {$13$};
%
\draw[thick] (1.east) -- (5.west);
\draw[thick] (1.east) -- (6.west); 
\draw[thick] (1.east) -- (7.west); 
\draw[thick] (2.east) -- (7.west); 
\draw[thick] (3.east) -- (7.west); 
\draw[thick] (3.east) -- (8.west); 
\draw[thick] (4.east) -- (8.west);
\end{tikzpicture}
$\quad \quad$
\raisebox{3em}{
$
\begin{blockarray}{ccccc}
  & \sigma_1 & \sigma_2 & \sigma_3 & \sigma_4  \\
\begin{block}{c[cccc]}
\tau_4 &   &   & 1 & 3 \\
\tau_3 & 2 & 4 & 7  &   \\
\tau_2 & 5 &   &   &   \\
\tau_1 & 6 &   &   &   \\
\end{block}
\end{blockarray}
$
}
\end{center}
}
Given a $l\times k$ matrix $A$ with all non-zero entries drawn without replacement from $[n]$, let $\sigma_i(A)$ denote the non-zero entries of the $i$\ordinal{} column, and $\tau_j(A)$ the non-zero entries of the $(l-j+1)$\ordinalst{} row. 
For example, we labelled the rows and columns of the prior step matrix in this fashion.
With this identification, we can apply \cref{def:SU-admissible}, to identify $1$-block moveable subsets of the matrix $M$, and we can apply \cref{def:admissible-shift-sequences}, to identify sequences of shifts which are admissible of original type.
We now define a suitable subset shift action on these matrices.
\begin{definition} [SU Matrix Subset Shifts]
A non-empty set of elements of a matrix $M_i \subset \sigma_i(A)$ (\resp $M_{i}\subset \tau_{i}(A)$) is $1$-block right (left) movable if
\begin{enumerate}
	\item $\min \sigma_i(A) \notin M_i$ (\resp $\min \tau_{i}(A) \notin M_i$), and
	\item $\min M_i> \max \sigma_{i+1}(A)$ (\resp $\min M_{i}> \max \tau_{i-1}(A)$).
\end{enumerate}
The right matrix subset shift operator $R_{M_i}$ shifts the elements of $M_i$ right one column, \ie if $A_{k,l} \in M_i$ then $(R_{M_i}A)_{k,l+1} = A_{k,l}$, replacing only elements of value $0$, and leaving $0$ elements in their wake.
The left matrix subset shift operator $L_{M_i}$ shifts the elements of $M_i$ down one row, replacing only elements of value $0$, and leaving $0$ elements in their wake.
\end{definition}
\begin{proposition}
The matrix subset shift operators are well-defined.
\end{proposition}
\begin{proof}
We verify the claim that the matrix shift operators never replace non-zero elements.
It is straightforward to show that this is true when a shift operator is applied to a $SCP$.
From here we proceed inductively.
We assume that all prior shift operators have been well-defined, and we then check that applying another valid sequential shift operator is also well-defined.
Suppose that $M_i$ is $1$-block moveable, and that $R_{M_i}$ is not well-defined as it tries to move a value $m$ into a non-zero matrix entry $n$.
Then, $n$ must have been placed into that column by a prior left shift operator $L_{N_j}$, and consequently $n>\min N_j > \max \tau_{j-1}> m$.
However, $n\in \sigma_{i+1}$ so $\max \sigma_{i+1}>n>m>\min M_i $ implies that $M_i$ is not $1$-block moveable, a contradiction.
\end{proof}


\begin{definition}[Definition 7. \cite{SaneblidzeUmble}]
We define the set of \emph{configuration matrices} $\mathcal{C}$, to be those matrices  corresponding to $SCP$s and those generated by admissible sequences of shifts.
\end{definition}

\begin{proposition}[\cite{SaneblidzeUmble}]
The set of $\SU$ configuration matrices are in bijection with the facets of $\SUD$.
\end{proposition}
\begin{proof}
As configuration matrices have the same recursive description as the original $\SUD$ diagonal (\cref{def:classical-SU}), and $SCP$s are in bijection with step matrices, the result immediately follows.
\end{proof}

As a result of the face poset isomorphism $t(r\times r)$ we also immediately obtain a matrix description of the $\LA$ diagonal.
\begin{definition}[LA Matrix Subset Shifts]
A non-empty set of elements of a matrix $M_i \subset \sigma_i(A)$ (\resp $M_{i}\subset \tau_{i}(A)$) is $1$-block right (left) movable if
\begin{enumerate}
	\item $\max \sigma_i(A) \notin M_i$ (\resp $\max \tau_{i}(A) \notin M_i$), and
	\item $\max M_i < \min \sigma_{i-1}(A)$ (\resp $\max M_{i} < \min \tau_{i+1}(A)$).
\end{enumerate}
The right matrix subset shift operator $R_{M_i}$ shifts the elements of $M_i$ left one column, replacing only elements of value $0$, and leaving $0$ elements in their wake.
The left matrix subset shift operator $L_{M_i}$ shifts the elements of $M_i$ up one row, replacing only elements of value $0$, and leaving $0$ elements in their wake.
\end{definition}
Defining the set of configuration matrices $\mathcal{C}$, to be those matrices  corresponding to $SCP$s and those generated by admissible sequences of $\LA$ shifts, then yields the expected result.
\begin{proposition}
The set of $\LA$ configuration matrices are in bijection with the facets of $\LAD$.
\end{proposition}

\begin{example}
The first row of the following diagram contains a sequence of admissible $\SU$ subset shifts applied to the matrix encoding of the SCP $256|4|17|3\times 6|5|147|13$ (see \cref{ex:shift translation by theta} for other encodings of shifts acting on this element). 
The second row is the image of these shifts under isomorphism $t(r\times r)$.
\begin{center}
{\footnotesize
\begin{tikzcd}[column sep = 0.5cm]
\begin{bmatrix}
  &   & 1 & 3 \\
2 & 4 & 7 &   \\
5 &   &   &   \\
6 &   &   &   \\
\end{bmatrix}
\arrow[r,"R^{SU}_{5,6}"]
&
\begin{bmatrix}
  &   & 1 & 3 \\
2 & 4 & 7 &   \\
  & 5 &   &   \\
  & 6 &   &   \\
\end{bmatrix}
\arrow[r,"L^{SU}_7"]
&
\begin{bmatrix}
  &   & 1 & 3 \\
2 & 4 &   &   \\
  & 5 & 7 &   \\
  & 6 &   &   \\
\end{bmatrix}
\arrow[r,"R^{SU}_7"]
&
\begin{bmatrix}
  &   & 1 & 3 \\
2 & 4 &   &   \\
  & 5 &   & 7 \\
  & 6 &   &   \\
\end{bmatrix}
\\
\begin{bmatrix}
  &   &   & 2 \\
  &   &   & 3 \\
  & 1 & 4 & 6 \\
5 & 7 &   &   \\
\end{bmatrix}
\arrow[r,"R^{LA}_{2,3}"]
&
\begin{bmatrix}
  &   & 2 &   \\
  &   & 3 &   \\
  & 1 & 4 & 6 \\
5 & 7 &   &   \\
\end{bmatrix}
\arrow[r,"L^{LA}_1"]
&
\begin{bmatrix}
  &   & 2 &   \\
  & 1 & 3 &   \\
  &   & 4 & 6 \\
5 & 7 &   &   \\
\end{bmatrix}
\arrow[r,"R^{LA}_1"]
&
\begin{bmatrix}
  &   & 2 &   \\
1 &   & 3 &   \\
  &   & 4 & 6 \\
5 & 7 &   &   \\
\end{bmatrix}
\end{tikzcd}
}
\end{center}


\end{example}

%%%%%%%%%%%%%%%

\subsection{Cubical description}
\label{sec:Cubical}

In \cite{SaneblidzeUmble}, Saneblidze and Umble identified that they could use a particular subdivision of the $(n-1)$-cube by $P_{n}$, to construct cellular operadic diagonals of polytopes which admit cellular projections from the permutahedra.
In their work, they briefly outline this cubical construction before using it to induce their subset shift description (\cref{def:classical-SU}).
In this section, we recall their cubical definition of the $\SU$ diagonal and explicitly relate it to their shift description, using a new proof that exploits the lattice description of the diagonal (\cref{sec:Shift-lattice}).
We finally transfer the cubical formulae to the $\LA$ diagonal via isomorphism.


\subsubsection{The Cubical Diagonal}

\begin{definition}
We define \defn{$\divcube{n}$} to be an inductive subdivision of the $(n-1)$-cube by $P_n$.
Let $\divcube{0}$ be the $0$-cube (a point), trivially subdivided by the sole element $1$ of $P_1$.
Then, assuming we have constructed $\divcube{n-1}$, we construct $\divcube{n}$ by weaving $n$ through every face of $\sigma = \sigma_1|...|\sigma_k \in P_{n-1}$, using an interval description.
For $0<j<k$ we define
$n_j := |\sigma_{k-j+1}\cup...\cup \sigma_k|$, $I_j := [1 - \frac{1}{2^{n_j}}, 1 - \frac{1}{2^{n_{j+1}}}]$, and boundary cases $I_0:= [0,1 - \frac{1}{2^{n_1}}]$, $I_k:= [1 - \frac{1}{2^{n_k}},1]$,
This defines a partition of the interval $[0,1]$, which we denote $I := I_0 \cup ... \cup I_k$.
The weaving of $n$ through $\sigma$ is then defined as follows,
\begin{align} \label{eq:SU cube inductive def}
	\sigma \times I \mapsto 
	\begin{cases}
		\sigma_1|...|\sigma_k| n, &I = [0, 0]\\
		\sigma_1|...|\sigma_j \cup n|...|\sigma_k, &I = I_j\\
		\sigma_1|...|\sigma_j|n|\sigma_{j+1}|...|\sigma_k, &I = I_j \cap I_{j+1}\\
		n|\sigma_1|...|\sigma_k, &I = [1, 1]
	\end{cases}
\end{align}
\end{definition}

Here is an illustration of this subdivision for the first few-dimensions.
We indicate, in bold, the embedding $\divcube{n-1}\hookrightarrow \divcube{n}$ that occurs when $I=[0, 0]$. 
We emphasise, that a consequence of the construction is that each dimension of $\divcube{n}$ corresponds to shifting a particular element of $[n]\ssm \{1\}$.

\begin{center}
{\small
\begin{tikzcd}[sep=0.3cm]
\mathbf{1|2} \arrow[r,dash, "12"] & 2|1
\end{tikzcd}
}
$\hookrightarrow$
{\small
\begin{tikzcd}[column sep=0.3cm]
3|1|2 \arrow[r,dash, "3|12"] \arrow[d,dash, "13|2"]& 3|2|1 \arrow[d,dash, "13|2"]\\
1|3|2 \arrow[d,dash, "1|23"] & 2|3|1 \arrow[d,dash, "2|13"]\\
\mathbf{1|2|3} \arrow[r,dash,thick, "12|3"] & \mathbf{2|1|3}
\end{tikzcd}
}
$\hookrightarrow$
{\small
\begin{tikzcd}[sep=0.15cm,scale=0.8]
& 4|2|1|3 \arrow[rr,dash] \arrow[dd,dash,dotted] \arrow[dl,dash] & & 4|2|3|1 \arrow [dd, dash,dotted] \arrow[rr,dash] & & 4|3|2|1 \arrow[dd,dash] \arrow[dl,dash]\\
4|1|2|3 \arrow [rr,dash] \arrow [dd,dash] & & 4|1|3|2 \arrow[rr,dash] \arrow[dd,dash] & & 4|3|1|2 \arrow[dd,dash]  & \\
& 2|4|1|3 \arrow [rr,dash,dotted] \arrow[dd,dash,dotted]  & & 2|4|3|1  \arrow[dd,dash,dotted] & & 3|4|2|1 \arrow [dl,dash] \arrow[dd,dash]\\
1|4|2|3 \arrow [rr,dash] \arrow [dd,dash]& & 1|4|3|2  \arrow[dd,dash] & & 3|4|1|2 \arrow[dd,dash]\\
& 2|1|4|3 \arrow[dd,dash,dotted] \arrow[dl,dash,dotted] & & 2|3|4|1 \arrow [dd, dash,dotted] \arrow [rr, dash,dotted] & & 3|2|4|1 \arrow[dd,dash] \\
1|2|4|3 \arrow [dd,dash] & & 1|3|4|2 \arrow[rr,dash] \arrow[dd,dash] & & 3|1|4|2 \arrow[dd,dash] & \\
& \mathbf{2|1|3|4} \arrow [rr,dash,dotted] \arrow [dl,dash,dotted] & & \mathbf{2|3|1|4} \arrow [rr,dash,dotted] & & \mathbf{3|2|1|4} \arrow [dl,dash] \\
\mathbf{1|2|3|4} \arrow [rr,dash] & & \mathbf{1|3|2|4} \arrow [rr,dash] & & \mathbf{3|1|2|4} \\
\end{tikzcd}
}
\end{center}
We have only labelled the vertices of $\divcube{3}$, but its edges, facets and outer face are all identified with the expected elements of $P_{4}$.
The cubical formula for the diagonal is constructed through maximal pairings of $k$-subdivision cubes of $\divcube{n}$, which we now define, and prove the existence of.

\begin{definition} \label{def:Subdivisions}
Let $e$ be a cell in $P_{n}$ with dimension $|e|$, a \defn{$k$-subdivision cube of $e$} is a set of $k$-faces whose union is a $k$-subcube of $e$ in $\divcube{n}$, for some $k\leq |e|$.
\end{definition}

As a trivial example, every $k$-face of $P_n$ is a $k$-subdivision cube of every cell which contains it, for instance itself, and the outer face of $P_n$.
Less trivial examples are provided in \cref{ex:subdivision cubes}.

\begin{lemma}\label{lem:k-subdiv cubes have max/min k faces}
A $k$-subdivision cube of $e$ has unique maximal and minimal vertices under the weak order.
\end{lemma}

\begin{proof}
If a $k$-subdivision cube had multiple maximal/minimal vertices, then it could not be a union of $k$-faces in the shape of a $k$-cube.
\end{proof}

We thus define the unique maximal (minimal) $k$-face of a $k$-subdivision cube to be the unique $k$-face adjacent to the maximal (minimal) vertex.

\begin{lemma}\label{lem:Unique maximal subdivcubes}
Let $e$ be a cell of $P_n$ and $\sigma$ a $k$-face of the cell. Then there exists a unique maximal $k$-subdivision cube of $e$ whose maximal (minimal) $k$-face is $\sigma$.
\end{lemma}

\begin{proof}
We first prove the result for $1$-subdivision cubes, \ie lines, then proceed inductively from there.
We only treat the case for maximal $k$-face $\sigma$, the minimal case proceeds similarly.
Given the inductive description of $\divcube{n}$ (\cref{eq:SU cube inductive def}), the maximal vertex $v$ and the face $\sigma$ specifies the element $\rho$ being shifted by the line.
Furthermore, from this inductive description, the line can be grown, with respect to inclusion of $1$-faces, by shifting $\rho$ to the right (left) as far as possible.
Note, that $\rho$ will eventually be blocked by either reaching the boundary of the enveloping cell $e$, or being blocked by a larger element.
So there is a unique maximal $1$-subdivision line with maximal $1$-face $\sigma$.
\\\\
Now consider the set of $(k+1)$-subdivision cubes with maximal $(k+1)$-face $\sigma$.
The face $\sigma$ is trivially one such cube.
Consider the $k+1$ elements of $[n]$, which correspond to dimensions spanned by $\sigma$, and let $\rho$ be the largest such element.
Let $\sigma_L$ be the $1$-face, with maximal vertex $v$, whose only non-trivial dimension corresponds to $\rho$.
Then, there exists a unique maximal $1$-subdivision line with maximal $1$-face $\sigma_L$, which we denote $L$.
In particular, if $v'$ is the minimal vertex of $L$, and $v_\rho, v'_\rho$ are the indices of $\rho$ in $v,v'$, then under the inductive description of $\divcube{n-1}$ (\cref{eq:SU cube inductive def}) the line $L$ corresponds to $\sigma_L \times I'$ where $I':=[1-\frac{1}{2^{n-v'_\rho}},1-\frac{1}{2^{n-v_\rho}}]$.
\\\\
Let $\sigma_C$ be the $k$-face which results from taking $\sigma$, and setting the dimension corresponding to $\rho$ to $1-\frac{1}{2^{n-v_\rho}}$.
This corresponds to shifting $\rho$ from its current block, into a singleton block above it, so consequently the maximal vertex of $\sigma_C$ is also $v$.
Thus, by the inductive assumption, there exists a unique maximal $k$-subdivision cube with maximal $k$-face $\sigma_C$, which we denote $C$.
The product $L\times C$ is then clearly a $(k+1)$-cube with maximal vertex $v$.
In addition, every $k$-face in $C$ must have its corresponding $\rho$ coordinate be $1-\frac{1}{2^{n-v_\rho}}$.
Consequently, as $\rho$ was the maximal element corresponding to dimensions of the $(k+1)$-cube, and the line $\sigma_L \times I'$ was well-defined, we know the product $C\times L$ will correspond to the union of intervals $\sqcup_{f\in C}f \times I'$ (\cref{eq:SU cube inductive def}), which spans the $(k+1)$-cube with $(k+1)$-faces resulting from shifting $\rho$ through $C$.
Thus, $L\times C$ is a $(k+1)$-subdivision cube of $e$.
Finally, $L\times C$ must be maximal under inclusion.
If there was a larger $(k+1)$-subdivision cube $C'$ enveloping $L\times C$, then one of its projections would be a $1,k$ subdivision cube enveloping $L$ or $C$, which contradicts the assumption they were maximal.

\end{proof}

We now define our maximal pairing of subdivision cubes.

\begin{definition} [\cite{SaneblidzeUmble-comparingDiagonals}]\label{def:subdiv pairs}
Let $e$ be a cell of $P_n$ and let $\mathcal{V}_e$ be the set of vertices in $e$.
For a given vertex $v \in \mathcal{V}_e$, we define \defn{$\subdivpairsev$} to be the set of all pairs $(C^v,C_v)$ of $k_1,k_2$ subdivision cubes of $e$ such that
\begin{enumerate}
	\item $C^v$ is a $k_1$-subdivision cube of $e$ with maximal vertex $v$.
	\item $C_v$ is a $k_2$-subdivision cube of $e$ with minimal vertex $v$.
	\item $k_1+k_2 = |e|$
\end{enumerate}
If $e$ is the outer face of $P_n$, then we denote the set of pairs \defn{$\subdivpairsv$}.
Finally, we define \defn{$\maxsubdivpairsev$} (and \defn{$\maxsubdivpairsv$}) to be the unique maximal pair, with respect to inclusion, of $\subdivpairsev$ (and $\subdivpairsv$).
\end{definition}
We note that the uniqueness of the maximal pair is a corollary of \cref{lem:Unique maximal subdivcubes}.

\begin{example}\label{ex:subdivision cubes}
We clarify the previous section with examples that are visually verifiable from the diagram of $I_3$ below.
The following sets of faces are all $k$-subdivision cubes of the outer face of $P_4$, (for varying $k$),
\begin{align*}
	\{1234\},\quad \{1|234\},\quad \{1|234, 14|23\},\quad \{1|3|24,1|34|2\}.
\end{align*}
Note, that $\{1|3|24,1|34|2\}$ is also a $1$-subdivision cube of the cell $1|234$.
The following three sets of faces are not subdivision cubes of $e$,
\begin{align*}
	\{134|2, 14|23\},\quad \{1|234, 134|2, 14|23\}, \quad \{1|2|34,1|23|4\}
\end{align*}
For $v = \blue{\mathbf{4|3|1|2}}$, $k_1=2$, $k_2=1$, the only $k_2$-subdivision cube with minimal vertex $v$ is $4|3|12$, and the three $k_1$-subdivision cubes with maximal vertex $v$ are
\begin{align*}
	\{134|2\}, \{13|24, 134|2\}, \{ 1|234, 13|24, 14|23, 134|2\}
\end{align*}

This defines $\subdivpairsv$, and thus $\maxsubdivpairsv=\{ 1|234, 13|24, 14|23, 134|2\} \times \{4|3|12\}$.
In the next section, we will show that $\maxsubdivpairsv$ is generated by all shifts of the strong complementary pair corresponding to $v$.
For now, we verify this claim on this example.
The $\SCP$ corresponding to $v$ is $(\sigma,\tau) = (\blue{\mathbf{134|2}},\blue{\mathbf{4|3|12}} )$.
The ordered partition $\sigma$ admits three distinct rights shifts, $\red{\mathbf{13|24}}$, $\red{\mathbf{14|23}}$, $\red{\mathbf{1|234}}$, and $\tau$ admits no left shifts.

\begin{center}
{\small
\begin{tikzcd}[sep=0.1cm, scale=0.3]
& 4|2|1|3 \arrow[rr,dash] \arrow[dd,dash,dotted] \arrow[dl,dash] & & 4|2|3|1 \arrow [dd, dash,dotted] \arrow[rr,dash] & & 4|3|2|1 \arrow[dd,dash] \arrow[dl,dash, near end, "\mathbf{\blue{4|3|12}}"']\\
4|1|2|3 \arrow [rr,dash] \arrow [dd,dash] & & 4|1|3|2 \arrow[rr,dash] \arrow[dd,dash] & & \mathbf{\blue{4|3|1|2}} \arrow[dd,dash]  & \\
& \red{\mathbf{14|23}} \arrow [rr,dash,dotted] \arrow[dd,dash,dotted]  & & 2|4|3|1  \arrow[dd,dash,dotted] & & 3|4|2|1 \arrow [dl,dash] \arrow[dd,dash]\\
1|4|2|3 \arrow [rr,dash] \arrow [dd,dash]& & 1|4|3|2  \arrow[dd,dash] \arrow[rr, phantom, "\blue{\mathbf{134|2}}" description,crossing over] & & 3|4|1|2 \arrow[dd,dash]\\
& 2|1|4|3 \arrow[dd,dash,dotted] \arrow[dl,dash,dotted] & & 2|3|4|1 \arrow [dd, dash,dotted] \arrow [rr, dash,dotted] & & 3|2|4|1 \arrow[dd,dash] \\
1|2|4|3 \arrow [dd,dash] \arrow[rr, phantom, "\red{\mathbf{1|234}}" description,crossing over] & & 1|3|4|2 \arrow[rr,dash] \arrow[dd,dash] & & 3|1|4|2 \arrow[dd,dash] & \\
& 2|1|3|4 \arrow [rr,dash,dotted] \arrow [dl,dash,dotted] & & \red{\mathbf{13|24}} \arrow [rr,dash,dotted] & & 3|2|1|4 \arrow [dl,dash] \\
1|2|3|4 \arrow [rr,dash] & & 1|3|2|4 \arrow [rr,dash] & & 3|1|2|4 \\
\end{tikzcd}
}
\end{center}

\end{example}

\begin{proposition}[Formula (1) of \cite{SaneblidzeUmble-comparingDiagonals}]
The following formula defines a cellular operadic diagonal of the permutahedra. 
For every cell $e$ of the permutahedra,
\begin{align*}
	\triangle(e) = \bigcup_{v \in V_e} \maxsubdivpairsev
\end{align*}
where $V_e$ is the set of vertices of the cell.
In particular, its value on outer faces is 
\begin{align*}
	\triangle([n]) = \bigcup_{v \in P_n} \maxsubdivpairsv
\end{align*}
and as a result of it being an operadic diagonal, it extends to all other faces.
\end{proposition}
\begin{proof}
By construction, the diagonal is cellular (\cref{def:cellularDiagonal}).
This follows, as the image of the map is a union of dim $P$-faces of $P\times P$.
Furthermore, for every vertex $v$ in $P$, not only is $(v,v) \in \maxsubdivpairsv$, but $\maxsubdivpairsv$ is also contractible to $(v,v)$.
The diagonal is also operadic (\cref{def:operadicDiagonal}), as the presence of vertices $v$ in a cell $e=A_1|...|A_k$ are conserved under the isomorphism $\Theta$. Consequently, \Kurt{Something like this... Or can cop out and just say operadic as a result of LA being operadic...}
\begin{align*}
	\triangle(A_1|...|A_k) = \bigcup_{v \in V_{A_1|...|A_k}} \maxsubdivpairsev \cong \bigcup_{v \in V_{A_1\times ... \times A_k}} \maxsubdivpairsev
	= \triangle(A_1)\times...\times \triangle(A_k)
\end{align*}

\end{proof}

\subsubsection{The Cubical-Shift Equivalence}

We now specialise the results of the prior section to $k$-subdivision cubes of the outer face of $\divcube{n}$.
Under this specialisation, we recover the $\SU$ shift lattice structure identified in \cref{sec:Shift-lattice}.
Our first observation relating subdivision cubes to shifts is,

\begin{proposition}\label{prop:ev properties}
The set of pairs $\subdivpairsv$ satisfies the following properties,
\begin{enumerate}
	\item The strong complementary pair $(\sigma,\tau)$ corresponding to $v$ is in $\subdivpairsv$.
	\item All pairs in $\subdivpairsv$ have the same dimensions $k_1$ and $k_2$.
	\item For all $(C^v,C_v) \in \subdivpairsv$, the unique maximal $k_1$-face of $C^v$ is $\sigma$, the unique minimal $k_2$-face of $C_v$ is $\tau$.
\end{enumerate}
\end{proposition}
\begin{proof}
Strong complementary partitions correspond to those pairs of faces $(F,G)$ of the permutahedra such that the maximal vertex of $F$ is the minimal vertex of $G$ (\cref{def:strong-complementary-pairs}).
That is to say, $(\sigma,\tau)$ is the unique pair of faces of the permutahedra that meet at vertex $v$.
Consequently, not only must $(1)$ be true, but every pair of subdivision cubes $(C^v,C_v) \in \subdivpairsv$ must have $\sigma$ as its maximal $k_1$-face, and $\tau$ as its minimal $k_2$-face, giving $(2)$ and $(3)$.
\end{proof}

\begin{lemma}
Let $C$ be a maximal $k$-subdivision cube with  maximal (minimal) $k$-face $\sigma$ ($\tau$).
Then $C = \bigcup_{\mathbf{M}} R_\mathbf{M}(\sigma)$ (\resp $C=\bigcup_{\mathbf{N}} L_\mathbf{M}(\tau)$), where $\mathbf{M}$ and $\mathbf{N}$ are all admissible sequence of $\SU$ shifts.

\end{lemma}
\begin{proof}
Compared to \cref{lem:Unique maximal subdivcubes}, we now have the additional assumption that $C$ is a $k$-subdivision cell of the outer face.
This means we don't have to worry about generic boundaries imposed by generic enveloping cells $e$.
We prove the result inductively from lines, and consider just the case of the maximal $k$-face $\sigma$, as the minimal $k$-face $\tau$ proceeds similarly.
If $L$ is a maximal $1$-subdivision cube with maximal $1$-face $\sigma$, then its faces are generated by $\bigcup_{i=0}^{r_\rho} R_\rho^i(\sigma)$
Where $r_\rho$ is calculated using the maximal shift-indices of \cref{prop:maximal m-shift formulae}.
This is because the maximal $1$-face $\sigma$ uniquely determines the element $\rho$ being shifted, and the inductive description of $\divcube{n-1}$ (\cref{eq:SU cube inductive def}) coincides with the $\SU$ lattice description (\cref{sec:Shift-lattice}) given the maximal face $\sigma$ can be interpreted as the left ordered partition of an $\SCP$.
Note in both formulae, $\rho$ is simply right shifted until it reaches the final block, or is blocked by a larger element.
\\\\
Let $C^\sigma$ be the unique maximal $(k+1)$-subdivision cube with maximal $(k+1)$-face $\sigma$.
Given the proof of \cref{lem:Unique maximal subdivcubes}, we know $C^\sigma = L\times C$, \ie the $(k+1)$-subdivision cube is a product of a line corresponding to $\rho$, and a $k$-cube $C$ corresponding to all other elements.
We know that the line $L$, with maximal $1$-face $\sigma_L$ satisfies $L=\bigcup_{i=0}^{r_\rho} R_\rho^i(\sigma_L)$, and we make the inductive assumption that $C$ with maximal $k$-face $\sigma_C$ satisfies $C = \bigcup_{\mathbf{M}}R_\mathbf{M}(\sigma_C)$, where $\mathbf{M}$ is the set of all admissible right shifts of $\sigma_C$.
\\\\
Let $\rho'$ be an element shifted in $C$, then its maximal right shift height in $C$ is the same as its maximal right shift height in $L\times C$.
This follows from the inductive description of $\divcube{n-1}$ (\cref{eq:SU cube inductive def}).
In particular, every $k$-face in $C$ has $\rho$ in a singleton block, and as $\rho$ is larger than all other elements it blocks all other shifts.
If $\rho$ is in the $i$th block of $\sigma_C$, then $\sigma$ is obtained from $\sigma_C$ by merging the $i$\ordinal{} and $(i+1)$\ordinalst{} blocks.
It is thus straightforward to see the maximal right shifts $r_{\rho'}$ are conserved, when moving from $C$ to $C\times L$.
\\\\
Finally, we know from the inductive description of $\divcube{n-1}$ (\cref{eq:SU cube inductive def}), and the proof of \cref{lem:Unique maximal subdivcubes}, that to construct the $(k+1)$-faces of $L\times C$ we weave $\rho$ through the $k$-faces of $C$ (stepping through the interval $[1-\frac{1}{2^{n-v_\rho}},1-\frac{1}{2^{n-v'_\rho}}]$).
Every $k$-face in $C$ has $\rho$ in a fixed singleton set (specified by $1-\frac{1}{2^{n-v_\rho}}$), and every $k$ face on the opposite side of $C\times L$ has $\rho$ in another fixed singleton set (specified by $1-\frac{1}{2^{n-v'_\rho}}$).
Given \cref{eq:SU cube inductive def}, this final singleton block is either the last block, or is followed by a block containing an element larger than $\rho$.
If we translate this observation back to the $(k+1)$-faces that are adjacent to the boundaries of the interval, then this corresponds to an equivalent calculation of $r_\rho$ for $\sigma$.
This thus proves that $L\times C = \bigcup_{i=0}^{r_\rho}\bigcup_{\mathbf{M}}R^i_\rho R_\mathbf{M}(\sigma) = \bigcup_{\mathbf{M'}}R_\mathbf{M'}(\sigma)$, where $M'$ must be the set of admissible sequence of right shifts of $\sigma$, given the lattice description of the diagonal \cref{prop:shift lattice}.

\end{proof}

Applying this lemma to pairs of maximal subdivision cubes yields,

\begin{corollary}\label{prop:Maximal Subdiv Pairs and Shifts}
[Formula (3) of \cite{SaneblidzeUmble-comparingDiagonals}]
Let $v$ be a vertex of $P_n$, then
\begin{align*}
	\maxsubdivpairsv = \bigcup_{\mathbf{M},\mathbf{N}} R_\mathbf{M}(\sigma) \times L_{\mathbf{N}}(\tau)
\end{align*}
where $\mathbf{M},\mathbf{N}$ are admissible sequences of $SU$ shifts.
\end{corollary}

Which consequently provides an alternate cubical formula for the $\SU$ diagonal,

\begin{proposition}[Formula (1) and (3) \cite{SaneblidzeUmble-comparingDiagonals}]
\begin{align*}
	\SUD([n]) = \bigcup_{v \in P_n} \maxsubdivpairsv
\end{align*}
\end{proposition}

\subsubsection{LA Cubical Description}

The $\LA$ diagonal also admits a cubical description, which we may quickly induce by isomorphism.

\begin{definition}
We define \defn{$\divcube{n}^{\LA}$} to be an inductive subdivision of the $(n-1)$-cube by $P_n$.
Let $\divcube{0}^{\LA}$ be the $0$-cube (a point), trivially subdivided by the sole element $1$ of $P_1$.
Then, assuming we have constructed $\divcube{n-1}^{\LA}$, we construct $\divcube{n}^{\LA}$ by weaving $1$ through every face of $\sigma = \sigma_1|...|\sigma_k \in P_{n-1}$, using an interval description.
For $0<j<k$ we define
$n_j := |\sigma_{k-j+1}\cup...\cup \sigma_k|$, $I_j := [1 - \frac{1}{2^{n_j}}, 1 - \frac{1}{2^{n_{j+1}}}]$, and boundary cases $I_0:= [0,1 - \frac{1}{2^{n_1}}]$, $I_k:= [1 - \frac{1}{2^{n_k}},1]$,
This defines a partition of the interval $[0,1]$, which we denote $I := I_0 \cup ... \cup I_k$.
The weaving of $1$ through $\sigma$ is then defined as follows,
\begin{align} \label{eq:In LA inductive def}
	\sigma \times I \mapsto 
	\begin{cases}
		\sigma'_1|...|\sigma'_k| 1, &I = [0, 0]\\
		\sigma'_1|...|\sigma'_j \cup 1|...|\sigma'_k, &I = I_j\\
		\sigma'_1|...|\sigma'_j|1|\sigma'_{j+1}|...|\sigma'_k, &I = I_j \cap I_{j+1}\\
		1|\sigma'_1|...|\sigma'_k, &I = [1, 1]
	\end{cases}
	, \text{where } \sigma'_i = \{x+1:x\in \sigma\}
\end{align}
\end{definition}

We illustrate the first few generations of $\divcube{n}^{\LA}$, indicating in bold, the embedding $\divcube{n-1}^{\LA}\hookrightarrow \divcube{n}^{\LA}$ that occurs when $I = [0, 0]$.

\begin{center}
{\small
\begin{tikzcd}[sep=0.3cm]
\mathbf{2|1} \arrow[r,dash, "12"] & 1|2
\end{tikzcd}
}
$\hookrightarrow$
{\small
\begin{tikzcd}[column sep=0.3cm]
1|3|2 \arrow[r,dash, "1|23"] \arrow[d,dash, "13|2"]& 1|2|3 \arrow[d,dash, "13|2"]\\
3|1|2 \arrow[d,dash, "3|12"] & 2|1|3 \arrow[d,dash, "2|13"]\\
\mathbf{3|2|1} \arrow[r,dash,thick, "23|1"] & \mathbf{2|3|1}
\end{tikzcd}
}
$\hookrightarrow$
{\small
\begin{tikzcd}[sep=0.15cm,scale=0.8]
& 1|3|4|2 \arrow[rr,dash] \arrow[dd,dash,dotted] \arrow[dl,dash] & & 1|3|2|4 \arrow [dd, dash,dotted] \arrow[rr,dash] & & 1|2|3|4 \arrow[dd,dash] \arrow[dl,dash]\\
1|4|3|2 \arrow [rr,dash] \arrow [dd,dash] & & 1|4|2|3 \arrow[rr,dash] \arrow[dd,dash] & & 1|2|4|3 \arrow[dd,dash]  & \\
& 3|1|4|2 \arrow [rr,dash,dotted] \arrow[dd,dash,dotted]  & & 3|1|2|4  \arrow[dd,dash,dotted] & & 2|1|3|4 \arrow [dl,dash] \arrow[dd,dash]\\
4|1|3|2 \arrow [rr,dash] \arrow [dd,dash]& & 4|1|2|3  \arrow[dd,dash] & & 2|1|4|3 \arrow[dd,dash]\\
& 3|4|1|2 \arrow[dd,dash,dotted] \arrow[dl,dash,dotted] & & 3|2|1|4 \arrow [dd, dash,dotted] \arrow [rr, dash,dotted] & & 2|3|1|4 \arrow[dd,dash] \\
4|3|1|2 \arrow [dd,dash] & & 4|2|1|3 \arrow[rr,dash] \arrow[dd,dash] & & 2|4|1|3 \arrow[dd,dash] & \\
& \mathbf{3|4|2|1} \arrow [rr,dash,dotted] \arrow [dl,dash,dotted] & & \mathbf{3|2|4|1} \arrow [rr,dash,dotted] & & \mathbf{2|3|4|1} \arrow [dl,dash] \\
\mathbf{4|3|2|1} \arrow [rr,dash] & & \mathbf{4|2|3|1} \arrow [rr,dash] & & \mathbf{2|4|3|1} \\
\end{tikzcd}
}
\end{center}

The appropriate base definitions for the $\LA$ diagonal of $k$-subdivision cubes (\ref{def:Subdivisions}),  pairs of subdivision cubes ${\subdivpairsv}$ (\ref{def:subdiv pairs}), and maximal pairs of subdivision cubes $\maxsubdivpairsv$ are all the same as in the $\SU$ case.
We relate these definitions to those in the $\SU$ case with the following result.
\begin{proposition}\label{prop:r is a k-subdiv cube isomorphism}
Let $r:P\to P$ be the face poset isomorphism of the permutahedra which acts on $A_1|...|A_k$, by replacing each block $A_j$ by the block $r(A_j):=\{n-i+1 \ | \ i \in A_j\}$.
Then the induced map $r:\divcube{n}^{\SU}\to \divcube{n}^{\LA}$,
\begin{enumerate}
	\item is a face poset isomorphism,
	\item conserves the dimensions of each face in $[0,1]^{n}$,
	\item is a $k$-subdivision cube isomorphism.
\end{enumerate}
\end{proposition}
\begin{proof}
The first property is immediate, as $r:P\to P$ is a face poset isomorphism.
The second may be shown inductively.
The third then follows from the first and the second.
\end{proof}

\begin{example}
Applying $r$ to \cref{ex:subdivision cubes} yields,
\begin{center}

{\scriptsize
\begin{tikzcd}[sep=0.1cm, scale=0.3]
& 4|2|1|3 \arrow[rr,dash] \arrow[dd,dash,dotted] \arrow[dl,dash] & & 4|2|3|1 \arrow [dd, dash,dotted] \arrow[rr,dash] & & 4|3|2|1 \arrow[dd,dash] \arrow[dl,dash, near end, "\mathbf{\blue{4|3|12}}"']\\
4|1|2|3 \arrow [rr,dash] \arrow [dd,dash] & & 4|1|3|2 \arrow[rr,dash] \arrow[dd,dash] & & \mathbf{\blue{4|3|1|2}} \arrow[dd,dash]  & \\
& \red{\mathbf{14|23}} \arrow [rr,dash,dotted] \arrow[dd,dash,dotted]  & & 2|4|3|1  \arrow[dd,dash,dotted] & & 3|4|2|1 \arrow [dl,dash] \arrow[dd,dash]\\
1|4|2|3 \arrow [rr,dash] \arrow [dd,dash]& & 1|4|3|2  \arrow[dd,dash] \arrow[rr, phantom, "\blue{\mathbf{134|2}}" description,crossing over] & & 3|4|1|2 \arrow[dd,dash]\\
& 2|1|4|3 \arrow[dd,dash,dotted] \arrow[dl,dash,dotted] & & 2|3|4|1 \arrow [dd, dash,dotted] \arrow [rr, dash,dotted] & & 3|2|4|1 \arrow[dd,dash] \\
1|2|4|3 \arrow [dd,dash] \arrow[rr, phantom, "\red{\mathbf{1|234}}" description,crossing over] & & 1|3|4|2 \arrow[rr,dash] \arrow[dd,dash] & & 3|1|4|2 \arrow[dd,dash] & \\
& 2|1|3|4 \arrow [rr,dash,dotted] \arrow [dl,dash,dotted] & & \red{\mathbf{13|24}} \arrow [rr,dash,dotted] & & 3|2|1|4 \arrow [dl,dash] \\
1|2|3|4 \arrow [rr,dash] & & 1|3|2|4 \arrow [rr,dash] & & 3|1|2|4 \\
\end{tikzcd}
}
$\xrightarrow{r}$
{\scriptsize
\begin{tikzcd}[sep=0.1cm, scale=0.3]
& 1|3|4|2 \arrow[rr,dash] \arrow[dd,dash,dotted] \arrow[dl,dash] & & 1|3|2|4 \arrow [dd, dash,dotted] \arrow[rr,dash] & & 1|2|3|4 \arrow[dd,dash] \arrow[dl,dash, near end, "\mathbf{\blue{1|2|34}}"']\\
1|4|3|2 \arrow [rr,dash] \arrow [dd,dash] & & 1|4|2|3 \arrow[rr,dash] \arrow[dd,dash] & & \mathbf{\blue{1|2|4|3}} \arrow[dd,dash]  & \\
& \red{\mathbf{14|23}} \arrow [rr,dash,dotted] \arrow[dd,dash,dotted]  & & 3|1|2|4  \arrow[dd,dash,dotted] & & 2|1|3|4 \arrow [dl,dash] \arrow[dd,dash]\\
4|1|3|2 \arrow [rr,dash] \arrow [dd,dash]& & 4|1|2|3  \arrow[dd,dash] \arrow[rr, phantom, "\blue{\mathbf{124|3}}" description,crossing over] & & 2|1|4|3 \arrow[dd,dash]\\
& 3|4|1|2 \arrow[dd,dash,dotted] \arrow[dl,dash,dotted] & & 3|2|1|4 \arrow [dd, dash,dotted] \arrow [rr, dash,dotted] & & 2|3|1|4 \arrow[dd,dash] \\
4|3|1|2 \arrow [dd,dash] \arrow[rr, phantom, "\red{\mathbf{4|123}}" description,crossing over] & & 4|2|1|3 \arrow[rr,dash] \arrow[dd,dash] & & 2|4|1|3 \arrow[dd,dash] & \\
& 3|4|2|1 \arrow [rr,dash,dotted] \arrow [dl,dash,dotted] & & \red{\mathbf{24|13}} \arrow [rr,dash,dotted] & & 2|3|4|1 \arrow [dl,dash] \\
4|3|2|1 \arrow [rr,dash] & & 4|2|3|1 \arrow [rr,dash] & & 2|4|3|1 \\
\end{tikzcd}
}
\end{center}
As $r$ is an isomorphism of $k$-subdivision cubes, the maximal pair of $\SU$ subdivision cubes has been mapped to a maximal pair of $\LA$ subdivision cubes.
Note that the maximal $\SU$ $2$-subdivision cube with maximal vertex $4|3|1|2$ was generated by $\SU$ right shifts.
Its image under $r$ is the maximal $\LA$ $2$-subdivision cube with minimal vertex $1|2|4|3$, and it is generated by $\LA$ right shifts.
\end{example}

As the example suggests, we can relate $\LA$ maximal subdivision cube pairs to $\LA$ shifts.
\begin{proposition}
Let $v$ be a vertex of $P_n$, then
\begin{align*}
	\maxsubdivpairsv = \bigcup_{\mathbf{M},\mathbf{N}} L_\mathbf{M}^{\LA}(\sigma) \times R_{\mathbf{N}}^{\LA}(\tau)
\end{align*}
where $\mathbf{M},\mathbf{N}$ are admissible sequences of $LA$ shifts.
\end{proposition}
\begin{proof}
This follows as a result of $r:\divcube{n}^{\SU}\to \divcube{n}^{\LA}$ being a $k$-subdivision cube isomorphism (\cref{prop:r is a k-subdiv cube isomorphism}), $t(r\times r):\LAD\to \SUD$ being an isomorphism of diagonals (\cref{rem:Alternate Isomorphism}), and the commutativity of the square 
\begin{center}
\begin{tikzcd}
SCP \arrow[r,"t(r\times r)",leftrightarrow] \arrow[d,leftrightarrow] & SCP \arrow[d,leftrightarrow]\\
\mathbb{S}_n \arrow[r,"r"',leftrightarrow] & \mathbb{S}_n
\end{tikzcd}
\end{center}
The vertical arrows are the defining bijection between SCPs and permutations (\cref{def:strong-complementary-pairs}).
\end{proof}

This yields an alternate cubical formula for the $\LA$ diagonal.

\begin{proposition}
\begin{align*}
	\LAD([n]) = \bigcup_{v \in P_n} \maxsubdivpairsv
\end{align*}
\end{proposition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearpage

\part{Higher algebraic structures}
\label{part:higherAlgebraicStructures}

%Commented to compile faster.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Higher tensor products}

\Guillaume{Courte intro de section}

%%%%%%%%%%%%%%%

\subsection{Topological operadic structures on the operahedra}

The permutahedra are part of a more general family of polytopes called Loday realizations of the \emph{operahedra} \cite[Def.~2.9]{LaplanteAnfossi} which encodes the notion of homotopy operad \cite[Def.~4.11]{LaplanteAnfossi}.\Guillaume{Image des trois mousquetaires?}
For every planar tree $t$, there is a corresponding polytope $P_t$ whose codimension $k$ faces are in bijection with nestings of $t$ with $k$ non-trivial nests.
Since the operahedra are generalized permutahedra \cite[Coro.~2.16]{LaplanteAnfossi}, a choice of diagonal for the permuthedra induces a choice of diagonal for every operahedron \cite[Coro.~1.31]{LaplanteAnfossi}.
Every face of an operahedron is isomorphic to a product of lower-dimensional operahedra, via an isomorphism $\Theta$ which generalizes the one above, see Point (5) of \cite[Prop.~2.3]{LaplanteAnfossi}.

\begin{definition}
	An \emph{operadic diagonal} for the operahedra is a choice of diagonal $\triangle_t$ for each operahedron~$P_t$, such that $\triangle \eqdef \{\triangle_t\}$ commutes with the map $\Theta$, \ie it satisfies \cite[Prop.~4.14]{LaplanteAnfossi}.
\end{definition}

\begin{theorem}[Operadic structures on the operahedra] 
	\label{thm:operahedra}
There are exactly 
\begin{enumerate}
	\item two operadic diagonals of the Loday operahedra, given by the $\LA$ and $\SU$ diagonals, therefore exactly
	\item two colored topological cellular operad structures on the Loday operahedra, and incidentally exactly
	\item two universal tensor products of homotopy operads,
\end{enumerate}
which agree with the generalized Tamari order on fully nested trees. 
\end{theorem}

\begin{proof}
	Let us first examine Point (1).
	By \cref{prop:unique-operad}, we know that if one of the two choices $\LAD$ or $\SUD$ is made on an operahedron $P_t$, one has to make the same choice on every lower-dimensional operahedron appearing in the decomposition $P_{t_1} \times \cdots \times P_{t_k} \cong F \subset P_t$ of a face $F$ of $P_t$. 
	Now suppose that one makes two distinct choices for two operahedra $P_t$ and $P_{t'}$.
	It is easy to find a bigger tree $t''$ of which both $t$ and $t'$ are subtrees.
	Therefore, $P_t$ and $P_{t'}$ appear as facets of $P_{t''}$ and by the preceding remark, any choice of diagonal for $P_{t''}$ will then contradict our initial two choices. 
	Thus, these had to be the same from the start, which concludes the proof. 

	Point (2) then follows from fact that a choice of diagonal for the Loday realizations of the operahedra \emph{forces} a unique topological cellular colored operad structure on them, see \cite[Thm.~4.18]{LaplanteAnfossi}.
	Since universal tensor products of homotopy operads are induced by a colored operad structure on the operahedra \cite[Coro.~4.24]{LaplanteAnfossi}, we obtain Point~(3).
	Finally, since only vectors with strictly descreasing coordinates induce the generalized Tamari order on the skeleton of the operahedra \cite[Prop.~3.11]{LaplanteAnfossi}, we get the last part of the statement. 
\end{proof}

This answers a question raised in \cite[Rem.~3.14]{LaplanteAnfossi}.

\begin{remark}
Two other important families of generalized permutahedra are the \emph{Loday associahedra} and \emph{Forcey--Loday multiplihedra}, which encode respectively $\Ainf$-algebras and $\Ainf$-morphisms \cite[Prop.~4.9]{LaplanteAnfossiMazuir}, as well as $\Ainf$-categories and $\Ainf$-functors \cite[Sect.~4.3]{LaplanteAnfossiMazuir}.
Using the same techniques as in the case of the operahedra, they were endowed with diagonals and compatible operad and operadic bimodule structures in \cite[Thm.~1]{LaplanteAnfossiMazuir}.
An analogous notion of \emph{operadic diagonal} is available for these polytopes, see \cite[Prop.~2.14]{LaplanteAnfossiMazuir}.
It seems likely that a statement similar to \cref{thm:operahedra} holds for tensor products of $\Ainf$-morphisms. 
However, it is not immediately clear to the authors how to follow strategy of \cite{LaplanteAnfossiMazuir} with a vector inducing the $\SU$ diagonal on the permutahedra.
\end{remark}

\begin{example}
	The Loday associahedra correspond to the Loday operahedra associated with linear trees \cite[Sec. 2.2]{LaplanteAnfossi}, and define a suboperad.
	The restriction of the two operad structures of \cref{thm:operahedra} coincide in this case, and both the $\LA$ and $\SU$ diagonals induce the \emph{magical formula} of \cite{MarklShnider, MasudaThomasTonksVallette, SaneblidzeUmble-comparingDiagonals} defining a universal tensor product of $\Ainf$-algebras. 
\end{example}

\begin{example}
	The restriction of \cref{thm:operahedra} to the permutahedra associated with $2$-leveled trees gives two distinct universal tensor products of homotopy associative \emph{permutads}, as studied in \cite{LodayRonco-permutads,Markl}.
\end{example}

We shall see now that the two operad structures on the operahedra are related to one another in the strongest possible sense: they are isomorphic as topological cellular colored operads.

%%%%%%%%%%%%%%%

\subsection{Relating operadic structures} 

Recall that the topological cellular operad structure on the operahedra \cite[Def.~4.17]{LaplanteAnfossi} is given by a family of partial composition maps 
\[
\vcenter{\hbox{
\begin{tikzcd}[column sep=1cm]
\circ_i^{\LA}\ : \ P_{t'}\times P_{t''}
\arrow[r,  "\tr\times \id"]
& P_{(t',\omega)}\times P_{t''}
 \arrow[r,hookrightarrow, "\Theta"]
&
P_t .
\end{tikzcd}
}}  \]
Here, the map $\tr$ is the \emph{unique} topological cellular map which commutes with the diagonal~$\LAD$ \cite[Prop.~7]{MasudaThomasTonksVallette}. 
This partial composition $\circ_i^\LA$ is an isomorphism in the category $\PolySub$ \cite[Def.~4.13]{LaplanteAnfossi} between the product $P_{t'}\times P_{t''}$ and the facet $t' \circ_i^\LA t''$ of~$P_t$.
Using the $\SU$ diagonal $\SUD$, one can define similarly a topological operad structure via the same formula, but with a different transition map $\tr$, which commutes with $\SUD$.

Recall that a face $F$ of $P_t$ is represented by a nested tree $(t,\mathcal{N})$, which can be written uniquely as a sequence of substitution of trivially nested trees 
$(t,\mathcal{N})=((\cdots((t_1\circ_{i_1} t_2) \circ_{i_2} t_3) \cdots )\circ_{i_k} t_{k+1})$.
Here we use the increasing order on nestings \cite[Def. 4.5]{LaplanteAnfossi}, and observe that any choice of sequence of $\circ_i$ operations yield the same nested, since these form an operad \cite[Def.~4.7]{LaplanteAnfossi}.
At the geometric level, we have an isomorphism
\[((\cdots((\circ_{i_1}^\LA) \circ_{i_2}^\LA) \cdots) \circ_{i_k}^\LA): P_{t_1} \times P_{t_2} \times \cdots \times P_{t_{k+1}} \overset{\cong}{\longrightarrow} F \subset P_t \]
between a uniquely determined product of lower dimensional operahedra, and the face $F=(t,\mathcal{N})$ of~$P_t$.
Note that any choice of sequence of $\circ_i^\LA$ operations yield the same isomorphism, since they form an operad \cite[Thm.~4.18]{LaplanteAnfossi}.
The same holds when taking the~$\circ_i^\SU$ operations instead of the $\circ_i^\LA$. 

\begin{construction}
	\label{const:top-iso}
	For any operahedron $P_t$, we define a map $\Psi_t : P_t \to P_t$ 
	\begin{itemize}
		\item on the interior of the top face by the identity $\id : \mathring P_t \to \mathring P_t$, and 
		\item on the interior of the face $F=((\cdots((t_1 \circ_{i_1} t_2) \circ_{i_2} t_3) \cdots )\circ_{i_k} t_{k+1})$ of~$P_t$ by the composition of the two isomorphisms
		\[ 
		((\cdots ((\circ_{i_1}^\SU) \circ_{i_2}^\SU) \cdots) \circ_{i_k}^\SU) \ ((\cdots((\circ_{i_1}^\LA) \circ_{i_2}^\LA) \cdots) \circ_{i_k}^\LA)^{-1}: F \to F . \] 
	\end{itemize}
\end{construction}

\begin{theorem}
	\label{thm:top-iso}
	The map $\Psi \eqdef \{\Psi_t\}$ is an isomorphism of topological cellular symmetric colored operad between the $\LA$ and $\SU$ operad structures on the operahedra, in the category $\PolySub$.
\end{theorem}

\begin{proof}
	By definition, we have that $\Psi$ is an isomorphism in the category $\PolySub$. 
	It remains to show that it preserves the operad structures, \ie that the following diagram commutes
	\[
	\vcenter{\hbox{
	\begin{tikzcd}[column sep=2.2cm, row sep=1.3cm]
	P_{t'}\times P_{t''}
	\arrow[r,  "\circ_i^\LA"] 
	\arrow[d,  "\Psi_{t'}\times\Psi_{t''}"']
	& P_{t} \arrow[d,  "\Psi_t"] \\
	P_{t'}\times P_{t''}  
	\arrow[r,  "\circ_i^\SU"']
	& P_{t}
	\end{tikzcd}
	}}\]
	For two interior points $(x,y) \in \mathring P_{t'}\times \mathring P_{t''}$, the diagram clearly commutes by definition, since $\Psi_{t'}$ and~$\Psi_{t''}$ are the identity in that case. 
	If $x$ is in a face $F=((\cdots((t_1 \circ_{i_1} t_2) \circ_{i_2} t_3) \cdots )\circ_{i_k} t_{k+1})$ of the boundary of~$P_{t'}$, then the lower composite is equal to $\circ_i^\SU (\circ_{i_1}^\SU \circ_{i_2}^\SU \cdots \circ_{i_k}^\SU \times \id)(\circ_{i_1}^\LA \circ_{i_2}^\LA \cdots \circ_{i_k}^\LA \times \id)^{-1}$, and so is the upper composite since $\Psi_t$ starts with the inverse $(\circ_i^\LA)^{-1}$ and the decomposition of~$F$ into $P_{t_1} \times \cdots \times P_{t_{k+1}} \times P_{t''}$ is unique.
	The case when $y$ is in the boundary of $P_{t''}$ is similar.  
	Finally, the compatibility of $\Psi$ with units and the symmetric group actions are straightfoward to check, see \cite[Def.~4.17 \& Thm.~4.18]{LaplanteAnfossi}.
\end{proof}

\begin{remark}
	\cref{const:top-iso} and \cref{thm:top-iso} do not depend on a specific choice of operadic diagonals.
	In this case, however, we do not loose any generality by using specifically the $\LA$ and $\SU$ operad structures. 
\end{remark}

\begin{example}
Note that $\Psi$ is \emph{not} a morphism of ``Hopf" operads, i.e. it does not commute with the respective diagonals $\LAD$ and $\SUD$. 
Consider the two square faces $F \eqdef 12|34$ and $G \eqdef 24|13$ of the $3$-dimensional permutahedron $\Perm[4]$, and choose a point $\b z \in (\mathring F + \mathring G)/2$.
Then, $\LAD(z)$ and $\SUD(z)$ are two different pair of points on the $1$-skeleton of $\Perm[4]$. 
Since $\circ_i^\LA$ and $\circ_i^\SU$ are the identity both on the interior of $\Perm[4]$ (by \cref{const:top-iso}) and on the $1$-skeleton of $\Perm[4]$ (see the proof of \cite[Prop. 7]{MasudaThomasTonksVallette}), we directly obtain that $\LAD(z)=(\Psi \times \Psi)\LAD(z) \neq \SUD \Psi(z)=\SUD(z)$. 
\end{example}

%%%%%%%%%%%%%%%

\subsection{Tensor products of homotopy operads}

Even though the diagonals of the permutahedra are isomorphic, and the operad structures that they induce are as well in the category $\PolySub$, the tensor products of homotopy operads that they define are \emph{not} strictly isomorphic.

\begin{example}
	We have that...
\end{example}

\Guillaume{Donner une ref pour les infini-morphismes}

\begin{theorem}
For any pair of homotopy operads $\mathcal{P},\mathcal{Q}$, the two tensor products~$\mathcal{P} \otimes_\LA \mathcal{Q}$ and~$\mathcal{P} \otimes_\SU \mathcal{Q}$ defined by the $\LA$ and $\SU$ diagonals are not isomorphic in the category of homotopy operads and strict morphisms.
However, the two tensor products are isomorphic in the category of homotopy operads and their $\infty$-morphisms.
\end{theorem}

\begin{proof}
The morphisms of operads $\LAD$ and $\SUD$ are homotopic,
\end{proof}

\begin{remark}
	None of the two diagonals $\LAD$ or $\SUD$ is cocommutative, or coassociative, as is the special case of $\Ainf$-algebras. 
\end{remark}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Aknowledgements}

Hugh Thomas (everything started in Montr\'eal)
Sylvie Corteel for hyperplane arrangements
Saneblidze--Umble for useful correspondence
Galashin (asked about characteristic polynomials). 
Organizers of the Simon Center conference.

BDO was partially supported by the French ANR grants ALCOHOL (ANR-19-CE40-0006), CARPLO (ANR-20-CE40-0007), HighAGT (ANR-20-CE40-0016) and S3 (ANR-20-CE48-0010). 
GLA would like to thank the Max Planck Insitute for Mathematics in Bonn where part of this work was carried out. 
GLA and KS were supported by the Australian Research Council Future Fellowship FT210100256. 
KS was supported by an Australian Government Research Training Program (RTP) Scholarship.
VP was partially supported by the French ANR grant CHARMS (ANR-19-CE40-0017) and by the French--Austrian project PAGCAP (ANR-21-CE48-0020 \& FWF I 5788). 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{alpha}
\bibliography{diagonalsPermutahedra}
\label{sec:biblio}

\end{document}
